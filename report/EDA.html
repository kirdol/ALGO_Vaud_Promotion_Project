<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>eda</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="EDA_files/libs/clipboard/clipboard.min.js"></script>
<script src="EDA_files/libs/quarto-html/quarto.js"></script>
<script src="EDA_files/libs/quarto-html/popper.min.js"></script>
<script src="EDA_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="EDA_files/libs/quarto-html/anchor.min.js"></script>
<link href="EDA_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="EDA_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="EDA_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="EDA_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="EDA_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="EDA_files/libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="EDA_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="EDA_files/libs/datatables-binding-0.30/datatables.js"></script>
<script src="EDA_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="EDA_files/libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="EDA_files/libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="EDA_files/libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="EDA_files/libs/dt-plugin-searchhighlight-1.13.4/source.css" rel="stylesheet">
<script src="EDA_files/libs/dt-plugin-searchhighlight-1.13.4/jquery.highlight.js"></script>
<script src="EDA_files/libs/dt-plugin-searchhighlight-1.13.4/source.min.js"></script>
<link href="EDA_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="EDA_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="EDA_files/libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="EDA_files/libs/typedarray-0.1/typedarray.min.js"></script>
<link href="EDA_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="EDA_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="eda" class="level1">
<h1>EDA</h1>
</section>
<section id="partie-stefan" class="level1">
<h1>Partie Stefan</h1>
<p><strong>Where are from the people coming in the canton of Vaud? What kind of trip are they doing?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"setup.R"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"TMS_dataset_Vaud_20240314_FINAL.csv"</span>),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sep =</span> <span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-exploration-who-is-coming" class="level3">
<h3 class="anchored" data-anchor-id="data-exploration-who-is-coming">Data Exploration: Who is coming?</h3>
<p><strong>Global percentage of people coming in Switzerland per continent</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">### F05_01.ENG </span><span class="al">###</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#nb of occurrences by country and continents </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>OccurencesCountry <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data<span class="sc">$</span>F05_02_ENG) <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>OccurencesContinent <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data<span class="sc">$</span>F05_01_ENG) <span class="sc">%&gt;%</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Continent in percentages</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>F05_01_PCT <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Percentage))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(F05_01_PCT, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6b3e9360e3cd715d67fa" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6b3e9360e3cd715d67fa">{"x":{"filter":"none","vertical":false,"data":[["Europe","Asia","North and Central America","South America","Australia and Oceania","Africa"],[1942,208,200,70,43,23],[78.11745776347546,8.3668543845535,8.045052292839904,2.815768302493966,1.729686242960579,0.925181013676589]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>F05_01_ENG<\/th>\n      <th>Count<\/th>\n      <th>Percentage<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot numbers continent </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(F05_01_PCT, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(F05_01_ENG, Percentage), <span class="at">y=</span>Percentage, <span class="at">fill=</span>F05_01_ENG)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  <span class="co"># Flip coordinates for horizontal bars</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Continents"</span>, <span class="at">y=</span><span class="st">"Percentage"</span>, <span class="at">title=</span><span class="st">"Percentage of Each Unique Continent"</span>) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove the legend title</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="co"># Hide the legend as the colors are not necessary with labels</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># Center the plot title</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span> <span class="co"># Rotate x-axis labels for readability</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, Percentage)), <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.9</span>), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.25</span>) <span class="co"># Add percentage labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'F05_01_PCT' contains continent data and 'F05_02_PCT' contains country data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's merge the country percentages into the continent data frame.</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that both data frames have a common identifier for continents. Adjust 'by' as needed.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a country percentage by continent</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>F05_02_PCT <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_01_ENG, F05_02_ENG) <span class="sc">%&gt;%</span>  <span class="co"># Group by both continent and country</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Percentage))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge country data back to continent data</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(F05_01_PCT, F05_02_PCT, <span class="at">by=</span><span class="st">"F05_01_ENG"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Now create the horizontal stacked bar plot</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(F05_01_ENG, <span class="sc">-</span>Percentage.y), <span class="at">y=</span>Percentage.y, <span class="at">fill=</span>F05_02_ENG)) <span class="sc">+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  <span class="co"># Flip coordinates for horizontal bars</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Continents"</span>, <span class="at">y=</span><span class="st">"Percentage"</span>, <span class="at">title=</span><span class="st">"Percentage of Each Country by Continent"</span>) <span class="sc">+</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">0</span>),</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">0</span>),<span class="co"># Add legend title if needed</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># Center the plot title</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span> <span class="co"># Adjust text angle and justification</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, Percentage.y)), <span class="at">position=</span><span class="fu">position_stack</span>(<span class="at">vjust=</span><span class="fl">0.5</span>))  <span class="co"># Add percentage labels inside the bars</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # trying the shiny for this plot</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Add a column continent to F05_02_ENG</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # UI</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ui &lt;- fluidPage(</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   titlePanel("Interactive Continent/Country Percentage Plot"),</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   sidebarLayout(</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     sidebarPanel(</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#       helpText("Displays the percentage of each country by continent.")</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     ),</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     mainPanel(</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#       plotOutput("stackedPlot")</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # Server</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># server &lt;- function(input, output) {</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   output$stackedPlot &lt;- renderPlot({</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Merge the datasets on the continent identifier, F05_01_ENG</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     combined_data &lt;- merge(F05_01_PCT, F05_02_PCT, by="F05_01_ENG")</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggplot(combined_data, aes(x=reorder(F05_01_ENG, -Country_Percentage), y=Country_Percentage, fill=F05_02_ENG)) +</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#       geom_bar(stat="identity") +</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co">#       coord_flip() +  # Flip coordinates for horizontal bars</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co">#       theme_minimal() +</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co">#       labs(x="Continents", y="Percentage", title="Percentage of Each Country by Continent") +</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co">#       theme(legend.position = "none", # Hide the legend</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co">#             plot.title = element_text(hjust = 0.5), # Center the plot title</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co">#             axis.text.y = element_text(angle = 0, hjust = 1)) + # Adjust text angle and justification</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co">#       geom_text(aes(label=sprintf("%.2f%%", Country_Percentage)), position=position_stack(vjust=0.5))  # Add percentage labels inside the bars</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   })</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co"># # Run the application </span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="co"># shinyApp(ui = ui, server = server)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Global percentage of people coming in Switzerland per country of origin</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Countries in percentages </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>F05_02_PCT <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Percentage))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(F05_02_PCT, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c4d7ef428b1d9b630b38" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c4d7ef428b1d9b630b38">{"x":{"filter":"none","vertical":false,"data":[["Switzerland","France","United Kingdom","Germany","United States of America","Belgium","Spain","Netherlands","Canada","Italy","China","Brazil","Australia","Portugal","India","Poland","Singapore","Czechia","Malaysia","Taiwan","Sweden","Greece","Mexico","Thailand","Luxembourg","South Korea (ROK)","Philippines","Austria","Colombia","Hong Kong (CN)","Argentina","Chile","Ireland","Other","Lithuania","New Zealand","Romania","Lebanon","Morocco","Peru","Bulgaria","Denmark","Hungary","Israel","South Africa","Turkey","Ukraine","Finland","Indonesia","Iran","Kenya","Latvia","Mauritius","North Macedonia","Norway","Rwanda","Saudi Arabia","Serbia","Slovakia","Uruguay","Croatia","Liechtenstein","Malta","Monaco","Mongolia","Russia","Slovenia","U.A.E","Albania","Andorra","Armenia","Bolivia","Bosnia and Herzegovina","Cambodia","Cayman Islands","Costa Rica","Cyprus","Ecuador","Egypt","Ivory Coast","Japan","Jersey","Kosovo","Kuwait","Kyrgyzstan","Malawi","Maldives","Moldova","Montenegro","Nepal","New Caledonia","Oman","Pakistan","Palau","Panama","Qatar","Réunion","Tunisia","Uzbekistan","Venezuela"],[786,358,187,138,133,89,77,63,50,44,40,36,35,33,30,25,25,20,19,19,15,12,12,11,10,10,9,8,8,8,7,7,7,7,6,6,6,5,5,5,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[31.61705551086082,14.40064360418343,7.52212389380531,5.551086082059534,5.349959774738536,3.580048270313757,3.097345132743363,2.53419147224457,2.011263073209976,1.769911504424779,1.609010458567981,1.448109412711183,1.407884151246983,1.327433628318584,1.206757843925985,1.005631536604988,1.005631536604988,0.8045052292839904,0.7642799678197908,0.7642799678197908,0.6033789219629927,0.4827031375703942,0.4827031375703942,0.4424778761061947,0.4022526146419952,0.4022526146419952,0.3620273531777957,0.3218020917135961,0.3218020917135961,0.3218020917135961,0.2815768302493966,0.2815768302493966,0.2815768302493966,0.2815768302493966,0.2413515687851971,0.2413515687851971,0.2413515687851971,0.2011263073209976,0.2011263073209976,0.2011263073209976,0.1609010458567981,0.1609010458567981,0.1609010458567981,0.1609010458567981,0.1609010458567981,0.1609010458567981,0.1609010458567981,0.1206757843925985,0.1206757843925985,0.1206757843925985,0.1206757843925985,0.1206757843925985,0.1206757843925985,0.1206757843925985,0.1206757843925985,0.1206757843925985,0.1206757843925985,0.1206757843925985,0.1206757843925985,0.1206757843925985,0.08045052292839903,0.08045052292839903,0.08045052292839903,0.08045052292839903,0.08045052292839903,0.08045052292839903,0.08045052292839903,0.08045052292839903,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952,0.04022526146419952]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>F05_02_ENG<\/th>\n      <th>Count<\/th>\n      <th>Percentage<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add continent next to each country</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#or merge continent and country table. 1st column continents, 2nd countries, # of occurences then percentage</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Ratio of each country of origin over the total number of visitors surveyed per city</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #total number of tourist per city</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># numbertouristpercity &lt;- data %&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(F105_Code) %&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   count(sort = TRUE)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># #ratio of nationality per city</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;- data %&gt;% </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(F105_Code) %&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(Count = n()) %&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Percentage = Count / sum(Count) * 100) %&gt;% </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(desc(Percentage))</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Counting the number of tourists by city and nationality</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>tourists_by_nationality <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_Code, F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the total number of tourists per city</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>total_tourists_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_Code) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalCount =</span> <span class="fu">sum</span>(Count), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining the counts back to the detailed breakdown and calculating the ratio</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>nationality_ratio_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(total_tourists_per_city, <span class="at">by =</span> <span class="st">"F105_Code"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> Count <span class="sc">/</span> TotalCount) <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(F105_Code, F05_02_ENG, Ratio)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(nationality_ratio_per_city, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8808c539ba337f4c945e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8808c539ba337f4c945e">{"x":{"filter":"none","vertical":false,"data":[["Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aubonne","Aubonne","Aubonne","Aubonne","Aubonne","Avenches","Bex","Bex","Bex","Bex","Bex","Bex","Blonay","Blonay","Blonay","Bourg-en-Lavaux","Bourg-en-Lavaux","Bourg-en-Lavaux","Bullet","Bussigny","Bussigny","Chardonne","Chavannes-de-Bogis","Chavannes-de-Bogis","Chavannes-de-Bogis","Chernex","Chernex","Chernex","Chernex","Chexbres","Chexbres","Chexbres","Chexbres","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Commugny","Coppet","Coppet","Coppet","Coppet","Corsier-sur-Vevey","Corsier-sur-Vevey","Crissier","Cudrefin","Cudrefin","Cudrefin","Cully","Cully","Cully","Cully","Cully","Cully","Cully","Cully","Duillier","Echallens","Ecublens (VD)","Ecublens (VD)","Ecublens (VD)","Ecublens (VD)","Ecublens (VD)","Estavayer-le-Lac","Estavayer-le-Lac","Estavayer-le-Lac","Estavayer-le-Lac","Founex","Founex","Gilly","Gryon","Gryon","Gryon","Gryon","Gryon","Gryon","Gryon","Gryon","Gryon","L'Abbaye","L'Abbaye","L'Abbaye","L'Abbaye","L'Abbaye","La Praz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lavey-Morcles","Lavey-Morcles","Lavey-Morcles","Lavey-Morcles","Le Brassus","Le Brassus","Le Brassus","Le Chenit","Le Chenit","Le Chenit","Le Chenit","Le Chenit","Le Pont","Le Pont","Le Pont","Le Pont","Le Rocheray","Le Rocheray","Le Rocheray","Le Sentier","Le Sentier","Le Sentier","Le Sentier","Les Charbonnieres","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Rasses","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Lucens","Lucens","Lucens","Lucens","Montagny-près-Yverdon","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Orbe","Orbe","Ormont-Dessous","Ormont-Dessous","Ormont-Dessus","Ormont-Dessus","Ormont-Dessus","Payerne","Payerne","Payerne","Payerne","Prangins","Prangins","Prangins","Prangins","Prangins","Renens","Rolle","Rolle","Rolle","Rolle","Rossinière","Rossinière","Rossinière","Rossinière","Rossinière","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Saint Croix","Saint Croix","Saint Croix","Saint Croix","Saint-Légier-La-Chiésaz","Saint-Légier-La-Chiésaz","Saint-Sulpice (VD)","St. Aubin","Valbroye","Vallorbe","Vallorbe","Vallorbe","Vallorbe","Vallorbe","Vallorbe","Vallorbe","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Veytaux","Veytaux","Veytaux","Veytaux","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villeneuve (VD)","Villeneuve (VD)","Villeneuve (VD)","Villeneuve (VD)","Villeneuve (VD)","Villeneuve (VD)","Yens","Yens","Yens","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yvonand","Yvonand"],["Australia","France","Greece","Portugal","Serbia","Switzerland","Austria","China","France","Spain","Switzerland","Switzerland","Belgium","Finland","France","Malaysia","Switzerland","United States of America","France","Other","Switzerland","France","Italy","Switzerland","Switzerland","France","Italy","Switzerland","France","United Kingdom","United States of America","Brazil","Germany","Netherlands","Switzerland","France","Spain","Switzerland","United Kingdom","Belgium","Cambodia","Canada","China","France","Germany","Hong Kong (CN)","India","Indonesia","Ireland","Italy","Latvia","Luxembourg","Netherlands","New Zealand","Norway","Philippines","Portugal","Spain","Sweden","Switzerland","Taiwan","United Kingdom","United States of America","United Kingdom","Canada","France","Germany","Switzerland","Germany","United States of America","Malaysia","France","Iran","Switzerland","Canada","France","Germany","Italy","Sweden","Switzerland","United Kingdom","United States of America","United States of America","North Macedonia","Brazil","France","Portugal","Switzerland","United States of America","France","Greece","Spain","Switzerland","Australia","Belgium","France","Belgium","France","Luxembourg","Slovakia","Spain","Sweden","Switzerland","United Kingdom","United States of America","France","Germany","Switzerland","Taiwan","United Kingdom","Netherlands","Australia","Belgium","Brazil","France","Germany","Sweden","Switzerland","United Kingdom","Argentina","Australia","Austria","Belgium","Bolivia","Brazil","Bulgaria","Canada","Chile","China","Colombia","Czechia","Denmark","Ecuador","Egypt","France","Germany","Greece","Hong Kong (CN)","Hungary","India","Indonesia","Iran","Ireland","Israel","Italy","Ivory Coast","Japan","Kenya","Kyrgyzstan","Lebanon","Lithuania","Luxembourg","Malaysia","Maldives","Mauritius","Mexico","Mongolia","Morocco","Nepal","Netherlands","New Zealand","North Macedonia","Norway","Other","Pakistan","Palau","Peru","Philippines","Poland","Portugal","Qatar","Romania","Réunion","Saudi Arabia","Singapore","Slovenia","South Africa","South Korea (ROK)","Spain","Sweden","Switzerland","Taiwan","Thailand","Tunisia","Turkey","U.A.E","Ukraine","United Kingdom","United States of America","France","North Macedonia","Sweden","Switzerland","France","Spain","Switzerland","France","Germany","Spain","Switzerland","United Kingdom","France","Germany","Switzerland","United Kingdom","France","Germany","Switzerland","Belgium","France","Switzerland","United States of America","Switzerland","Australia","Belgium","Brazil","China","Denmark","France","Germany","Italy","Luxembourg","Netherlands","Peru","Poland","Portugal","Romania","Singapore","Spain","Sweden","Switzerland","United Kingdom","United States of America","Switzerland","Australia","Belgium","Brazil","Canada","Colombia","Croatia","Cyprus","Czechia","France","Germany","India","Ireland","Italy","Luxembourg","Netherlands","Peru","Poland","Portugal","Rwanda","Spain","Sweden","Switzerland","Taiwan","U.A.E","Ukraine","United Kingdom","United States of America","Canada","France","India","United States of America","Switzerland","Andorra","Australia","Austria","Belgium","Brazil","Bulgaria","Canada","Cayman Islands","Chile","China","Colombia","Czechia","Finland","France","Germany","Hong Kong (CN)","India","Ireland","Israel","Italy","Latvia","Lithuania","Malawi","Malaysia","Malta","Mexico","Moldova","Netherlands","Other","Panama","Philippines","Poland","Portugal","Romania","Saudi Arabia","Singapore","Slovakia","Slovenia","South Korea (ROK)","Spain","Sweden","Switzerland","Taiwan","Thailand","Ukraine","United Kingdom","United States of America","Uruguay","Albania","Argentina","Australia","Austria","Belgium","Canada","China","Croatia","Czechia","France","Germany","Hong Kong (CN)","Hungary","Ireland","Italy","Kuwait","Lebanon","Malta","Monaco","Netherlands","Other","Poland","Portugal","Russia","Saudi Arabia","Slovakia","Spain","Switzerland","Taiwan","United Kingdom","United States of America","Venezuela","Argentina","Armenia","Australia","Austria","Belgium","Brazil","Canada","Chile","China","Costa Rica","Denmark","Finland","France","Germany","Greece","India","Italy","Kenya","Kosovo","Latvia","Mexico","Montenegro","Netherlands","Philippines","Poland","Portugal","Romania","Serbia","South Africa","South Korea (ROK)","Spain","Switzerland","Taiwan","Thailand","United Kingdom","United States of America","Uruguay","Uzbekistan","Netherlands","Switzerland","Belgium","Switzerland","France","Switzerland","United Kingdom","France","Mauritius","Spain","Switzerland","Czechia","France","Liechtenstein","Spain","United Kingdom","Spain","France","Netherlands","Poland","United States of America","Belgium","France","Romania","Switzerland","United Kingdom","Canada","France","Germany","India","Indonesia","Italy","Monaco","Netherlands","Spain","Switzerland","United Kingdom","United States of America","Belgium","France","Sweden","Switzerland","New Caledonia","Switzerland","Mexico","Switzerland","Singapore","Czechia","France","Germany","Liechtenstein","Switzerland","Ukraine","United Kingdom","Argentina","Australia","Belgium","Canada","Colombia","France","Germany","Italy","Lebanon","Lithuania","Malaysia","Mongolia","Morocco","Norway","Philippines","Poland","Portugal","Singapore","South Korea (ROK)","Spain","Switzerland","United Kingdom","United States of America","China","Mexico","Taiwan","United States of America","Australia","Belgium","Brazil","China","France","Italy","Jersey","Luxembourg","Malaysia","Netherlands","Serbia","Sweden","Switzerland","United Kingdom","United States of America","Belgium","France","Germany","Switzerland","United Kingdom","Uruguay","France","Oman","United Kingdom","Argentina","Austria","Bosnia and Herzegovina","Canada","Colombia","Czechia","France","Germany","Lithuania","Netherlands","Spain","Switzerland","United States of America","France","Switzerland"],[0.09090909090909091,0.1818181818181818,0.09090909090909091,0.09090909090909091,0.09090909090909091,0.4545454545454545,0.2,0.2,0.2,0.2,0.2,1,0.1538461538461539,0.07692307692307693,0.1538461538461539,0.07692307692307693,0.4615384615384616,0.07692307692307693,0.2857142857142857,0.1428571428571428,0.5714285714285714,0.25,0.25,0.5,1,0.5,0.5,1,0.6,0.2,0.2,0.25,0.25,0.25,0.25,0.25,0.1666666666666667,0.4166666666666667,0.1666666666666667,0.03867403314917127,0.005524861878453038,0.005524861878453038,0.005524861878453038,0.1712707182320442,0.06629834254143646,0.01104972375690608,0.005524861878453038,0.005524861878453038,0.01104972375690608,0.01657458563535912,0.005524861878453038,0.01104972375690608,0.03867403314917127,0.005524861878453038,0.005524861878453038,0.005524861878453038,0.01104972375690608,0.01657458563535912,0.005524861878453038,0.3867403314917127,0.005524861878453038,0.1325966850828729,0.02762430939226519,1,0.25,0.25,0.25,0.25,0.5,0.5,1,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.05882352941176471,0.05882352941176471,0.1764705882352941,0.05882352941176471,0.05882352941176471,0.4705882352941176,0.05882352941176471,0.05882352941176471,1,1,0.125,0.25,0.125,0.375,0.125,0.1428571428571428,0.07142857142857142,0.1428571428571428,0.6428571428571429,0.5,0.5,1,0.07142857142857142,0.2142857142857143,0.07142857142857142,0.07142857142857142,0.07142857142857142,0.07142857142857142,0.1428571428571428,0.2142857142857143,0.07142857142857142,0.08108108108108109,0.1351351351351351,0.7297297297297297,0.02702702702702703,0.02702702702702703,1,0.1,0.1,0.1,0.2,0.1,0.1,0.2,0.1,0.003189792663476874,0.0127591706539075,0.001594896331738437,0.02392344497607655,0.001594896331738437,0.03189792663476874,0.001594896331738437,0.03987240829346093,0.006379585326953748,0.02551834130781499,0.003189792663476874,0.006379585326953748,0.003189792663476874,0.001594896331738437,0.001594896331738437,0.1993620414673046,0.07336523125996811,0.0127591706539075,0.003189792663476874,0.003189792663476874,0.0127591706539075,0.001594896331738437,0.003189792663476874,0.003189792663476874,0.001594896331738437,0.03508771929824561,0.001594896331738437,0.001594896331738437,0.003189792663476874,0.001594896331738437,0.004784688995215311,0.001594896331738437,0.003189792663476874,0.006379585326953748,0.001594896331738437,0.003189792663476874,0.006379585326953748,0.001594896331738437,0.006379585326953748,0.001594896331738437,0.0303030303030303,0.007974481658692184,0.001594896331738437,0.001594896331738437,0.003189792663476874,0.001594896331738437,0.001594896331738437,0.004784688995215311,0.006379585326953748,0.009569377990430622,0.01913875598086124,0.001594896331738437,0.001594896331738437,0.001594896331738437,0.001594896331738437,0.01913875598086124,0.001594896331738437,0.004784688995215311,0.006379585326953748,0.05901116427432217,0.006379585326953748,0.07177033492822966,0.007974481658692184,0.004784688995215311,0.001594896331738437,0.006379585326953748,0.001594896331738437,0.001594896331738437,0.07496012759170653,0.07974481658692185,0.1666666666666667,0.1666666666666667,0.1666666666666667,0.5,0.2,0.2,0.6,0.1282051282051282,0.07692307692307693,0.02564102564102564,0.717948717948718,0.05128205128205128,0.1142857142857143,0.08571428571428572,0.7714285714285715,0.02857142857142857,0.09090909090909091,0.09090909090909091,0.8181818181818182,0.06666666666666667,0.1333333333333333,0.7333333333333333,0.06666666666666667,1,0.02479338842975207,0.04132231404958678,0.008264462809917356,0.008264462809917356,0.008264462809917356,0.09917355371900827,0.04132231404958678,0.008264462809917356,0.01652892561983471,0.02479338842975207,0.008264462809917356,0.008264462809917356,0.01652892561983471,0.008264462809917356,0.01652892561983471,0.01652892561983471,0.008264462809917356,0.4380165289256198,0.140495867768595,0.05785123966942149,1,0.004950495049504951,0.1683168316831683,0.009900990099009901,0.009900990099009901,0.004950495049504951,0.004950495049504951,0.004950495049504951,0.01485148514851485,0.0891089108910891,0.0396039603960396,0.004950495049504951,0.004950495049504951,0.009900990099009901,0.004950495049504951,0.05445544554455446,0.004950495049504951,0.004950495049504951,0.01485148514851485,0.01485148514851485,0.0198019801980198,0.004950495049504951,0.4207920792079208,0.004950495049504951,0.004950495049504951,0.004950495049504951,0.04950495049504951,0.0198019801980198,0.4,0.2,0.2,0.2,1,0.003745318352059925,0.03745318352059925,0.003745318352059925,0.01123595505617977,0.0299625468164794,0.01123595505617977,0.03370786516853932,0.003745318352059925,0.003745318352059925,0.0449438202247191,0.003745318352059925,0.02621722846441948,0.003745318352059925,0.09363295880149813,0.04868913857677903,0.01123595505617977,0.04868913857677903,0.003745318352059925,0.01123595505617977,0.01123595505617977,0.003745318352059925,0.00749063670411985,0.003745318352059925,0.03745318352059925,0.003745318352059925,0.0149812734082397,0.003745318352059925,0.02247191011235955,0.01123595505617977,0.003745318352059925,0.00749063670411985,0.02621722846441948,0.01872659176029963,0.003745318352059925,0.003745318352059925,0.0299625468164794,0.003745318352059925,0.003745318352059925,0.0149812734082397,0.00749063670411985,0.00749063670411985,0.101123595505618,0.02247191011235955,0.02247191011235955,0.003745318352059925,0.06367041198501873,0.09737827715355805,0.003745318352059925,0.005524861878453038,0.01104972375690608,0.005524861878453038,0.005524861878453038,0.01657458563535912,0.01657458563535912,0.01104972375690608,0.005524861878453038,0.01657458563535912,0.1049723756906077,0.08839779005524862,0.005524861878453038,0.01104972375690608,0.005524861878453038,0.01657458563535912,0.005524861878453038,0.005524861878453038,0.005524861878453038,0.005524861878453038,0.01104972375690608,0.005524861878453038,0.01657458563535912,0.005524861878453038,0.01104972375690608,0.005524861878453038,0.005524861878453038,0.02209944751381215,0.4640883977900552,0.01104972375690608,0.03314917127071823,0.05524861878453038,0.005524861878453038,0.006535947712418301,0.006535947712418301,0.0457516339869281,0.0196078431372549,0.0261437908496732,0.006535947712418301,0.0130718954248366,0.0130718954248366,0.0130718954248366,0.006535947712418301,0.006535947712418301,0.006535947712418301,0.1764705882352941,0.0392156862745098,0.0130718954248366,0.03267973856209151,0.0130718954248366,0.006535947712418301,0.006535947712418301,0.006535947712418301,0.0130718954248366,0.006535947712418301,0.0261437908496732,0.006535947712418301,0.0196078431372549,0.0196078431372549,0.0130718954248366,0.006535947712418301,0.006535947712418301,0.006535947712418301,0.0457516339869281,0.130718954248366,0.0130718954248366,0.0130718954248366,0.130718954248366,0.06535947712418301,0.006535947712418301,0.006535947712418301,0.1111111111111111,0.8888888888888888,0.1666666666666667,0.8333333333333334,0.3333333333333333,0.5833333333333334,0.08333333333333333,0.25,0.25,0.25,0.25,0.2,0.2,0.2,0.2,0.2,1,0.2,0.2,0.2,0.4,0.125,0.125,0.125,0.5,0.125,0.01449275362318841,0.07246376811594203,0.08695652173913043,0.01449275362318841,0.01449275362318841,0.01449275362318841,0.01449275362318841,0.02898550724637681,0.04347826086956522,0.6231884057971014,0.05797101449275362,0.01449275362318841,0.125,0.125,0.125,0.625,0.5,0.5,1,1,1,0.05,0.15,0.1,0.05,0.5,0.05,0.1,0.01515151515151515,0.01515151515151515,0.0303030303030303,0.01515151515151515,0.0303030303030303,0.2121212121212121,0.0303030303030303,0.0303030303030303,0.01515151515151515,0.0303030303030303,0.0303030303030303,0.01515151515151515,0.01515151515151515,0.01515151515151515,0.01515151515151515,0.04545454545454546,0.04545454545454546,0.0303030303030303,0.01515151515151515,0.04545454545454546,0.196969696969697,0.09090909090909091,0.01515151515151515,0.1666666666666667,0.1666666666666667,0.1666666666666667,0.5,0.01265822784810127,0.0759493670886076,0.01265822784810127,0.05063291139240506,0.1265822784810127,0.02531645569620253,0.01265822784810127,0.02531645569620253,0.01265822784810127,0.0379746835443038,0.01265822784810127,0.01265822784810127,0.3291139240506329,0.2025316455696203,0.05063291139240506,0.1428571428571428,0.1428571428571428,0.1428571428571428,0.2857142857142857,0.1428571428571428,0.1428571428571428,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.007518796992481203,0.007518796992481203,0.007518796992481203,0.01503759398496241,0.01503759398496241,0.007518796992481203,0.06766917293233082,0.01503759398496241,0.007518796992481203,0.01503759398496241,0.007518796992481203,0.8195488721804511,0.007518796992481203,0.75,0.25]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>F105_Code<\/th>\n      <th>F05_02_ENG<\/th>\n      <th>Ratio<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar plot with cities on y and % on x and fill = % nationalities per city relatively to the number of tourist who visited the city </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># faire un graph par continent ? (beaucoup de villes )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Ratio of each country of origin relatively to the number of tourist surveyed in each district</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ratio of each nationality relatively to the number of tourist surveyed in each district F105_OrgCode</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>tourists_by_nationality <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_OrgCode, F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the total number of tourists per city</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>total_tourists_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_OrgCode) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalCount =</span> <span class="fu">sum</span>(Count), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining the counts back to the detailed breakdown and calculating the ratio</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>nationality_ratio_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(total_tourists_per_city, <span class="at">by =</span> <span class="st">"F105_OrgCode"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> Count <span class="sc">/</span> TotalCount) <span class="sc">%&gt;%</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(F105_OrgCode, F05_02_ENG, Ratio)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(nationality_ratio_per_city, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5548a9fefd3ee4e31e3f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5548a9fefd3ee4e31e3f">{"x":{"filter":"none","vertical":false,"data":[["Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Avenches Tourisme","Echallens Région Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Moudon Région Tourisme","Moudon Région Tourisme","Moudon Région Tourisme","Moudon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Vallée de Joux","Vallée de Joux","Vallée de Joux","Vallée de Joux","Vallée de Joux","Vallée de Joux","Vallée de Joux","Vallée de Joux","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région"],["Australia","Belgium","Brazil","Canada","Colombia","Croatia","Cyprus","Czechia","France","Germany","Greece","India","Ireland","Italy","Luxembourg","Netherlands","Peru","Poland","Portugal","Rwanda","Serbia","Spain","Sweden","Switzerland","Taiwan","U.A.E","Ukraine","United Kingdom","United States of America","Switzerland","North Macedonia","France","Greece","Iran","Mauritius","Singapore","Spain","Switzerland","Argentina","Australia","Austria","Belgium","Bolivia","Brazil","Bulgaria","Canada","Chile","China","Colombia","Czechia","Denmark","Ecuador","Egypt","France","Germany","Greece","Hong Kong (CN)","Hungary","India","Indonesia","Iran","Ireland","Israel","Italy","Ivory Coast","Japan","Kenya","Kyrgyzstan","Lebanon","Lithuania","Luxembourg","Malaysia","Maldives","Mauritius","Mexico","Mongolia","Morocco","Nepal","Netherlands","New Zealand","North Macedonia","Norway","Other","Pakistan","Palau","Peru","Philippines","Poland","Portugal","Qatar","Romania","Réunion","Saudi Arabia","Singapore","Slovenia","South Africa","South Korea (ROK)","Spain","Sweden","Switzerland","Taiwan","Thailand","Tunisia","Turkey","U.A.E","Ukraine","United Kingdom","United States of America","Andorra","Argentina","Australia","Austria","Belgium","Brazil","Bulgaria","Canada","Cayman Islands","Chile","China","Colombia","Czechia","Finland","France","Germany","Hong Kong (CN)","India","Ireland","Israel","Italy","Latvia","Lebanon","Lithuania","Malawi","Malaysia","Malta","Mexico","Moldova","Mongolia","Morocco","Netherlands","New Caledonia","Norway","Other","Panama","Philippines","Poland","Portugal","Romania","Saudi Arabia","Singapore","Slovakia","Slovenia","South Korea (ROK)","Spain","Sweden","Switzerland","Taiwan","Thailand","Ukraine","United Kingdom","United States of America","Uruguay","Albania","Argentina","Australia","Austria","Belgium","Canada","China","Croatia","Czechia","France","Germany","Hong Kong (CN)","Hungary","Ireland","Italy","Kuwait","Lebanon","Malta","Monaco","Netherlands","Oman","Other","Poland","Portugal","Russia","Saudi Arabia","Slovakia","Spain","Switzerland","Taiwan","United Kingdom","United States of America","Venezuela","Canada","France","India","United States of America","Argentina","Armenia","Australia","Austria","Belgium","Brazil","Canada","Chile","China","Costa Rica","Czechia","Denmark","Finland","France","Germany","Greece","India","Italy","Kenya","Kosovo","Latvia","Liechtenstein","Mexico","Montenegro","Netherlands","Philippines","Poland","Portugal","Romania","Serbia","South Africa","South Korea (ROK)","Spain","Switzerland","Taiwan","Thailand","United Kingdom","United States of America","Uruguay","Uzbekistan","Belgium","Cambodia","Canada","China","France","Germany","Hong Kong (CN)","India","Indonesia","Ireland","Italy","Latvia","Luxembourg","Monaco","Netherlands","New Zealand","Norway","Philippines","Portugal","Romania","Spain","Sweden","Switzerland","Taiwan","United Kingdom","United States of America","Belgium","France","Germany","Spain","Switzerland","Taiwan","United Kingdom","United States of America","Australia","Belgium","Brazil","China","Denmark","Finland","France","Germany","Italy","Jersey","Luxembourg","Malaysia","Netherlands","North Macedonia","Peru","Poland","Portugal","Romania","Serbia","Singapore","Slovakia","Spain","Sweden","Switzerland","United Kingdom","United States of America","Argentina","Austria","Belgium","Bosnia and Herzegovina","Canada","Colombia","Czechia","France","Germany","Liechtenstein","Lithuania","Netherlands","Spain","Sweden","Switzerland","Ukraine","United Kingdom","United States of America"],[0.0091324200913242,0.1598173515981735,0.0091324200913242,0.0091324200913242,0.0045662100456621,0.0045662100456621,0.0045662100456621,0.0136986301369863,0.091324200913242,0.0365296803652968,0.0045662100456621,0.0045662100456621,0.0045662100456621,0.0091324200913242,0.0045662100456621,0.0502283105022831,0.0045662100456621,0.0045662100456621,0.0182648401826484,0.0136986301369863,0.0045662100456621,0.0182648401826484,0.0045662100456621,0.4337899543378995,0.0045662100456621,0.0045662100456621,0.0045662100456621,0.045662100456621,0.0182648401826484,1,1,0.1739130434782609,0.04347826086956522,0.04347826086956522,0.04347826086956522,0.04347826086956522,0.1304347826086956,0.5217391304347826,0.003125,0.0125,0.0015625,0.0234375,0.0015625,0.0328125,0.0015625,0.0390625,0.00625,0.025,0.003125,0.00625,0.003125,0.0015625,0.0015625,0.2,0.07187499999999999,0.0125,0.003125,0.003125,0.0125,0.0015625,0.003125,0.003125,0.0015625,0.0359375,0.0015625,0.0015625,0.003125,0.0015625,0.0046875,0.0015625,0.003125,0.0078125,0.0015625,0.003125,0.0078125,0.0015625,0.00625,0.0015625,0.0296875,0.0078125,0.0015625,0.0015625,0.003125,0.0015625,0.0015625,0.0046875,0.00625,0.009375,0.0203125,0.0015625,0.0015625,0.0015625,0.0015625,0.01875,0.0015625,0.0046875,0.00625,0.059375,0.00625,0.075,0.0078125,0.0046875,0.0015625,0.00625,0.0015625,0.0015625,0.0734375,0.07968749999999999,0.002469135802469136,0.002469135802469136,0.02962962962962963,0.002469135802469136,0.01728395061728395,0.02469135802469136,0.007407407407407408,0.02716049382716049,0.002469135802469136,0.002469135802469136,0.03209876543209877,0.007407407407407408,0.01728395061728395,0.002469135802469136,0.1209876543209877,0.05432098765432099,0.007407407407407408,0.03209876543209877,0.002469135802469136,0.007407407407407408,0.01728395061728395,0.002469135802469136,0.002469135802469136,0.009876543209876543,0.002469135802469136,0.02962962962962963,0.002469135802469136,0.01234567901234568,0.002469135802469136,0.002469135802469136,0.002469135802469136,0.01728395061728395,0.002469135802469136,0.002469135802469136,0.009876543209876543,0.002469135802469136,0.007407407407407408,0.02469135802469136,0.01975308641975309,0.002469135802469136,0.002469135802469136,0.02469135802469136,0.002469135802469136,0.002469135802469136,0.01234567901234568,0.01728395061728395,0.009876543209876543,0.162962962962963,0.01728395061728395,0.01481481481481482,0.002469135802469136,0.0691358024691358,0.07901234567901234,0.004938271604938272,0.005291005291005291,0.01058201058201058,0.005291005291005291,0.01058201058201058,0.01587301587301587,0.01587301587301587,0.01587301587301587,0.005291005291005291,0.01587301587301587,0.1111111111111111,0.08465608465608465,0.005291005291005291,0.01058201058201058,0.005291005291005291,0.01587301587301587,0.005291005291005291,0.005291005291005291,0.005291005291005291,0.005291005291005291,0.01058201058201058,0.005291005291005291,0.005291005291005291,0.01587301587301587,0.005291005291005291,0.01058201058201058,0.005291005291005291,0.005291005291005291,0.02645502645502645,0.4497354497354497,0.01058201058201058,0.03703703703703703,0.05291005291005291,0.005291005291005291,0.4,0.2,0.2,0.2,0.005649717514124294,0.005649717514124294,0.04519774011299435,0.01694915254237288,0.02824858757062147,0.005649717514124294,0.01694915254237288,0.01129943502824859,0.01129943502824859,0.005649717514124294,0.005649717514124294,0.005649717514124294,0.005649717514124294,0.192090395480226,0.03954802259887006,0.01129943502824859,0.02824858757062147,0.01129943502824859,0.005649717514124294,0.005649717514124294,0.005649717514124294,0.005649717514124294,0.01129943502824859,0.005649717514124294,0.02824858757062147,0.005649717514124294,0.02259887005649718,0.01694915254237288,0.01129943502824859,0.005649717514124294,0.005649717514124294,0.005649717514124294,0.04519774011299435,0.1186440677966102,0.01129943502824859,0.01129943502824859,0.1299435028248588,0.07909604519774012,0.005649717514124294,0.005649717514124294,0.0310077519379845,0.003875968992248062,0.007751937984496124,0.003875968992248062,0.1434108527131783,0.06976744186046512,0.007751937984496124,0.007751937984496124,0.007751937984496124,0.007751937984496124,0.01550387596899225,0.003875968992248062,0.007751937984496124,0.003875968992248062,0.03488372093023256,0.003875968992248062,0.003875968992248062,0.003875968992248062,0.007751937984496124,0.003875968992248062,0.02325581395348837,0.003875968992248062,0.4534883720930232,0.003875968992248062,0.1124031007751938,0.02325581395348837,0.006993006993006993,0.1118881118881119,0.08391608391608392,0.01398601398601399,0.7412587412587412,0.006993006993006993,0.02797202797202797,0.006993006993006993,0.0163265306122449,0.05714285714285714,0.00816326530612245,0.02040816326530612,0.004081632653061225,0.004081632653061225,0.1306122448979592,0.02040816326530612,0.01224489795918367,0.004081632653061225,0.02040816326530612,0.00816326530612245,0.02448979591836735,0.004081632653061225,0.004081632653061225,0.004081632653061225,0.00816326530612245,0.004081632653061225,0.004081632653061225,0.00816326530612245,0.004081632653061225,0.01224489795918367,0.0163265306122449,0.3959183673469387,0.1510204081632653,0.05306122448979592,0.00558659217877095,0.00558659217877095,0.00558659217877095,0.00558659217877095,0.0111731843575419,0.0111731843575419,0.0111731843575419,0.0893854748603352,0.0223463687150838,0.00558659217877095,0.00558659217877095,0.0223463687150838,0.00558659217877095,0.00558659217877095,0.7653631284916201,0.00558659217877095,0.0111731843575419,0.00558659217877095]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>F105_OrgCode<\/th>\n      <th>F05_02_ENG<\/th>\n      <th>Ratio<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Séparation cantons suisse-allemands </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Swiss german column</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(data[data$F05_02 == "Schweiz", ]$F05_03)</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># swiss_german_cantons = c("Luzern", "Schwyz", "Bern", "Neuenburg", "Aargau",</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "Zürich", "Basel-Stadt", "Basel-Landschaft", "Obwalden",</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "Appenzell Innerrhoden", "Schaffhausen", "Thurgau",</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "St. Gallen", "Solothurn", "Uri", "Zug", "Nidwalden",</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "Appenzell Ausserrhoden")</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # Binary column for swiss germans</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># data$swiss_german &lt;- ifelse(data$F05_02 == "Schweiz" &amp; data$F05_03 %in% swiss_german_cantons, 1, 0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar plot with cities on y and % on x and fill = % nationalities per city relatively to the number of tourist who visited the city </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar chart</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar chart</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(nationality_ratio_per_city, aes(x = Ratio, y = F105_Code)) +</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_bar(stat = "identity") +</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "Percentage", y = "City", title = "Percentage of Tourists by City") +</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## trying to add percentage country of origin visitors relatively to each district on leaflet</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Assume 'F105_Code' is your city code and maps directly to 'leaflet_districts'</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # Add district info to nationality ratios</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># nationality_with_districts &lt;- nationality_ratio_per_city %&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(data %&gt;% select(F105_Code, leaflet_districts), by = "F105_Code")</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Aggregate nationality data by district</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># district_nationality_ratios &lt;- nationality_with_districts %&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(leaflet_districts, F05_02_ENG) %&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(AverageRatio = mean(Ratio), .groups = 'drop') %&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Label = paste(F05_02_ENG, ":", round(AverageRatio * 100, 2), "%")) %&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(leaflet_districts) %&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(AllLabels = paste(Label, collapse = "\n"))</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># # Join with geographic data</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># vaud &lt;- vaud %&gt;%</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(district_nationality_ratios, by = c("NAME" = "leaflet_districts"))</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # Assuming AverageRatio is correctly calculated and added</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># palette &lt;- colorNumeric(palette = "Blues", domain = range(vaud$AverageRatio, na.rm = TRUE))</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create a Leaflet map</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co"># leaflet(vaud) %&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   addTiles() %&gt;%</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   setView(lng = 6.63, lat = 46.51, zoom = 9) %&gt;%</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   addPolygons(</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     fillOpacity = 0.75, color = ~palette(AverageRatio),</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     weight = 1,</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     popup = ~AllLabels</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="co"># # If AverageRatio is not listed, ensure it is being calculated correctly</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co"># district_nationality_ratios &lt;- nationality_with_districts %&gt;%</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(leaflet_districts, F05_02_ENG) %&gt;%</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(AverageRatio = mean(Ratio, na.rm = TRUE), .groups = 'drop') %&gt;%</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Label = paste(F05_02_ENG, ":", round(AverageRatio * 100, 2), "%")) %&gt;%</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(leaflet_districts) %&gt;%</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(AllLabels = paste(Label, collapse = "\n"))</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="co"># # Make sure that the column names used in the join are correct</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(vaud)</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(district_nationality_ratios)</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="co"># # Correct the join statement</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="co"># vaud &lt;- vaud %&gt;%</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(district_nationality_ratios, by = c("NAME" = "leaflet_districts"))</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check for AverageRatio in vaud</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="co"># if("AverageRatio" %in% colnames(vaud)) {</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="co">#   print("AverageRatio is present")</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="co"># } else {</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a><span class="co">#   print("AverageRatio is missing")</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a><span class="co"># # Adjust palette creation</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a><span class="co"># if("AverageRatio" %in% colnames(vaud)) {</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a><span class="co">#   palette &lt;- colorNumeric(palette = "Blues", domain = range(vaud$AverageRatio, na.rm = TRUE))</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="co"># } else {</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   palette &lt;- colorNumeric(palette = "Blues", domain = c(0, 1))  # Default or fallback range</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create the Leaflet map</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a><span class="co"># leaflet(vaud) %&gt;%</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a><span class="co">#   addTiles() %&gt;%</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a><span class="co">#   setView(lng = 6.63, lat = 46.51, zoom = 9) %&gt;%</span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a><span class="co">#   addPolygons(</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a><span class="co">#     fillOpacity = 0.75, color = ~palette(AverageRatio),</span></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a><span class="co">#     weight = 1,</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a><span class="co">#     popup = ~AllLabels</span></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a><span class="co"># # Example to combine columns if necessary (adjust as needed based on content)</span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a><span class="co"># vaud$AllLabels &lt;- apply(vaud[, grep("AllLabels", colnames(vaud))], 1, function(x) paste(na.omit(x), collapse = " "))</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a><span class="co"># # Drop the old AllLabels.x.x columns</span></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a><span class="co"># vaud &lt;- vaud %&gt;%</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-matches("AllLabels.[0-9]+"))</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check the new AllLabels column</span></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a><span class="co"># head(vaud$AllLabels)</span></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a><span class="co"># # Set up a simple color palette if no AverageRatio is available</span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a><span class="co"># palette &lt;- colorNumeric(palette = "Blues", domain = c(0, 1))</span></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create the Leaflet map using vaud2</span></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a><span class="co"># leaflet(vaud) %&gt;%</span></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a><span class="co">#   addTiles() %&gt;%</span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a><span class="co">#   setView(lng = 6.63, lat = 46.51, zoom = 9) %&gt;%</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a><span class="co">#   addPolygons(</span></span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a><span class="co">#     fillOpacity = 0.75, color = ~palette(1),  # Uniform color as no AverageRatio is available</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a><span class="co">#     weight = 1,</span></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a><span class="co">#     popup = ~AllLabels</span></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">### F05_02_ENG </span><span class="al">###</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot with continents </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>F05_02_PCT <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG, F05_01_ENG) <span class="sc">%&gt;%</span>  <span class="co"># Group by both country and continent</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Percentage))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(F05_02_PCT, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">F05_02_ENG</span><span class="st">`</span>, Percentage), <span class="at">y =</span> Percentage, <span class="at">fill =</span> <span class="st">`</span><span class="at">F05_01_ENG</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  <span class="co"># Make the plot horizontal</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">name =</span> <span class="st">"Continent"</span>) <span class="sc">+</span>  <span class="co"># Use a color palette for continents</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Percentage"</span>, <span class="at">title =</span> <span class="st">"Percentage of Responses by Country and Continent"</span>) <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">9</span>), </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span>  <span class="co"># Adjust legend position</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, Percentage)), <span class="at">position=</span><span class="fu">position_stack</span>(<span class="at">vjust=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">### F12 &amp; F13 </span><span class="al">###</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Are we more interested in knowing when they came for holidays or how long?</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#duration per month </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to date format first</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_column =</span> <span class="fu">dmy</span>(F12),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If you want the month names instead</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">month_name_column =</span> <span class="fu">month</span>(date_column, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>) <span class="co"># Set abbr=FALSE for full month names</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#order</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>desired_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Serial2"</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_01"</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_01_ENG"</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_02"</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_02_ENG"</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_03"</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_04"</span>,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F12"</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F13"</span>,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"month_name_column"</span>,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"hFerienDauer"</span>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>remaining_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(data), desired_order)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>new_order <span class="ot">&lt;-</span> <span class="fu">c</span>(desired_order, remaining_columns)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, new_order]</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co"># nb of days per month </span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>nb_days_per_month <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(F12, F13, month_name_column, hFerienDauer) <span class="sc">%&gt;%</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month_name_column) <span class="sc">%&gt;%</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_hFerienDauer =</span> <span class="fu">sum</span>(hFerienDauer, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>nb_days_per_month <span class="ot">&lt;-</span> nb_days_per_month <span class="sc">%&gt;%</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    month_name_column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"December"</span>, <span class="st">"January"</span>, <span class="st">"February"</span>) <span class="sc">~</span> <span class="st">"Winter"</span>,</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    month_name_column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>) <span class="sc">~</span> <span class="st">"Spring"</span>,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    month_name_column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"June"</span>, <span class="st">"July"</span>, <span class="st">"August"</span>) <span class="sc">~</span> <span class="st">"Summer"</span>,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    month_name_column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"September"</span>, <span class="st">"October"</span>, <span class="st">"November"</span>) <span class="sc">~</span> <span class="st">"Fall"</span>,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> <span class="co"># for any month names not matched or NA values</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nb_days_per_month, <span class="fu">aes</span>(<span class="at">x =</span> month_name_column, <span class="at">y =</span> total_hFerienDauer, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Winter"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Spring"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Summer"</span> <span class="ot">=</span> <span class="st">"purple"</span>, <span class="st">"Fall"</span> <span class="ot">=</span> <span class="st">"orange"</span>)) <span class="sc">+</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Months"</span>, <span class="at">y =</span> <span class="st">"Sum Holiday Durations"</span>, <span class="at">title =</span> <span class="st">"Total Holiday Duration by Month"</span>, <span class="at">fill =</span> <span class="st">"Season"</span>) <span class="sc">+</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">### F16 </span><span class="al">###</span><span class="do"> </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># do a tableau with the percentage of each trip option per nationality </span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>trip_counts <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG, F16_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total counts per nationality</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>nationality_totals <span class="ot">&lt;-</span> trip_counts <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">sum</span>(count))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the trip counts with the total counts per nationality</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>trip_percentages <span class="ot">&lt;-</span> trip_counts <span class="sc">%&gt;%</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(nationality_totals, <span class="at">by =</span> <span class="st">"F05_02_ENG"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> (count <span class="sc">/</span> total_count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(count, total_count))</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(trip_percentages, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-780f549386d94122a8db" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-780f549386d94122a8db">{"x":{"filter":"none","vertical":false,"data":[["Albania","Andorra","Argentina","Argentina","Argentina","Armenia","Australia","Australia","Australia","Australia","Austria","Austria","Austria","Belgium","Belgium","Belgium","Bolivia","Bosnia and Herzegovina","Brazil","Brazil","Brazil","Brazil","Bulgaria","Bulgaria","Cambodia","Canada","Canada","Canada","Canada","Cayman Islands","Chile","Chile","China","China","China","China","Colombia","Colombia","Colombia","Costa Rica","Croatia","Croatia","Cyprus","Czechia","Czechia","Czechia","Czechia","Denmark","Denmark","Denmark","Ecuador","Egypt","Finland","Finland","Finland","France","France","France","France","Germany","Germany","Germany","Germany","Greece","Greece","Hong Kong (CN)","Hong Kong (CN)","Hong Kong (CN)","Hong Kong (CN)","Hungary","India","India","India","India","Indonesia","Indonesia","Iran","Iran","Ireland","Ireland","Ireland","Israel","Israel","Israel","Israel","Italy","Italy","Italy","Ivory Coast","Japan","Jersey","Kenya","Kenya","Kosovo","Kuwait","Kyrgyzstan","Latvia","Latvia","Latvia","Lebanon","Lebanon","Lebanon","Liechtenstein","Lithuania","Lithuania","Luxembourg","Luxembourg","Malawi","Malaysia","Malaysia","Maldives","Malta","Mauritius","Mauritius","Mauritius","Mexico","Mexico","Mexico","Mexico","Moldova","Monaco","Monaco","Mongolia","Montenegro","Morocco","Morocco","Nepal","Netherlands","Netherlands","Netherlands","Netherlands","New Caledonia","New Zealand","New Zealand","New Zealand","New Zealand","North Macedonia","North Macedonia","Norway","Norway","Norway","Oman","Other","Other","Other","Pakistan","Palau","Panama","Peru","Peru","Peru","Philippines","Philippines","Philippines","Philippines","Poland","Poland","Poland","Poland","Portugal","Portugal","Portugal","Qatar","Romania","Romania","Romania","Russia","Russia","Rwanda","Rwanda","Réunion","Saudi Arabia","Saudi Arabia","Serbia","Serbia","Singapore","Singapore","Singapore","Slovakia","Slovakia","Slovenia","South Africa","South Africa","South Africa","South Korea (ROK)","South Korea (ROK)","South Korea (ROK)","South Korea (ROK)","Spain","Spain","Spain","Spain","Sweden","Sweden","Sweden","Sweden","Switzerland","Switzerland","Switzerland","Switzerland","Taiwan","Taiwan","Taiwan","Taiwan","Thailand","Thailand","Thailand","Thailand","Tunisia","Turkey","Turkey","U.A.E","U.A.E","Ukraine","Ukraine","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United States of America","United States of America","United States of America","United States of America","Uruguay","Uruguay","Uzbekistan","Venezuela"],["Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: only one overnight stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Holidays with only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland","Round trip only within Switzerland (several overnight locations in Switzerland)","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: only one overnight stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Round trip through Europe: several places to stay in Switzerland","Holidays with only one overnight stay in Switzerland"],[100,100,14.28571428571428,71.42857142857143,14.28571428571428,100,22.85714285714286,28.57142857142857,5.714285714285714,42.85714285714285,62.5,25,12.5,86.51685393258427,10.1123595505618,3.370786516853932,100,100,8.333333333333332,38.88888888888889,19.44444444444445,33.33333333333333,50,50,100,20,30,20,30,100,71.42857142857143,28.57142857142857,12.5,30,2.5,55.00000000000001,37.5,12.5,50,100,50,50,100,35,30,15,20,25,50,25,100,100,33.33333333333333,33.33333333333333,33.33333333333333,68.15642458100558,21.22905027932961,4.748603351955307,5.865921787709497,53.62318840579711,24.63768115942029,8.695652173913043,13.04347826086956,66.66666666666666,33.33333333333333,12.5,37.5,12.5,37.5,100,6.666666666666667,53.33333333333334,10,30,33.33333333333333,66.66666666666666,66.66666666666666,33.33333333333333,57.14285714285714,14.28571428571428,28.57142857142857,25,25,25,25,77.27272727272727,15.90909090909091,6.818181818181817,100,100,100,66.66666666666666,33.33333333333333,100,100,100,33.33333333333333,33.33333333333333,33.33333333333333,40,20,40,100,66.66666666666666,33.33333333333333,80,20,100,52.63157894736842,47.36842105263158,100,100,33.33333333333333,33.33333333333333,33.33333333333333,8.333333333333332,33.33333333333333,16.66666666666666,41.66666666666667,100,50,50,100,100,80,20,100,69.84126984126983,12.6984126984127,6.349206349206349,11.11111111111111,100,33.33333333333333,16.66666666666666,16.66666666666666,33.33333333333333,33.33333333333333,66.66666666666666,33.33333333333333,33.33333333333333,33.33333333333333,100,28.57142857142857,42.85714285714285,28.57142857142857,100,100,100,40,40,20,33.33333333333333,44.44444444444444,11.11111111111111,11.11111111111111,48,28,8,16,66.66666666666666,24.24242424242424,9.090909090909092,100,66.66666666666666,16.66666666666666,16.66666666666666,50,50,66.66666666666666,33.33333333333333,100,33.33333333333333,66.66666666666666,66.66666666666666,33.33333333333333,16,60,24,33.33333333333333,66.66666666666666,100,25,25,50,10,30,30,30,41.55844155844156,42.85714285714285,7.792207792207792,7.792207792207792,73.33333333333333,13.33333333333333,6.666666666666667,6.666666666666667,73.15521628498728,23.53689567430025,0.7633587786259541,2.544529262086514,15.78947368421053,36.84210526315789,10.52631578947368,36.84210526315789,27.27272727272727,36.36363636363637,9.090909090909092,27.27272727272727,100,50,50,50,50,25,75,67.37967914438502,24.06417112299465,3.74331550802139,4.81283422459893,30.07518796992481,32.33082706766917,8.270676691729323,29.32330827067669,33.33333333333333,66.66666666666666,100,100]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>F05_02_ENG<\/th>\n      <th>F16_ENG<\/th>\n      <th>percentage<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>my_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Holidays with only one overnight stay in Switzerland"</span> <span class="ot">=</span> <span class="st">"#FF9999"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="st">"Round trip only within Switzerland (several overnight locations in Switzerland)"</span> <span class="ot">=</span> <span class="st">"#9999FF"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="st">"Round trip through Europe: only one overnight stay in Switzerland"</span> <span class="ot">=</span> <span class="st">"#66CC99"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="st">"Round trip through Europe: several places to stay in Switzerland"</span> <span class="ot">=</span> <span class="st">"#E69F00"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>F16_Q <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(F16_ENG, <span class="at">name =</span> <span class="st">"total_options"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> total_options <span class="sc">/</span> <span class="fu">sum</span>(total_options) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, percentage)) </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Use ggplot2 to create the pie chart</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(F16_Q, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> percentage, <span class="at">fill =</span> F16_ENG)) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_colors) <span class="sc">+</span> <span class="co"># Use your defined colors here</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> percentage), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Global Percentage Distribution of Type of Trips"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(trip_percentages, <span class="fu">aes</span>(<span class="at">x =</span> F05_02_ENG, <span class="at">y =</span> percentage, <span class="at">fill =</span> F16_ENG)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Percentage"</span>, <span class="at">fill =</span> <span class="st">"Type of Trip"</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Stacked Bar Plot of Type of Trip by Country"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_colors) <span class="sc">+</span> <span class="co"># Use your defined colors here</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">0</span>),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">"vertical"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Where did they stay? (For example: yes, they went to Montreux, but what type of accommodation, what price?</p>
</blockquote>
<p>Let’s now dive into the subject of the location of their stay. First, let’s have a look at the most popular locations in the canton Vaud. Given the architecture of the study this gives us the city where most people answer the survey.</p>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2bc8163075396a5e4e19" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2bc8163075396a5e4e19">{"x":{"visdat":{"15806d5167d5":["function () ","plotlyVisDat"]},"cur_data":"15806d5167d5","attrs":{"15806d5167d5":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (City)","xaxis":{"domain":[0,1],"automargin":true,"title":"City","showgrid":false,"zeroline":false,"tickangle":45,"type":"category","categoryorder":"array","categoryarray":["Lausanne","Montreux","Leysin","Château-d'Oex","Morges","Nyon","Yverdon-les-Bains","Les Diablerets","Villars-sur-Ollon","Rougemont","Vevey","Le Chenit","L'Abbaye","Le Pont","Vallorbe","Cully","Le Sentier","Estavayer-le-Lac","Gryon","Bex","Chexbres","Ormont-Dessus","Aigle","Le Rocheray","La Tour-de-Peilz","Orbe","Ecublens (VD)","Rossinière","Saint Croix","Blonay","Villeneuve (VD)","Lavey-Morcles","Ormont-Dessous","Veytaux","Aubonne","Chavannes-de-Bogis","Le Brassus","Lucens","Prangins","Rolle","Bourg-en-Lavaux","Chernex","Coppet","Payerne","Yvonand","Cudrefin","Yens","Avenches","Bullet","Bussigny","Corsier-sur-Vevey","Founex","Saint-Légier-La-Chiésaz","Chardonne","Commugny","Crissier","Duillier","Echallens","Gilly","La Praz","Les Charbonnieres","Les Rasses","Montagny-près-Yverdon","Renens","Saint-Sulpice (VD)","St. Aubin","Valbroye"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false},"hovermode":"x","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Aigle","Aubonne","Avenches","Bex","Blonay","Bourg-en-Lavaux","Bullet","Bussigny","Chardonne","Château-d'Oex","Chavannes-de-Bogis","Chernex","Chexbres","Commugny","Coppet","Corsier-sur-Vevey","Crissier","Cudrefin","Cully","Duillier","Echallens","Ecublens (VD)","Estavayer-le-Lac","Founex","Gilly","Gryon","L'Abbaye","La Praz","La Tour-de-Peilz","Lausanne","Lavey-Morcles","Le Brassus","Le Chenit","Le Pont","Le Rocheray","Le Sentier","Les Charbonnieres","Les Diablerets","Les Rasses","Leysin","Lucens","Montagny-près-Yverdon","Montreux","Morges","Nyon","Orbe","Ormont-Dessous","Ormont-Dessus","Payerne","Prangins","Renens","Rolle","Rossinière","Rougemont","Saint-Légier-La-Chiésaz","Saint-Sulpice (VD)","Saint Croix","St. Aubin","Valbroye","Vallorbe","Vevey","Veytaux","Villars-sur-Ollon","Villeneuve (VD)","Yens","Yverdon-les-Bains","Yvonand"],"y":[0.0044247787610619468,0.002011263073209976,0.0008045052292839903,0.0052292839903459376,0.0028157683024939663,0.0016090104585679806,0.0008045052292839903,0.0008045052292839903,0.00040225261464199515,0.072807723250201128,0.002011263073209976,0.0016090104585679806,0.0048270313757039418,0.00040225261464199515,0.0016090104585679806,0.0008045052292839903,0.00040225261464199515,0.0012067578439259854,0.0068382944489139182,0.00040225261464199515,0.00040225261464199515,0.0032180209171359612,0.0056315366049879325,0.0008045052292839903,0.00040225261464199515,0.0056315366049879325,0.014883346741753822,0.00040225261464199515,0.0040225261464199519,0.25221238938053098,0.0024135156878519709,0.002011263073209976,0.015687851971037812,0.01407884151246983,0.0044247787610619468,0.0060337892196299274,0.00040225261464199515,0.048672566371681415,0.00040225261464199515,0.081255028157683026,0.002011263073209976,0.00040225261464199515,0.10740144810941271,0.072807723250201128,0.06154465004022526,0.0036202735317779565,0.0024135156878519709,0.0048270313757039418,0.0016090104585679806,0.002011263073209976,0.00040225261464199515,0.002011263073209976,0.0032180209171359612,0.027755430410297668,0.0008045052292839903,0.00040225261464199515,0.0032180209171359612,0.00040225261464199515,0.00040225261464199515,0.0080450522928399038,0.026548672566371681,0.0024135156878519709,0.031777956556717619,0.0028157683024939663,0.0012067578439259854,0.053499597747385358,0.0016090104585679806],"text":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"hovertext":["City name:  Aigle <br>Number of people visiting this city: 11 / 2486 <br>Proportion of people visiting this city: 0.442%","City name:  Aubonne <br>Number of people visiting this city: 5 / 2486 <br>Proportion of people visiting this city: 0.201%","City name:  Avenches <br>Number of people visiting this city: 2 / 2486 <br>Proportion of people visiting this city: 0.080%","City name:  Bex <br>Number of people visiting this city: 13 / 2486 <br>Proportion of people visiting this city: 0.523%","City name:  Blonay <br>Number of people visiting this city: 7 / 2486 <br>Proportion of people visiting this city: 0.282%","City name:  Bourg-en-Lavaux <br>Number of people visiting this city: 4 / 2486 <br>Proportion of people visiting this city: 0.161%","City name:  Bullet <br>Number of people visiting this city: 2 / 2486 <br>Proportion of people visiting this city: 0.080%","City name:  Bussigny <br>Number of people visiting this city: 2 / 2486 <br>Proportion of people visiting this city: 0.080%","City name:  Chardonne <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Château-d'Oex <br>Number of people visiting this city: 181 / 2486 <br>Proportion of people visiting this city: 7.281%","City name:  Chavannes-de-Bogis <br>Number of people visiting this city: 5 / 2486 <br>Proportion of people visiting this city: 0.201%","City name:  Chernex <br>Number of people visiting this city: 4 / 2486 <br>Proportion of people visiting this city: 0.161%","City name:  Chexbres <br>Number of people visiting this city: 12 / 2486 <br>Proportion of people visiting this city: 0.483%","City name:  Commugny <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Coppet <br>Number of people visiting this city: 4 / 2486 <br>Proportion of people visiting this city: 0.161%","City name:  Corsier-sur-Vevey <br>Number of people visiting this city: 2 / 2486 <br>Proportion of people visiting this city: 0.080%","City name:  Crissier <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Cudrefin <br>Number of people visiting this city: 3 / 2486 <br>Proportion of people visiting this city: 0.121%","City name:  Cully <br>Number of people visiting this city: 17 / 2486 <br>Proportion of people visiting this city: 0.684%","City name:  Duillier <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Echallens <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Ecublens (VD) <br>Number of people visiting this city: 8 / 2486 <br>Proportion of people visiting this city: 0.322%","City name:  Estavayer-le-Lac <br>Number of people visiting this city: 14 / 2486 <br>Proportion of people visiting this city: 0.563%","City name:  Founex <br>Number of people visiting this city: 2 / 2486 <br>Proportion of people visiting this city: 0.080%","City name:  Gilly <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Gryon <br>Number of people visiting this city: 14 / 2486 <br>Proportion of people visiting this city: 0.563%","City name:  L'Abbaye <br>Number of people visiting this city: 37 / 2486 <br>Proportion of people visiting this city: 1.488%","City name:  La Praz <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  La Tour-de-Peilz <br>Number of people visiting this city: 10 / 2486 <br>Proportion of people visiting this city: 0.402%","City name:  Lausanne <br>Number of people visiting this city: 627 / 2486 <br>Proportion of people visiting this city: 25.221%","City name:  Lavey-Morcles <br>Number of people visiting this city: 6 / 2486 <br>Proportion of people visiting this city: 0.241%","City name:  Le Brassus <br>Number of people visiting this city: 5 / 2486 <br>Proportion of people visiting this city: 0.201%","City name:  Le Chenit <br>Number of people visiting this city: 39 / 2486 <br>Proportion of people visiting this city: 1.569%","City name:  Le Pont <br>Number of people visiting this city: 35 / 2486 <br>Proportion of people visiting this city: 1.408%","City name:  Le Rocheray <br>Number of people visiting this city: 11 / 2486 <br>Proportion of people visiting this city: 0.442%","City name:  Le Sentier <br>Number of people visiting this city: 15 / 2486 <br>Proportion of people visiting this city: 0.603%","City name:  Les Charbonnieres <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Les Diablerets <br>Number of people visiting this city: 121 / 2486 <br>Proportion of people visiting this city: 4.867%","City name:  Les Rasses <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Leysin <br>Number of people visiting this city: 202 / 2486 <br>Proportion of people visiting this city: 8.126%","City name:  Lucens <br>Number of people visiting this city: 5 / 2486 <br>Proportion of people visiting this city: 0.201%","City name:  Montagny-près-Yverdon <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Montreux <br>Number of people visiting this city: 267 / 2486 <br>Proportion of people visiting this city: 10.740%","City name:  Morges <br>Number of people visiting this city: 181 / 2486 <br>Proportion of people visiting this city: 7.281%","City name:  Nyon <br>Number of people visiting this city: 153 / 2486 <br>Proportion of people visiting this city: 6.154%","City name:  Orbe <br>Number of people visiting this city: 9 / 2486 <br>Proportion of people visiting this city: 0.362%","City name:  Ormont-Dessous <br>Number of people visiting this city: 6 / 2486 <br>Proportion of people visiting this city: 0.241%","City name:  Ormont-Dessus <br>Number of people visiting this city: 12 / 2486 <br>Proportion of people visiting this city: 0.483%","City name:  Payerne <br>Number of people visiting this city: 4 / 2486 <br>Proportion of people visiting this city: 0.161%","City name:  Prangins <br>Number of people visiting this city: 5 / 2486 <br>Proportion of people visiting this city: 0.201%","City name:  Renens <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Rolle <br>Number of people visiting this city: 5 / 2486 <br>Proportion of people visiting this city: 0.201%","City name:  Rossinière <br>Number of people visiting this city: 8 / 2486 <br>Proportion of people visiting this city: 0.322%","City name:  Rougemont <br>Number of people visiting this city: 69 / 2486 <br>Proportion of people visiting this city: 2.776%","City name:  Saint-Légier-La-Chiésaz <br>Number of people visiting this city: 2 / 2486 <br>Proportion of people visiting this city: 0.080%","City name:  Saint-Sulpice (VD) <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Saint Croix <br>Number of people visiting this city: 8 / 2486 <br>Proportion of people visiting this city: 0.322%","City name:  St. Aubin <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Valbroye <br>Number of people visiting this city: 1 / 2486 <br>Proportion of people visiting this city: 0.040%","City name:  Vallorbe <br>Number of people visiting this city: 20 / 2486 <br>Proportion of people visiting this city: 0.805%","City name:  Vevey <br>Number of people visiting this city: 66 / 2486 <br>Proportion of people visiting this city: 2.655%","City name:  Veytaux <br>Number of people visiting this city: 6 / 2486 <br>Proportion of people visiting this city: 0.241%","City name:  Villars-sur-Ollon <br>Number of people visiting this city: 79 / 2486 <br>Proportion of people visiting this city: 3.178%","City name:  Villeneuve (VD) <br>Number of people visiting this city: 7 / 2486 <br>Proportion of people visiting this city: 0.282%","City name:  Yens <br>Number of people visiting this city: 3 / 2486 <br>Proportion of people visiting this city: 0.121%","City name:  Yverdon-les-Bains <br>Number of people visiting this city: 133 / 2486 <br>Proportion of people visiting this city: 5.350%","City name:  Yvonand <br>Number of people visiting this city: 4 / 2486 <br>Proportion of people visiting this city: 0.161%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-70c8862894a8dc889b5f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-70c8862894a8dc889b5f">{"x":{"visdat":{"15806f61336c":["function () ","plotlyVisDat"]},"cur_data":"15806f61336c","attrs":{"15806f61336c":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (District)","xaxis":{"domain":[0,1],"automargin":true,"title":"District","showgrid":false,"zeroline":false,"type":"category","categoryorder":"array","categoryarray":["Lausanne","Riviera-Pays-d'Enhaut","Aigle","Jura-Nord vaudois","Morges","Nyon","Lavaux-Oron","Broye-Vully","Ouest lausannois","Gros-de-Vaud"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Aigle","Broye-Vully","Gros-de-Vaud","Jura-Nord vaudois","Lausanne","Lavaux-Oron","Morges","Nyon","Ouest lausannois","Riviera-Pays-d'Enhaut"],"y":[0.18946098149637972,0.012067578439259855,0.00040225261464199515,0.12952534191472245,0.25221238938053098,0.013274336283185841,0.076025744167337081,0.071198712791633145,0.0052292839903459376,0.25060337892196299],"text":["","","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text","text"],"hovertext":["District name:  Aigle <br>Number of people visiting this district: 471 / 2486 <br>Proportion of people visiting this district: 18.95%","District name:  Broye-Vully <br>Number of people visiting this district: 30 / 2486 <br>Proportion of people visiting this district: 1.21%","District name:  Gros-de-Vaud <br>Number of people visiting this district: 1 / 2486 <br>Proportion of people visiting this district: 0.04%","District name:  Jura-Nord vaudois <br>Number of people visiting this district: 322 / 2486 <br>Proportion of people visiting this district: 12.95%","District name:  Lausanne <br>Number of people visiting this district: 627 / 2486 <br>Proportion of people visiting this district: 25.22%","District name:  Lavaux-Oron <br>Number of people visiting this district: 33 / 2486 <br>Proportion of people visiting this district: 1.33%","District name:  Morges <br>Number of people visiting this district: 189 / 2486 <br>Proportion of people visiting this district: 7.60%","District name:  Nyon <br>Number of people visiting this district: 177 / 2486 <br>Proportion of people visiting this district: 7.12%","District name:  Ouest lausannois <br>Number of people visiting this district: 13 / 2486 <br>Proportion of people visiting this district: 0.52%","District name:  Riviera-Pays-d'Enhaut <br>Number of people visiting this district: 623 / 2486 <br>Proportion of people visiting this district: 25.06%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As we can see, out of the 67 city surveyed in the 10 district, the most popular district is Lausanne. This is not really suprising because of the way the data was collected. More people were surveyed in these city/districts than other smaller one. It is still interesting to have a look to keep this in mind.</p>
</section>
<section id="hotels-stars" class="level2">
<h2 class="anchored" data-anchor-id="hotels-stars">Hotels Stars</h2>
<p>Now, let’s have a look at the hotel standing of the places where the people stayed. This will highlight the quality of the stay per district.</p>
<section id="average-stars-per-district" class="level3">
<h3 class="anchored" data-anchor-id="average-stars-per-district">Average Stars per District</h3>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3868bf478650710d7c5e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-3868bf478650710d7c5e">{"x":{"visdat":{"15802bef371":["function () ","plotlyVisDat"]},"cur_data":"15802bef371","attrs":{"15802bef371":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"name":"Average Stars","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Average Stars per District","xaxis":{"domain":[0,1],"automargin":true,"title":"City","type":"category","categoryorder":"array","categoryarray":["Ouest lausannois","Riviera-Pays-d'Enhaut","Nyon","Morges","Lausanne","Aigle","Jura-Nord vaudois","Broye-Vully","Lavaux-Oron","Gros-de-Vaud"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Stars"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Ouest lausannois","Riviera-Pays-d'Enhaut","Nyon","Morges","Lausanne","Aigle","Jura-Nord vaudois","Broye-Vully","Lavaux-Oron"],"y":[4,3.6600000000000001,3.5600000000000001,3.54,3.52,3.3900000000000001,3.3500000000000001,3.3300000000000001,3.2999999999999998],"text":["","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text"],"hovertext":["District name:  Ouest lausannois <br>Average Stars: 4 <br>Number of people visiting this district: 13 / 2486","District name:  Riviera-Pays-d'Enhaut <br>Average Stars: 3.66 <br>Number of people visiting this district: 623 / 2486","District name:  Nyon <br>Average Stars: 3.56 <br>Number of people visiting this district: 177 / 2486","District name:  Morges <br>Average Stars: 3.54 <br>Number of people visiting this district: 189 / 2486","District name:  Lausanne <br>Average Stars: 3.52 <br>Number of people visiting this district: 627 / 2486","District name:  Aigle <br>Average Stars: 3.39 <br>Number of people visiting this district: 471 / 2486","District name:  Jura-Nord vaudois <br>Average Stars: 3.35 <br>Number of people visiting this district: 322 / 2486","District name:  Broye-Vully <br>Average Stars: 3.33 <br>Number of people visiting this district: 30 / 2486","District name:  Lavaux-Oron <br>Average Stars: 3.3 <br>Number of people visiting this district: 33 / 2486"],"name":"Average Stars","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As we can see on the graph above, the best average is optain in Ouest lausannois with an average of 4 stars. But this statistics is not very representative to the reality. Only 13 people answered the survey in this district which is not enough to have a good idea of the quality of the hotels in this district. The second best region after Ouest lausannois is Riviera-Pays-d’Enhaut with an average of 3.66 stars. This district got with 623 observation which is more representative. This high score for the Region of Riviera-Pays-d’Enhaut is not really surprising given the fact that this place is well know for its luxury hotels.</p>
</section>
<section id="distribution-of-stars-by-district" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-stars-by-district">Distribution of Stars by District</h3>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.619</code></pre>
</div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/Distribution%20of%20Stars%20by%20City-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="partie-jeff" class="level1">
<h1>Partie Jeff</h1>
<section id="average-spending-by-category-no-package-tour" class="level2">
<h2 class="anchored" data-anchor-id="average-spending-by-category-no-package-tour">Average Spending by category (no package tour)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>spending_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spending_Type =</span> <span class="fu">c</span>(<span class="st">"Overnight stay"</span>, <span class="st">"Transports"</span>, <span class="st">"Food &amp; Drink"</span>, <span class="st">"Souvenirs"</span>, <span class="st">"Other shopping"</span>, <span class="st">"Other expenses"</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount =</span> <span class="fu">c</span>(<span class="fu">mean</span>(data<span class="sc">$</span>F81_01, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_02, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_03, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_04, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_05, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_06, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spending_data, <span class="fu">aes</span>(<span class="at">x =</span> Spending_Type, <span class="at">y =</span> Amount, <span class="at">fill =</span> Spending_Type)) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Spending by Category (no package tour)"</span>, <span class="at">x =</span> <span class="st">"Category"</span>, <span class="at">y =</span> <span class="st">"Average Amount"</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Rotate x-axis labels for readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="average-spending-by-category-with-package" class="level2">
<h2 class="anchored" data-anchor-id="average-spending-by-category-with-package">Average Spending by Category (with package)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>spending_data_package <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spending_Type =</span> <span class="fu">c</span>(<span class="st">"Package"</span>, <span class="st">"Overnight stay"</span>, <span class="st">"Transports"</span>, <span class="st">"Food &amp; Drink"</span>, <span class="st">"Souvenirs"</span>, <span class="st">"Other shopping"</span>, <span class="st">"Other expenses"</span>),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount =</span> <span class="fu">c</span>(<span class="fu">mean</span>(data<span class="sc">$</span>F82_01, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_02, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_03, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_04, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_05, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_06, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_07, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spending_data_package, <span class="fu">aes</span>(<span class="at">x =</span> Spending_Type, <span class="at">y =</span> Amount, <span class="at">fill =</span> Spending_Type)) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Spending by Category"</span>, <span class="at">x =</span> <span class="st">"Category"</span>, <span class="at">y =</span> <span class="st">"Average Amount"</span>) <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="comparison-of-spending-with-without-package" class="level3">
<h3 class="anchored" data-anchor-id="comparison-of-spending-with-without-package">Comparison of Spending with &amp; without package</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data for spending without package</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>spending_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spending_Type =</span> <span class="fu">c</span>(<span class="st">"Overnight stay"</span>, <span class="st">"Transports"</span>, <span class="st">"Food &amp; Drink"</span>, <span class="st">"Souvenirs"</span>, <span class="st">"Other shopping"</span>, <span class="st">"Other expenses"</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount =</span> <span class="fu">c</span>(<span class="fu">mean</span>(data<span class="sc">$</span>F81_01, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_02, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_03, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_04, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_05, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_06, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Data for spending with package</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>spending_data_package <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spending_Type =</span> <span class="fu">c</span>(<span class="st">"Package"</span>, <span class="st">"Overnight stay"</span>, <span class="st">"Transports"</span>, <span class="st">"Food &amp; Drink"</span>, <span class="st">"Souvenirs"</span>, <span class="st">"Other shopping"</span>, <span class="st">"Other expenses"</span>),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount =</span> <span class="fu">c</span>(<span class="fu">mean</span>(data<span class="sc">$</span>F82_01, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_02, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_03, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_04, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_05, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_06, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_07, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plotly objects for each spending type</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(spending_data, <span class="at">x =</span> <span class="sc">~</span>Spending_Type, <span class="at">y =</span> <span class="sc">~</span>Amount, <span class="at">type =</span> <span class="st">'bar'</span>, <span class="at">name =</span> <span class="st">'No Package'</span>,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'rgba(50, 171, 96, 0.6)'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'rgba(50, 171, 96, 1.0)'</span>, <span class="at">width =</span> <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Average Spending by Category (No Package Tour)"</span>,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Category"</span>, <span class="at">tickangle =</span> <span class="dv">45</span>),</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Average Amount"</span>),</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">barmode =</span> <span class="st">'group'</span>)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(spending_data_package, <span class="at">x =</span> <span class="sc">~</span>Spending_Type, <span class="at">y =</span> <span class="sc">~</span>Amount, <span class="at">type =</span> <span class="st">'bar'</span>, <span class="at">name =</span> <span class="st">'With Package'</span>,</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'rgba(128, 0, 128, 0.6)'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'rgba(128, 0, 128, 1.0)'</span>, <span class="at">width =</span> <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Average Spending by Category (With Package)"</span>,</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Category"</span>, <span class="at">tickangle =</span> <span class="dv">45</span>),</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Average Amount"</span>),</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">barmode =</span> <span class="st">'group'</span>)</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots into a single plot with a dropdown menu</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="fu">subplot</span>(p1, p2, <span class="at">nrows =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Comparison of Spending With and Without Package"</span>,</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">updatemenus =</span> <span class="fu">list</span>(</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fl">0.7</span>,</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">buttons =</span> <span class="fu">list</span>(</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"relayout"</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="st">"visible"</span>, <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>)), <span class="at">label =</span> <span class="st">"No Package"</span>),</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"relayout"</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="st">"visible"</span>, <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>)), <span class="at">label =</span> <span class="st">"With Package"</span>)</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a09ca6e452276427866f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a09ca6e452276427866f">{"x":{"data":[{"x":["Overnight stay","Transports","Food & Drink","Souvenirs","Other shopping","Other expenses"],"y":[2865.4582787243339,793.14154652686761,1463.8374836173002,806.95806028833556,331.21930974224551,548.9266055045872],"marker":{"color":"rgba(50, 171, 96, 0.6)","line":{"color":"rgba(50, 171, 96, 1.0)","width":1}},"name":"No Package","type":"bar","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Package","Overnight stay","Transports","Food & Drink","Souvenirs","Other shopping","Other expenses"],"y":[2406518.6173469387,1809.5306122448981,788.33163265306121,1962.4489795918366,1017.6428571428571,581.37755102040819,316.25],"marker":{"color":"rgba(128, 0, 128, 0.6)","line":{"color":"rgba(128, 0, 128, 1.0)","width":1}},"name":"With Package","type":"bar","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.47999999999999998],"automargin":true,"tickangle":45,"type":"category","categoryorder":"array","categoryarray":["Food & Drink","Other expenses","Other shopping","Overnight stay","Souvenirs","Transports"],"anchor":"y"},"xaxis2":{"domain":[0.52000000000000002,1],"automargin":true,"tickangle":45,"type":"category","categoryorder":"array","categoryarray":["Food & Drink","Other expenses","Other shopping","Overnight stay","Package","Souvenirs","Transports"],"anchor":"y2"},"yaxis2":{"domain":[0,1],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0,1],"automargin":true,"anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Comparison of Spending With and Without Package","barmode":"group","hovermode":"closest","showlegend":true,"updatemenus":[{"y":0.69999999999999996,"buttons":[{"method":"relayout","args":["visible",[true,false]],"label":"No Package"},{"method":"relayout","args":["visible",[false,true]],"label":"With Package"}]}]},"attrs":{"15803d183ea7":{"x":{},"y":{},"marker":{"color":"rgba(50, 171, 96, 0.6)","line":{"color":"rgba(50, 171, 96, 1.0)","width":1}},"name":"No Package","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"158062e05f36":{"x":{},"y":{},"marker":{"color":"rgba(128, 0, 128, 0.6)","line":{"color":"rgba(128, 0, 128, 1.0)","width":1}},"name":"With Package","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="distribution-of-currency" class="level2">
<h2 class="anchored" data-anchor-id="distribution-of-currency">Distribution of Currency</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the frequency and percentage of each currency value</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>currency_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(F80) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar chart</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(currency_data, <span class="fu">aes</span>(<span class="at">x =</span> F80, <span class="at">y =</span> Percentage, <span class="at">fill =</span> F80)) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Currency"</span>, <span class="at">x =</span> <span class="st">"Currency"</span>, <span class="at">y =</span> <span class="st">"Percentage (%)"</span>) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Adjust text angle for better readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="responses-in-to-the-question-who-did-you-travel-with" class="level2">
<h2 class="anchored" data-anchor-id="responses-in-to-the-question-who-did-you-travel-with">Responses in % to the question “Who did you travel with?”</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/TMS_dataset_Vaud_20240314_FINAL.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>explanations <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/explanations.csv"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">colnames</span>(data) <span class="sc">==</span> <span class="st">"F31_01"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">colnames</span>(data) <span class="sc">==</span> <span class="st">"F32"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> data[, <span class="dv">18</span><span class="sc">:</span><span class="dv">33</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep english columns only</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">17</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2  4  6  8 10 12 14 16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[, <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">17</span>, <span class="dv">2</span>)]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set responses to binary values</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(df)) {</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  df[, i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df[, i] <span class="sc">==</span> <span class="st">"Applies"</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(df[, i] <span class="sc">==</span> <span class="st">"Not applicable"</span>, <span class="dv">0</span>, <span class="cn">NA</span>))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We add a column to separate couples from families. Here people only traveled with their partner.</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>couples <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>F31_02_ENG <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> df<span class="sc">$</span>F31_03_ENG <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> df<span class="sc">$</span>F31_04_ENG <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> df<span class="sc">$</span>F31_05_ENG <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Sums of responses for frequency plot</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>df_sums <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">names</span>(df)) {</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  df_sums[[col]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(df[[col]])</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot of frequency of responses</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>df_sums_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Column =</span> <span class="fu">names</span>(df_sums), <span class="at">Sum =</span> <span class="fu">unlist</span>(df_sums))</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Change column names in df_sums_df</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>df_sums_df<span class="sc">$</span>Column <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Alone"</span>, <span class="st">"Partner"</span>, <span class="st">"Friends"</span>, <span class="st">"Children"</span>, <span class="st">"Other family"</span>, <span class="st">"Unknown people (group)"</span>, <span class="st">"Dog"</span>, <span class="st">"Other pet(s)"</span>, <span class="st">"Only with partner"</span>)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_sums_df)[<span class="fu">colnames</span>(df_sums_df) <span class="sc">==</span> <span class="st">"Traveled with"</span>] <span class="ot">&lt;-</span> <span class="st">"Column"</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by descending sum</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>df_sums_df<span class="sc">$</span>Column <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_sums_df<span class="sc">$</span>Column, <span class="at">levels =</span> df_sums_df<span class="sc">$</span>Column[<span class="fu">order</span>(<span class="sc">-</span>df_sums_df<span class="sc">$</span>Sum)])</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot frequency of "traveled with" groups</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(df_sums_df, aes(x = Column, y = Sum)) +</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_bar(stat = "identity", fill = "skyblue") +</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="co">#  labs(title = "Frequency of responses", x = "Traveled with", y = "Sum")</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a><span class="co"># make the plot in percentages</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>df_sums_df<span class="sc">$</span>Percentage <span class="ot">&lt;-</span> (df_sums_df<span class="sc">$</span>Sum)<span class="sc">/</span><span class="fu">nrow</span>(df)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_sums_df, <span class="fu">aes</span>(<span class="at">x =</span> Column, <span class="at">y =</span> Percentage)) <span class="sc">+</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frequency of responses"</span>, <span class="at">x =</span> <span class="st">"Traveled with"</span>, <span class="at">y =</span> <span class="st">"Percentage"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="percentage-of-tourists-that-are-swiss-german-and-swiss" class="level2">
<h2 class="anchored" data-anchor-id="percentage-of-tourists-that-are-swiss-german-and-swiss">Percentage of tourists that are Swiss german and Swiss</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>swiss_german_cantons <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Luzern"</span>, <span class="st">"Schwyz"</span>, <span class="st">"Bern"</span>, <span class="st">"Neuenburg"</span>, <span class="st">"Aargau"</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Zürich"</span>, <span class="st">"Basel-Stadt"</span>, <span class="st">"Basel-Landschaft"</span>, <span class="st">"Obwalden"</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Appenzell Innerrhoden"</span>, <span class="st">"Schaffhausen"</span>, <span class="st">"Thurgau"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"St. Gallen"</span>, <span class="st">"Solothurn"</span>, <span class="st">"Uri"</span>, <span class="st">"Zug"</span>, <span class="st">"Nidwalden"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Appenzell Ausserrhoden"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Binary column for swiss germans</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>swiss_german <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>F05_02 <span class="sc">==</span> <span class="st">"Schweiz"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>F05_03 <span class="sc">%in%</span> swiss_german_cantons, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent of total tourists that are Swiss-German</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data[data<span class="sc">$</span>swiss_german <span class="sc">==</span> <span class="dv">1</span>,])<span class="sc">/</span><span class="fu">nrow</span>(data)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.4288</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent of total tourists that are Swiss</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data[data<span class="sc">$</span>F05_02 <span class="sc">==</span> <span class="st">"Schweiz"</span>,])<span class="sc">/</span><span class="fu">nrow</span>(data)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31.61706</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>