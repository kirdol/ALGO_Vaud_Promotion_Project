<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>eda</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="EDA_files/libs/clipboard/clipboard.min.js"></script>
<script src="EDA_files/libs/quarto-html/quarto.js"></script>
<script src="EDA_files/libs/quarto-html/popper.min.js"></script>
<script src="EDA_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="EDA_files/libs/quarto-html/anchor.min.js"></script>
<link href="EDA_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="EDA_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="EDA_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="EDA_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="EDA_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="EDA_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="EDA_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="EDA_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="EDA_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="EDA_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="EDA_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="EDA_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="EDA_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="EDA_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="EDA_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="EDA_files/libs/datatables-binding-0.33/datatables.js"></script>
<link href="EDA_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="EDA_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="EDA_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="EDA_files/libs/dt-plugin-searchhighlight-1.13.6/source.css" rel="stylesheet">
<script src="EDA_files/libs/dt-plugin-searchhighlight-1.13.6/jquery.highlight.js"></script>
<script src="EDA_files/libs/dt-plugin-searchhighlight-1.13.6/source.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory Data Analysis</h1>
<section id="visitor-demographics" class="level2">
<h2 class="anchored" data-anchor-id="visitor-demographics">Visitor Demographics</h2>
<section id="global-distribution-of-visitors-to-the-canton-of-vaud-by-continent" class="level3">
<h3 class="anchored" data-anchor-id="global-distribution-of-visitors-to-the-canton-of-vaud-by-continent">Global Distribution of Visitors to the Canton of Vaud by Continent</h3>
<p>With the data gathered from the survey, we have first explored the overall distribution of nationalities of the visitors. Therefore, you will find here a graph providing the percentage of visitors per continent that came to visit the Canton of Vaud. You will find more details about the number of occurrences and percentages per continent in the Annex.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">### F05_01.ENG </span><span class="al">###</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># nb of occurrences by country and continents </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>OccurencesCountry <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data<span class="sc">$</span>F05_02_ENG) <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>OccurencesContinent <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data<span class="sc">$</span>F05_01_ENG) <span class="sc">%&gt;%</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Continent in percentages</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>F05_01_PCT <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Percentage)) <span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Continent_of_origin =</span> F05_01_ENG)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot numbers continent </span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(F05_01_PCT,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Continent_of_origin, Percentage<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span>Percentage<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span>Continent_of_origin)) <span class="sc">+</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Continents of Origin"</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Percentages"</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Distribution of Visitors per Continent in Percentage, in the whole canton"</span>) <span class="sc">+</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, Percentage<span class="sc">*</span><span class="dv">100</span>)),</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="sc">-</span><span class="fl">0.5</span>),</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.01</span>,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-1-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We notice that a large part of the people surveyed were coming from Europe (approx. 78%), followed by people coming from Asia (approx. 8%), North and Central America (approx. 8%), South America (approx. 3%) Australia and Oceania (approx. 2%) and finally Africa (approx. 1%). Again, these results were concerning the whole canton.</p>
</section>
<section id="global-distribution-of-visitors-to-the-canton-of-vaud-by-nationality" class="level3">
<h3 class="anchored" data-anchor-id="global-distribution-of-visitors-to-the-canton-of-vaud-by-nationality">Global Distribution of Visitors to the Canton of Vaud by Nationality</h3>
<p>We have then decided to explore the distribution in percentage of the nationalities per continent. You will find here a graph showing our results. To enhance visibility, we have gathered most of the countries in the variable “Other Countries” and added it on the graph with the remaining top 7 most represented countries in the list. You can find the whole table about the number of occurrences and percentages per nationality in the Annex.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Our results show that Switzerland is the nationality the most represented among all the visitor (approx. 31.5%). Therefore, there are a lot of domestic visitors travelling to the canton of Vaud. Also, we see again that the most represented nationalities are Europeans, such as France (approx. 14.5%), United Kingdom (appox. 7.5%), Germany (approx. 5.5%), Belgium (approx. 3.5%) and finally Spain (approx. 3%). The only other nationality coming from a other continent represented here is the United States of America (approx. 5.5%). Proximity could be for instance one of the main factor explaining these results.</p>
</section>
</section>
<section id="city-and-district-visitor-distributions" class="level2">
<h2 class="anchored" data-anchor-id="city-and-district-visitor-distributions">City and District Visitor Distributions</h2>
<p><strong>Per city, the percentage of each visitor’s country of origin, relative to the number of visitor of the city</strong></p>
<p>Now in order to know more precisely about the destination of the visitors, we have decided to gather by city the percentage of country of origin.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Counting the number of tourists by city and nationality</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tourists_by_nationality <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_Code, F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the total number of tourists per city</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>total_tourists_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_Code) <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalCount =</span> <span class="fu">sum</span>(Count), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(TotalCount)) </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#top 10 cities </span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># top_10_cities &lt;- total_tourists_per_city %&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(desc(TotalCount)) %&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   head(10)</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining the counts back to the detailed breakdown and calculating the ratio</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># nationality_ratio_per_city &lt;- tourists_by_nationality %&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(total_tourists_per_city, by = "F105_Code") %&gt;%</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Ratio = round((Count / TotalCount),3)) %&gt;%</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(F105_Code, F05_02_ENG, Ratio) %&gt;%</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename(City = F105_Code, Country_of_origin = F05_02_ENG)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining the counts back to the detailed breakdown and calculating the ratio</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>nationality_ratio_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(total_tourists_per_city, <span class="at">by =</span> <span class="st">"F105_Code"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(TotalCount))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Identify the top 10 cities by TotalCount</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>top_10_cities <span class="ot">&lt;-</span> nationality_ratio_per_city <span class="sc">%&gt;%</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(F105_Code, TotalCount) <span class="sc">%&gt;%</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(TotalCount)) <span class="sc">%&gt;%</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(F105_Code)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Split the data into top 10 cities and the remaining cities</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>top_cities_data <span class="ot">&lt;-</span> nationality_ratio_per_city <span class="sc">%&gt;%</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(F105_Code <span class="sc">%in%</span> top_10_cities)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>other_cities_data <span class="ot">&lt;-</span> nationality_ratio_per_city <span class="sc">%&gt;%</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>F105_Code <span class="sc">%in%</span> top_10_cities)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Aggregate the remaining cities into a single "other" observation</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>other_summary <span class="ot">&lt;-</span> other_cities_data <span class="sc">%&gt;%</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">F105_Code =</span> <span class="st">"Other"</span>,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">sum</span>(Count),</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">TotalCount =</span> <span class="fu">sum</span>(TotalCount)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Combine the top 10 cities with the "other" observation</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  top_cities_data,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  other_summary</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>NB_TotalCount_Other <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(<span class="at">F105_Code =</span> <span class="st">"Other Continents"</span>, <span class="at">F05_02_ENG =</span> <span class="st">"Other Countries"</span>, <span class="at">Count =</span> <span class="fu">sum</span>(final_data<span class="sc">$</span>Count[<span class="dv">300</span><span class="sc">:</span><span class="dv">346</span>]), <span class="at">TotalCount =</span> <span class="fu">sum</span>(final_data<span class="sc">$</span>TotalCount[<span class="dv">300</span><span class="sc">:</span><span class="dv">346</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(F105_Code <span class="sc">==</span><span class="st">"Other Continents"</span>)</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data frame is named `final_data`</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TotalCount =</span> <span class="fu">if_else</span>(F105_Code <span class="sc">==</span> <span class="st">"Other"</span>, <span class="dv">3390</span>, TotalCount)) </span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Group by F105_Code and compute the ratio</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_Code) <span class="sc">%&gt;%</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> <span class="fu">round</span>(Count <span class="sc">/</span> TotalCount, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_Code, F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Ratio))</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Sum the Ratio for a specific city (e.g., "Lausanne")</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>sum_ratio_lausanne <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(F105_Code <span class="sc">==</span> <span class="st">"Morges"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">SumRatio =</span> <span class="fu">sum</span>(Ratio)) <span class="sc">%&gt;%</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(SumRatio) <span class="do">###why &gt; 1 ??</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'F105_Code'. You can override using the
`.groups` argument.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotly</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(final_data, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="sc">~</span>F105_Code, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="sc">~</span>Ratio, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="sc">~</span>F05_02_ENG, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">'bar'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">'Stacked Bar Plot of Ratios by City and Nationality'</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'City'</span>, <span class="at">tickangle =</span> <span class="sc">-</span><span class="dv">45</span>),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Ratio'</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">barmode =</span> <span class="st">'stack'</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">showlegend =</span> <span class="cn">FALSE</span>)  <span class="co"># Remove the legend</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9aa1dfb205bebe5b4766" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9aa1dfb205bebe5b4766">{"x":{"visdat":{"beead5282a7":["function () ","plotlyVisDat"]},"cur_data":"beead5282a7","attrs":{"beead5282a7":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Stacked Bar Plot of Ratios by City and Nationality","xaxis":{"domain":[0,1],"automargin":true,"title":"City","tickangle":-45,"type":"category","categoryorder":"array","categoryarray":["Château-d'Oex","Lausanne","Les Diablerets","Leysin","Montreux","Morges","Nyon","Other","Rougemont","Villars-sur-Ollon","Yverdon-les-Bains"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Ratio"},"barmode":"stack","showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Morges"],"y":[0.0060000000000000001],"type":"bar","name":"Albania","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux"],"y":[0.0040000000000000001],"type":"bar","name":"Andorra","marker":{"color":"rgba(120,191,160,1)","line":{"color":"rgba(120,191,160,1)"}},"textfont":{"color":"rgba(120,191,160,1)"},"error_y":{"color":"rgba(120,191,160,1)"},"error_x":{"color":"rgba(120,191,160,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morges","Yverdon-les-Bains","Nyon","Lausanne","Other"],"y":[0.010999999999999999,0.0080000000000000002,0.0070000000000000001,0.0030000000000000001,0],"type":"bar","name":"Argentina","marker":{"color":"rgba(135,188,155,1)","line":{"color":"rgba(135,188,155,1)"}},"textfont":{"color":"rgba(135,188,155,1)"},"error_y":{"color":"rgba(135,188,155,1)"},"error_x":{"color":"rgba(135,188,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon"],"y":[0.0070000000000000001],"type":"bar","name":"Armenia","marker":{"color":"rgba(149,185,151,1)","line":{"color":"rgba(149,185,151,1)"}},"textfont":{"color":"rgba(149,185,151,1)"},"error_y":{"color":"rgba(149,185,151,1)"},"error_x":{"color":"rgba(149,185,151,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon","Montreux","Les Diablerets","Lausanne","Villars-sur-Ollon","Morges","Leysin","Other"],"y":[0.045999999999999999,0.036999999999999998,0.025000000000000001,0.012999999999999999,0.012999999999999999,0.0060000000000000001,0.0050000000000000001,0.001],"type":"bar","name":"Australia","marker":{"color":"rgba(161,182,146,1)","line":{"color":"rgba(161,182,146,1)"}},"textfont":{"color":"rgba(161,182,146,1)"},"error_y":{"color":"rgba(161,182,146,1)"},"error_x":{"color":"rgba(161,182,146,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon","Yverdon-les-Bains","Morges","Montreux","Lausanne","Other"],"y":[0.02,0.0080000000000000002,0.0060000000000000001,0.0040000000000000001,0.002,0],"type":"bar","name":"Austria","marker":{"color":"rgba(172,179,141,1)","line":{"color":"rgba(172,179,141,1)"}},"textfont":{"color":"rgba(172,179,141,1)"},"error_y":{"color":"rgba(172,179,141,1)"},"error_x":{"color":"rgba(172,179,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Leysin","Villars-sur-Ollon","Les Diablerets","Château-d'Oex","Nyon","Lausanne","Morges","Montreux","Other"],"y":[0.16800000000000001,0.075999999999999998,0.041000000000000002,0.039,0.025999999999999999,0.024,0.017000000000000001,0.010999999999999999,0.0040000000000000001],"type":"bar","name":"Belgium","marker":{"color":"rgba(183,175,136,1)","line":{"color":"rgba(183,175,136,1)"}},"textfont":{"color":"rgba(183,175,136,1)"},"error_y":{"color":"rgba(183,175,136,1)"},"error_x":{"color":"rgba(183,175,136,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Bolivia","marker":{"color":"rgba(193,172,132,1)","line":{"color":"rgba(193,172,132,1)"}},"textfont":{"color":"rgba(193,172,132,1)"},"error_y":{"color":"rgba(193,172,132,1)"},"error_x":{"color":"rgba(193,172,132,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Yverdon-les-Bains"],"y":[0.0080000000000000002],"type":"bar","name":"Bosnia and Herzegovina","marker":{"color":"rgba(202,168,127,1)","line":{"color":"rgba(202,168,127,1)"}},"textfont":{"color":"rgba(202,168,127,1)"},"error_y":{"color":"rgba(202,168,127,1)"},"error_x":{"color":"rgba(202,168,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Montreux","Villars-sur-Ollon","Leysin","Les Diablerets","Nyon","Other"],"y":[0.032000000000000001,0.029999999999999999,0.012999999999999999,0.01,0.0080000000000000002,0.0070000000000000001,0.001],"type":"bar","name":"Brazil","marker":{"color":"rgba(211,164,122,1)","line":{"color":"rgba(211,164,122,1)"}},"textfont":{"color":"rgba(211,164,122,1)"},"error_y":{"color":"rgba(211,164,122,1)"},"error_x":{"color":"rgba(211,164,122,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Lausanne"],"y":[0.010999999999999999,0.002],"type":"bar","name":"Bulgaria","marker":{"color":"rgba(220,160,117,1)","line":{"color":"rgba(220,160,117,1)"}},"textfont":{"color":"rgba(220,160,117,1)"},"error_y":{"color":"rgba(220,160,117,1)"},"error_x":{"color":"rgba(220,160,117,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Château-d'Oex"],"y":[0.0060000000000000001],"type":"bar","name":"Cambodia","marker":{"color":"rgba(228,156,113,1)","line":{"color":"rgba(228,156,113,1)"}},"textfont":{"color":"rgba(228,156,113,1)"},"error_y":{"color":"rgba(228,156,113,1)"},"error_x":{"color":"rgba(228,156,113,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Montreux","Morges","Yverdon-les-Bains","Rougemont","Nyon","Leysin","Château-d'Oex","Other"],"y":[0.040000000000000001,0.034000000000000002,0.017000000000000001,0.014999999999999999,0.014,0.012999999999999999,0.01,0.0060000000000000001,0.001],"type":"bar","name":"Canada","marker":{"color":"rgba(236,151,108,1)","line":{"color":"rgba(236,151,108,1)"}},"textfont":{"color":"rgba(236,151,108,1)"},"error_y":{"color":"rgba(236,151,108,1)"},"error_x":{"color":"rgba(236,151,108,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux"],"y":[0.0040000000000000001],"type":"bar","name":"Cayman Islands","marker":{"color":"rgba(243,147,103,1)","line":{"color":"rgba(243,147,103,1)"}},"textfont":{"color":"rgba(243,147,103,1)"},"error_y":{"color":"rgba(243,147,103,1)"},"error_x":{"color":"rgba(243,147,103,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon","Lausanne","Montreux"],"y":[0.012999999999999999,0.0060000000000000001,0.0040000000000000001],"type":"bar","name":"Chile","marker":{"color":"rgba(251,142,99,1)","line":{"color":"rgba(251,142,99,1)"}},"textfont":{"color":"rgba(251,142,99,1)"},"error_y":{"color":"rgba(251,142,99,1)"},"error_x":{"color":"rgba(251,142,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Villars-sur-Ollon","Montreux","Lausanne","Nyon","Morges","Les Diablerets","Château-d'Oex","Other"],"y":[0.050999999999999997,0.044999999999999998,0.025999999999999999,0.012999999999999999,0.010999999999999999,0.0080000000000000002,0.0060000000000000001,0.001],"type":"bar","name":"China","marker":{"color":"rgba(247,142,105,1)","line":{"color":"rgba(247,142,105,1)"}},"textfont":{"color":"rgba(247,142,105,1)"},"error_y":{"color":"rgba(247,142,105,1)"},"error_x":{"color":"rgba(247,142,105,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Yverdon-les-Bains","Leysin","Montreux","Lausanne","Other"],"y":[0.014999999999999999,0.0050000000000000001,0.0040000000000000001,0.0030000000000000001,0.001],"type":"bar","name":"Colombia","marker":{"color":"rgba(241,144,112,1)","line":{"color":"rgba(241,144,112,1)"}},"textfont":{"color":"rgba(241,144,112,1)"},"error_y":{"color":"rgba(241,144,112,1)"},"error_x":{"color":"rgba(241,144,112,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon"],"y":[0.0070000000000000001],"type":"bar","name":"Costa Rica","marker":{"color":"rgba(235,146,120,1)","line":{"color":"rgba(235,146,120,1)"}},"textfont":{"color":"rgba(235,146,120,1)"},"error_y":{"color":"rgba(235,146,120,1)"},"error_x":{"color":"rgba(235,146,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morges","Leysin"],"y":[0.0060000000000000001,0.0050000000000000001],"type":"bar","name":"Croatia","marker":{"color":"rgba(229,147,127,1)","line":{"color":"rgba(229,147,127,1)"}},"textfont":{"color":"rgba(229,147,127,1)"},"error_y":{"color":"rgba(229,147,127,1)"},"error_x":{"color":"rgba(229,147,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Leysin"],"y":[0.0050000000000000001],"type":"bar","name":"Cyprus","marker":{"color":"rgba(223,148,135,1)","line":{"color":"rgba(223,148,135,1)"}},"textfont":{"color":"rgba(223,148,135,1)"},"error_y":{"color":"rgba(223,148,135,1)"},"error_x":{"color":"rgba(223,148,135,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Morges","Leysin","Yverdon-les-Bains","Lausanne","Other"],"y":[0.025999999999999999,0.017000000000000001,0.014999999999999999,0.0080000000000000002,0.0060000000000000001,0.001],"type":"bar","name":"Czechia","marker":{"color":"rgba(216,150,142,1)","line":{"color":"rgba(216,150,142,1)"}},"textfont":{"color":"rgba(216,150,142,1)"},"error_y":{"color":"rgba(216,150,142,1)"},"error_x":{"color":"rgba(216,150,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Les Diablerets","Nyon","Lausanne"],"y":[0.0080000000000000002,0.0070000000000000001,0.0030000000000000001],"type":"bar","name":"Denmark","marker":{"color":"rgba(209,151,149,1)","line":{"color":"rgba(209,151,149,1)"}},"textfont":{"color":"rgba(209,151,149,1)"},"error_y":{"color":"rgba(209,151,149,1)"},"error_x":{"color":"rgba(209,151,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Ecuador","marker":{"color":"rgba(201,152,157,1)","line":{"color":"rgba(201,152,157,1)"}},"textfont":{"color":"rgba(201,152,157,1)"},"error_y":{"color":"rgba(201,152,157,1)"},"error_x":{"color":"rgba(201,152,157,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Egypt","marker":{"color":"rgba(193,154,164,1)","line":{"color":"rgba(193,154,164,1)"}},"textfont":{"color":"rgba(193,154,164,1)"},"error_y":{"color":"rgba(193,154,164,1)"},"error_x":{"color":"rgba(193,154,164,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon","Montreux","Other"],"y":[0.0070000000000000001,0.0040000000000000001,0],"type":"bar","name":"Finland","marker":{"color":"rgba(185,155,171,1)","line":{"color":"rgba(185,155,171,1)"}},"textfont":{"color":"rgba(185,155,171,1)"},"error_y":{"color":"rgba(185,155,171,1)"},"error_x":{"color":"rgba(185,155,171,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Nyon","Château-d'Oex","Villars-sur-Ollon","Morges","Les Diablerets","Montreux","Leysin","Rougemont","Yverdon-les-Bains","Other"],"y":[0.19900000000000001,0.17599999999999999,0.17100000000000001,0.127,0.105,0.099000000000000005,0.094,0.088999999999999996,0.071999999999999995,0.068000000000000005,0.023],"type":"bar","name":"France","marker":{"color":"rgba(176,156,179,1)","line":{"color":"rgba(176,156,179,1)"}},"textfont":{"color":"rgba(176,156,179,1)"},"error_y":{"color":"rgba(176,156,179,1)"},"error_x":{"color":"rgba(176,156,179,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morges","Rougemont","Lausanne","Château-d'Oex","Montreux","Les Diablerets","Leysin","Nyon","Yverdon-les-Bains","Other"],"y":[0.087999999999999995,0.086999999999999994,0.072999999999999995,0.066000000000000003,0.049000000000000002,0.041000000000000002,0.040000000000000001,0.039,0.014999999999999999,0.0070000000000000001],"type":"bar","name":"Germany","marker":{"color":"rgba(167,157,186,1)","line":{"color":"rgba(167,157,186,1)"}},"textfont":{"color":"rgba(167,157,186,1)"},"error_y":{"color":"rgba(167,157,186,1)"},"error_x":{"color":"rgba(167,157,186,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Nyon","Other"],"y":[0.012999999999999999,0.012999999999999999,0.001],"type":"bar","name":"Greece","marker":{"color":"rgba(156,159,194,1)","line":{"color":"rgba(156,159,194,1)"}},"textfont":{"color":"rgba(156,159,194,1)"},"error_y":{"color":"rgba(156,159,194,1)"},"error_x":{"color":"rgba(156,159,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Château-d'Oex","Morges","Lausanne"],"y":[0.010999999999999999,0.010999999999999999,0.0060000000000000001,0.0030000000000000001],"type":"bar","name":"Hong Kong (CN)","marker":{"color":"rgba(145,160,201,1)","line":{"color":"rgba(145,160,201,1)"}},"textfont":{"color":"rgba(145,160,201,1)"},"error_y":{"color":"rgba(145,160,201,1)"},"error_x":{"color":"rgba(145,160,201,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morges","Lausanne"],"y":[0.010999999999999999,0.0030000000000000001],"type":"bar","name":"Hungary","marker":{"color":"rgba(147,159,203,1)","line":{"color":"rgba(147,159,203,1)"}},"textfont":{"color":"rgba(147,159,203,1)"},"error_y":{"color":"rgba(147,159,203,1)"},"error_x":{"color":"rgba(147,159,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Nyon","Rougemont","Lausanne","Château-d'Oex","Leysin","Other"],"y":[0.049000000000000002,0.033000000000000002,0.014,0.012999999999999999,0.0060000000000000001,0.0050000000000000001,0],"type":"bar","name":"India","marker":{"color":"rgba(154,158,202,1)","line":{"color":"rgba(154,158,202,1)"}},"textfont":{"color":"rgba(154,158,202,1)"},"error_y":{"color":"rgba(154,158,202,1)"},"error_x":{"color":"rgba(154,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Rougemont","Château-d'Oex","Lausanne"],"y":[0.014,0.0060000000000000001,0.002],"type":"bar","name":"Indonesia","marker":{"color":"rgba(161,157,201,1)","line":{"color":"rgba(161,157,201,1)"}},"textfont":{"color":"rgba(161,157,201,1)"},"error_y":{"color":"rgba(161,157,201,1)"},"error_x":{"color":"rgba(161,157,201,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Other"],"y":[0.0030000000000000001,0],"type":"bar","name":"Iran","marker":{"color":"rgba(168,155,201,1)","line":{"color":"rgba(168,155,201,1)"}},"textfont":{"color":"rgba(168,155,201,1)"},"error_y":{"color":"rgba(168,155,201,1)"},"error_x":{"color":"rgba(168,155,201,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Château-d'Oex","Morges","Leysin","Montreux","Lausanne"],"y":[0.010999999999999999,0.0060000000000000001,0.0050000000000000001,0.0040000000000000001,0.0030000000000000001],"type":"bar","name":"Ireland","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)"},"error_y":{"color":"rgba(175,154,200,1)"},"error_x":{"color":"rgba(175,154,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Lausanne"],"y":[0.010999999999999999,0.002],"type":"bar","name":"Israel","marker":{"color":"rgba(181,153,200,1)","line":{"color":"rgba(181,153,200,1)"}},"textfont":{"color":"rgba(181,153,200,1)"},"error_y":{"color":"rgba(181,153,200,1)"},"error_x":{"color":"rgba(181,153,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Villars-sur-Ollon","Château-d'Oex","Morges","Rougemont","Nyon","Montreux","Leysin","Les Diablerets","Other"],"y":[0.035000000000000003,0.025000000000000001,0.017000000000000001,0.017000000000000001,0.014,0.012999999999999999,0.010999999999999999,0.01,0.0080000000000000002,0.001],"type":"bar","name":"Italy","marker":{"color":"rgba(188,151,199,1)","line":{"color":"rgba(188,151,199,1)"}},"textfont":{"color":"rgba(188,151,199,1)"},"error_y":{"color":"rgba(188,151,199,1)"},"error_x":{"color":"rgba(188,151,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Ivory Coast","marker":{"color":"rgba(194,150,199,1)","line":{"color":"rgba(194,150,199,1)"}},"textfont":{"color":"rgba(194,150,199,1)"},"error_y":{"color":"rgba(194,150,199,1)"},"error_x":{"color":"rgba(194,150,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Japan","marker":{"color":"rgba(200,148,198,1)","line":{"color":"rgba(200,148,198,1)"}},"textfont":{"color":"rgba(200,148,198,1)"},"error_y":{"color":"rgba(200,148,198,1)"},"error_x":{"color":"rgba(200,148,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Villars-sur-Ollon"],"y":[0.012999999999999999],"type":"bar","name":"Jersey","marker":{"color":"rgba(206,146,197,1)","line":{"color":"rgba(206,146,197,1)"}},"textfont":{"color":"rgba(206,146,197,1)"},"error_y":{"color":"rgba(206,146,197,1)"},"error_x":{"color":"rgba(206,146,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon","Lausanne"],"y":[0.0070000000000000001,0.0030000000000000001],"type":"bar","name":"Kenya","marker":{"color":"rgba(212,145,197,1)","line":{"color":"rgba(212,145,197,1)"}},"textfont":{"color":"rgba(212,145,197,1)"},"error_y":{"color":"rgba(212,145,197,1)"},"error_x":{"color":"rgba(212,145,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon"],"y":[0.0070000000000000001],"type":"bar","name":"Kosovo","marker":{"color":"rgba(217,143,196,1)","line":{"color":"rgba(217,143,196,1)"}},"textfont":{"color":"rgba(217,143,196,1)"},"error_y":{"color":"rgba(217,143,196,1)"},"error_x":{"color":"rgba(217,143,196,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morges"],"y":[0.0060000000000000001],"type":"bar","name":"Kuwait","marker":{"color":"rgba(223,141,196,1)","line":{"color":"rgba(223,141,196,1)"}},"textfont":{"color":"rgba(223,141,196,1)"},"error_y":{"color":"rgba(223,141,196,1)"},"error_x":{"color":"rgba(223,141,196,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Kyrgyzstan","marker":{"color":"rgba(229,139,195,1)","line":{"color":"rgba(229,139,195,1)"}},"textfont":{"color":"rgba(229,139,195,1)"},"error_y":{"color":"rgba(229,139,195,1)"},"error_x":{"color":"rgba(229,139,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon","Château-d'Oex","Montreux"],"y":[0.0070000000000000001,0.0060000000000000001,0.0040000000000000001],"type":"bar","name":"Latvia","marker":{"color":"rgba(229,142,191,1)","line":{"color":"rgba(229,142,191,1)"}},"textfont":{"color":"rgba(229,142,191,1)"},"error_y":{"color":"rgba(229,142,191,1)"},"error_x":{"color":"rgba(229,142,191,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morges","Lausanne","Other"],"y":[0.0060000000000000001,0.0050000000000000001,0],"type":"bar","name":"Lebanon","marker":{"color":"rgba(226,148,184,1)","line":{"color":"rgba(226,148,184,1)"}},"textfont":{"color":"rgba(226,148,184,1)"},"error_y":{"color":"rgba(226,148,184,1)"},"error_x":{"color":"rgba(226,148,184,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Other"],"y":[0.001],"type":"bar","name":"Liechtenstein","marker":{"color":"rgba(223,155,177,1)","line":{"color":"rgba(223,155,177,1)"}},"textfont":{"color":"rgba(223,155,177,1)"},"error_y":{"color":"rgba(223,155,177,1)"},"error_x":{"color":"rgba(223,155,177,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Yverdon-les-Bains","Montreux","Lausanne","Other"],"y":[0.0080000000000000002,0.0070000000000000001,0.002,0.001],"type":"bar","name":"Lithuania","marker":{"color":"rgba(219,161,170,1)","line":{"color":"rgba(219,161,170,1)"}},"textfont":{"color":"rgba(219,161,170,1)"},"error_y":{"color":"rgba(219,161,170,1)"},"error_x":{"color":"rgba(219,161,170,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Villars-sur-Ollon","Les Diablerets","Château-d'Oex","Leysin","Lausanne","Other"],"y":[0.025000000000000001,0.017000000000000001,0.010999999999999999,0.0050000000000000001,0.0030000000000000001,0],"type":"bar","name":"Luxembourg","marker":{"color":"rgba(216,167,162,1)","line":{"color":"rgba(216,167,162,1)"}},"textfont":{"color":"rgba(216,167,162,1)"},"error_y":{"color":"rgba(216,167,162,1)"},"error_x":{"color":"rgba(216,167,162,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux"],"y":[0.0040000000000000001],"type":"bar","name":"Malawi","marker":{"color":"rgba(212,172,155,1)","line":{"color":"rgba(212,172,155,1)"}},"textfont":{"color":"rgba(212,172,155,1)"},"error_y":{"color":"rgba(212,172,155,1)"},"error_x":{"color":"rgba(212,172,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Villars-sur-Ollon","Lausanne","Other"],"y":[0.036999999999999998,0.012999999999999999,0.0060000000000000001,0.001],"type":"bar","name":"Malaysia","marker":{"color":"rgba(207,178,148,1)","line":{"color":"rgba(207,178,148,1)"}},"textfont":{"color":"rgba(207,178,148,1)"},"error_y":{"color":"rgba(207,178,148,1)"},"error_x":{"color":"rgba(207,178,148,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Maldives","marker":{"color":"rgba(203,183,140,1)","line":{"color":"rgba(203,183,140,1)"}},"textfont":{"color":"rgba(203,183,140,1)"},"error_y":{"color":"rgba(203,183,140,1)"},"error_x":{"color":"rgba(203,183,140,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morges","Montreux"],"y":[0.0060000000000000001,0.0040000000000000001],"type":"bar","name":"Malta","marker":{"color":"rgba(198,188,132,1)","line":{"color":"rgba(198,188,132,1)"}},"textfont":{"color":"rgba(198,188,132,1)"},"error_y":{"color":"rgba(198,188,132,1)"},"error_x":{"color":"rgba(198,188,132,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Other"],"y":[0.0030000000000000001,0],"type":"bar","name":"Mauritius","marker":{"color":"rgba(193,194,125,1)","line":{"color":"rgba(193,194,125,1)"}},"textfont":{"color":"rgba(193,194,125,1)"},"error_y":{"color":"rgba(193,194,125,1)"},"error_x":{"color":"rgba(193,194,125,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Nyon","Lausanne","Other"],"y":[0.014999999999999999,0.012999999999999999,0.0060000000000000001,0.001],"type":"bar","name":"Mexico","marker":{"color":"rgba(188,199,116,1)","line":{"color":"rgba(188,199,116,1)"}},"textfont":{"color":"rgba(188,199,116,1)"},"error_y":{"color":"rgba(188,199,116,1)"},"error_x":{"color":"rgba(188,199,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux"],"y":[0.0040000000000000001],"type":"bar","name":"Moldova","marker":{"color":"rgba(182,204,108,1)","line":{"color":"rgba(182,204,108,1)"}},"textfont":{"color":"rgba(182,204,108,1)"},"error_y":{"color":"rgba(182,204,108,1)"},"error_x":{"color":"rgba(182,204,108,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Rougemont","Morges"],"y":[0.014,0.0060000000000000001],"type":"bar","name":"Monaco","marker":{"color":"rgba(176,208,99,1)","line":{"color":"rgba(176,208,99,1)"}},"textfont":{"color":"rgba(176,208,99,1)"},"error_y":{"color":"rgba(176,208,99,1)"},"error_x":{"color":"rgba(176,208,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Other"],"y":[0.002,0],"type":"bar","name":"Mongolia","marker":{"color":"rgba(170,213,90,1)","line":{"color":"rgba(170,213,90,1)"}},"textfont":{"color":"rgba(170,213,90,1)"},"error_y":{"color":"rgba(170,213,90,1)"},"error_x":{"color":"rgba(170,213,90,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon"],"y":[0.0070000000000000001],"type":"bar","name":"Montenegro","marker":{"color":"rgba(169,216,83,1)","line":{"color":"rgba(169,216,83,1)"}},"textfont":{"color":"rgba(169,216,83,1)"},"error_y":{"color":"rgba(169,216,83,1)"},"error_x":{"color":"rgba(169,216,83,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Other"],"y":[0.0060000000000000001,0],"type":"bar","name":"Morocco","marker":{"color":"rgba(176,216,81,1)","line":{"color":"rgba(176,216,81,1)"}},"textfont":{"color":"rgba(176,216,81,1)"},"error_y":{"color":"rgba(176,216,81,1)"},"error_x":{"color":"rgba(176,216,81,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Nepal","marker":{"color":"rgba(183,217,79,1)","line":{"color":"rgba(183,217,79,1)"}},"textfont":{"color":"rgba(183,217,79,1)"},"error_y":{"color":"rgba(183,217,79,1)"},"error_x":{"color":"rgba(183,217,79,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Leysin","Château-d'Oex","Villars-sur-Ollon","Lausanne","Rougemont","Nyon","Les Diablerets","Montreux","Yverdon-les-Bains","Morges","Other"],"y":[0.053999999999999999,0.039,0.037999999999999999,0.029999999999999999,0.029000000000000001,0.025999999999999999,0.025000000000000001,0.021999999999999999,0.014999999999999999,0.010999999999999999,0.001],"type":"bar","name":"Netherlands","marker":{"color":"rgba(190,217,76,1)","line":{"color":"rgba(190,217,76,1)"}},"textfont":{"color":"rgba(190,217,76,1)"},"error_y":{"color":"rgba(190,217,76,1)"},"error_x":{"color":"rgba(190,217,76,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Other"],"y":[0],"type":"bar","name":"New Caledonia","marker":{"color":"rgba(196,217,74,1)","line":{"color":"rgba(196,217,74,1)"}},"textfont":{"color":"rgba(196,217,74,1)"},"error_y":{"color":"rgba(196,217,74,1)"},"error_x":{"color":"rgba(196,217,74,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Château-d'Oex"],"y":[0.0080000000000000002,0.0060000000000000001],"type":"bar","name":"New Zealand","marker":{"color":"rgba(202,217,72,1)","line":{"color":"rgba(202,217,72,1)"}},"textfont":{"color":"rgba(202,217,72,1)"},"error_y":{"color":"rgba(202,217,72,1)"},"error_x":{"color":"rgba(202,217,72,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Other"],"y":[0.002,0.001],"type":"bar","name":"North Macedonia","marker":{"color":"rgba(209,217,69,1)","line":{"color":"rgba(209,217,69,1)"}},"textfont":{"color":"rgba(209,217,69,1)"},"error_y":{"color":"rgba(209,217,69,1)"},"error_x":{"color":"rgba(209,217,69,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Château-d'Oex","Lausanne","Other"],"y":[0.0060000000000000001,0.002,0],"type":"bar","name":"Norway","marker":{"color":"rgba(215,217,67,1)","line":{"color":"rgba(215,217,67,1)"}},"textfont":{"color":"rgba(215,217,67,1)"},"error_y":{"color":"rgba(215,217,67,1)"},"error_x":{"color":"rgba(215,217,67,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Other"],"y":[0],"type":"bar","name":"Oman","marker":{"color":"rgba(221,217,64,1)","line":{"color":"rgba(221,217,64,1)"}},"textfont":{"color":"rgba(221,217,64,1)"},"error_y":{"color":"rgba(221,217,64,1)"},"error_x":{"color":"rgba(221,217,64,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Morges","Lausanne","Other"],"y":[0.010999999999999999,0.0060000000000000001,0.0030000000000000001,0],"type":"bar","name":"Other","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)"},"error_y":{"color":"rgba(227,217,62,1)"},"error_x":{"color":"rgba(227,217,62,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Pakistan","marker":{"color":"rgba(233,217,59,1)","line":{"color":"rgba(233,217,59,1)"}},"textfont":{"color":"rgba(233,217,59,1)"},"error_y":{"color":"rgba(233,217,59,1)"},"error_x":{"color":"rgba(233,217,59,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Palau","marker":{"color":"rgba(239,217,56,1)","line":{"color":"rgba(239,217,56,1)"}},"textfont":{"color":"rgba(239,217,56,1)"},"error_y":{"color":"rgba(239,217,56,1)"},"error_x":{"color":"rgba(239,217,56,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux"],"y":[0.0040000000000000001],"type":"bar","name":"Panama","marker":{"color":"rgba(245,217,53,1)","line":{"color":"rgba(245,217,53,1)"}},"textfont":{"color":"rgba(245,217,53,1)"},"error_y":{"color":"rgba(245,217,53,1)"},"error_x":{"color":"rgba(245,217,53,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Les Diablerets","Lausanne","Leysin"],"y":[0.0080000000000000002,0.0050000000000000001,0.0050000000000000001],"type":"bar","name":"Peru","marker":{"color":"rgba(251,217,49,1)","line":{"color":"rgba(251,217,49,1)"}},"textfont":{"color":"rgba(251,217,49,1)"},"error_y":{"color":"rgba(251,217,49,1)"},"error_x":{"color":"rgba(251,217,49,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Nyon","Lausanne","Château-d'Oex","Other"],"y":[0.0070000000000000001,0.0070000000000000001,0.0060000000000000001,0.0060000000000000001,0],"type":"bar","name":"Philippines","marker":{"color":"rgba(255,217,50,1)","line":{"color":"rgba(255,217,50,1)"}},"textfont":{"color":"rgba(255,217,50,1)"},"error_y":{"color":"rgba(255,217,50,1)"},"error_x":{"color":"rgba(255,217,50,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Nyon","Morges","Lausanne","Les Diablerets","Leysin","Other"],"y":[0.025999999999999999,0.02,0.017000000000000001,0.01,0.0080000000000000002,0.0050000000000000001,0.001],"type":"bar","name":"Poland","marker":{"color":"rgba(253,215,61,1)","line":{"color":"rgba(253,215,61,1)"}},"textfont":{"color":"rgba(253,215,61,1)"},"error_y":{"color":"rgba(253,215,61,1)"},"error_x":{"color":"rgba(253,215,61,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon","Lausanne","Montreux","Les Diablerets","Leysin","Château-d'Oex","Morges","Other"],"y":[0.02,0.019,0.019,0.017000000000000001,0.014999999999999999,0.010999999999999999,0.0060000000000000001,0.001],"type":"bar","name":"Portugal","marker":{"color":"rgba(252,214,70,1)","line":{"color":"rgba(252,214,70,1)"}},"textfont":{"color":"rgba(252,214,70,1)"},"error_y":{"color":"rgba(252,214,70,1)"},"error_x":{"color":"rgba(252,214,70,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Qatar","marker":{"color":"rgba(250,212,78,1)","line":{"color":"rgba(250,212,78,1)"}},"textfont":{"color":"rgba(250,212,78,1)"},"error_y":{"color":"rgba(250,212,78,1)"},"error_x":{"color":"rgba(250,212,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon","Les Diablerets","Montreux","Lausanne","Other"],"y":[0.012999999999999999,0.0080000000000000002,0.0040000000000000001,0.002,0],"type":"bar","name":"Romania","marker":{"color":"rgba(247,209,93,1)","line":{"color":"rgba(247,209,93,1)"}},"textfont":{"color":"rgba(247,209,93,1)"},"error_y":{"color":"rgba(247,209,93,1)"},"error_x":{"color":"rgba(247,209,93,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morges"],"y":[0.010999999999999999],"type":"bar","name":"Russia","marker":{"color":"rgba(245,207,100,1)","line":{"color":"rgba(245,207,100,1)"}},"textfont":{"color":"rgba(245,207,100,1)"},"error_y":{"color":"rgba(245,207,100,1)"},"error_x":{"color":"rgba(245,207,100,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Leysin"],"y":[0.014999999999999999],"type":"bar","name":"Rwanda","marker":{"color":"rgba(243,206,107,1)","line":{"color":"rgba(243,206,107,1)"}},"textfont":{"color":"rgba(243,206,107,1)"},"error_y":{"color":"rgba(243,206,107,1)"},"error_x":{"color":"rgba(243,206,107,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Réunion","marker":{"color":"rgba(248,210,86,1)","line":{"color":"rgba(248,210,86,1)"}},"textfont":{"color":"rgba(248,210,86,1)"},"error_y":{"color":"rgba(248,210,86,1)"},"error_x":{"color":"rgba(248,210,86,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morges","Montreux","Lausanne"],"y":[0.0060000000000000001,0.0040000000000000001,0.002],"type":"bar","name":"Saudi Arabia","marker":{"color":"rgba(241,205,113,1)","line":{"color":"rgba(241,205,113,1)"}},"textfont":{"color":"rgba(241,205,113,1)"},"error_y":{"color":"rgba(241,205,113,1)"},"error_x":{"color":"rgba(241,205,113,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Villars-sur-Ollon","Nyon","Other"],"y":[0.012999999999999999,0.0070000000000000001,0],"type":"bar","name":"Serbia","marker":{"color":"rgba(239,203,119,1)","line":{"color":"rgba(239,203,119,1)"}},"textfont":{"color":"rgba(239,203,119,1)"},"error_y":{"color":"rgba(239,203,119,1)"},"error_x":{"color":"rgba(239,203,119,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Lausanne","Les Diablerets","Other"],"y":[0.029999999999999999,0.019,0.017000000000000001,0.001],"type":"bar","name":"Singapore","marker":{"color":"rgba(237,202,125,1)","line":{"color":"rgba(237,202,125,1)"}},"textfont":{"color":"rgba(237,202,125,1)"},"error_y":{"color":"rgba(237,202,125,1)"},"error_x":{"color":"rgba(237,202,125,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morges","Montreux","Other"],"y":[0.0060000000000000001,0.0040000000000000001,0],"type":"bar","name":"Slovakia","marker":{"color":"rgba(235,200,131,1)","line":{"color":"rgba(235,200,131,1)"}},"textfont":{"color":"rgba(235,200,131,1)"},"error_y":{"color":"rgba(235,200,131,1)"},"error_x":{"color":"rgba(235,200,131,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Lausanne"],"y":[0.0040000000000000001,0.002],"type":"bar","name":"Slovenia","marker":{"color":"rgba(233,199,137,1)","line":{"color":"rgba(233,199,137,1)"}},"textfont":{"color":"rgba(233,199,137,1)"},"error_y":{"color":"rgba(233,199,137,1)"},"error_x":{"color":"rgba(233,199,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon","Lausanne"],"y":[0.0070000000000000001,0.0050000000000000001],"type":"bar","name":"South Africa","marker":{"color":"rgba(231,197,143,1)","line":{"color":"rgba(231,197,143,1)"}},"textfont":{"color":"rgba(231,197,143,1)"},"error_y":{"color":"rgba(231,197,143,1)"},"error_x":{"color":"rgba(231,197,143,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Nyon","Lausanne","Other"],"y":[0.014999999999999999,0.0070000000000000001,0.0060000000000000001,0],"type":"bar","name":"South Korea (ROK)","marker":{"color":"rgba(229,196,148,1)","line":{"color":"rgba(229,196,148,1)"}},"textfont":{"color":"rgba(229,196,148,1)"},"error_y":{"color":"rgba(229,196,148,1)"},"error_x":{"color":"rgba(229,196,148,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne","Nyon","Rougemont","Morges","Leysin","Château-d'Oex","Les Diablerets","Yverdon-les-Bains","Montreux","Other"],"y":[0.058999999999999997,0.045999999999999999,0.042999999999999997,0.021999999999999999,0.02,0.017000000000000001,0.017000000000000001,0.0080000000000000002,0.0070000000000000001,0.0040000000000000001],"type":"bar","name":"Spain","marker":{"color":"rgba(225,195,151,1)","line":{"color":"rgba(225,195,151,1)"}},"textfont":{"color":"rgba(225,195,151,1)"},"error_y":{"color":"rgba(225,195,151,1)"},"error_x":{"color":"rgba(225,195,151,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Villars-sur-Ollon","Les Diablerets","Montreux","Lausanne","Château-d'Oex","Leysin","Other"],"y":[0.012999999999999999,0.0080000000000000002,0.0070000000000000001,0.0060000000000000001,0.0060000000000000001,0.0050000000000000001,0.001],"type":"bar","name":"Sweden","marker":{"color":"rgba(222,193,153,1)","line":{"color":"rgba(222,193,153,1)"}},"textfont":{"color":"rgba(222,193,153,1)"},"error_y":{"color":"rgba(222,193,153,1)"},"error_x":{"color":"rgba(222,193,153,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Yverdon-les-Bains","Rougemont","Morges","Les Diablerets","Leysin","Château-d'Oex","Villars-sur-Ollon","Nyon","Montreux","Lausanne","Other"],"y":[0.81999999999999995,0.623,0.46400000000000002,0.438,0.42099999999999999,0.38700000000000001,0.32900000000000001,0.13100000000000001,0.10100000000000001,0.071999999999999995,0.066000000000000003],"type":"bar","name":"Switzerland","marker":{"color":"rgba(219,192,155,1)","line":{"color":"rgba(219,192,155,1)"}},"textfont":{"color":"rgba(219,192,155,1)"},"error_y":{"color":"rgba(219,192,155,1)"},"error_x":{"color":"rgba(219,192,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Nyon","Morges","Lausanne","Château-d'Oex","Leysin","Other"],"y":[0.021999999999999999,0.012999999999999999,0.010999999999999999,0.0080000000000000002,0.0060000000000000001,0.0050000000000000001,0.001],"type":"bar","name":"Taiwan","marker":{"color":"rgba(215,191,157,1)","line":{"color":"rgba(215,191,157,1)"}},"textfont":{"color":"rgba(215,191,157,1)"},"error_y":{"color":"rgba(215,191,157,1)"},"error_x":{"color":"rgba(215,191,157,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Nyon","Lausanne"],"y":[0.021999999999999999,0.012999999999999999,0.0050000000000000001],"type":"bar","name":"Thailand","marker":{"color":"rgba(212,190,160,1)","line":{"color":"rgba(212,190,160,1)"}},"textfont":{"color":"rgba(212,190,160,1)"},"error_y":{"color":"rgba(212,190,160,1)"},"error_x":{"color":"rgba(212,190,160,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.002],"type":"bar","name":"Tunisia","marker":{"color":"rgba(208,189,162,1)","line":{"color":"rgba(208,189,162,1)"}},"textfont":{"color":"rgba(208,189,162,1)"},"error_y":{"color":"rgba(208,189,162,1)"},"error_x":{"color":"rgba(208,189,162,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lausanne"],"y":[0.0060000000000000001],"type":"bar","name":"Turkey","marker":{"color":"rgba(205,187,164,1)","line":{"color":"rgba(205,187,164,1)"}},"textfont":{"color":"rgba(205,187,164,1)"},"error_y":{"color":"rgba(205,187,164,1)"},"error_x":{"color":"rgba(205,187,164,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Leysin","Lausanne"],"y":[0.0050000000000000001,0.002],"type":"bar","name":"U.A.E","marker":{"color":"rgba(201,186,166,1)","line":{"color":"rgba(201,186,166,1)"}},"textfont":{"color":"rgba(201,186,166,1)"},"error_y":{"color":"rgba(201,186,166,1)"},"error_x":{"color":"rgba(201,186,166,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Leysin","Montreux","Lausanne","Other"],"y":[0.0050000000000000001,0.0040000000000000001,0.002,0],"type":"bar","name":"Ukraine","marker":{"color":"rgba(198,185,168,1)","line":{"color":"rgba(198,185,168,1)"}},"textfont":{"color":"rgba(198,185,168,1)"},"error_y":{"color":"rgba(198,185,168,1)"},"error_x":{"color":"rgba(198,185,168,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Villars-sur-Ollon","Les Diablerets","Château-d'Oex","Nyon","Lausanne","Montreux","Rougemont","Leysin","Morges","Other"],"y":[0.20300000000000001,0.14000000000000001,0.13300000000000001,0.13100000000000001,0.074999999999999997,0.064000000000000001,0.058000000000000003,0.050000000000000003,0.033000000000000002,0.0080000000000000002],"type":"bar","name":"United Kingdom","marker":{"color":"rgba(194,184,170,1)","line":{"color":"rgba(194,184,170,1)"}},"textfont":{"color":"rgba(194,184,170,1)"},"error_y":{"color":"rgba(194,184,170,1)"},"error_x":{"color":"rgba(194,184,170,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montreux","Lausanne","Nyon","Les Diablerets","Morges","Villars-sur-Ollon","Château-d'Oex","Leysin","Rougemont","Yverdon-les-Bains","Other"],"y":[0.097000000000000003,0.080000000000000002,0.065000000000000002,0.058000000000000003,0.055,0.050999999999999997,0.028000000000000001,0.02,0.014,0.0080000000000000002,0.0040000000000000001],"type":"bar","name":"United States of America","marker":{"color":"rgba(190,183,173,1)","line":{"color":"rgba(190,183,173,1)"}},"textfont":{"color":"rgba(190,183,173,1)"},"error_y":{"color":"rgba(190,183,173,1)"},"error_x":{"color":"rgba(190,183,173,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon","Montreux","Other"],"y":[0.0070000000000000001,0.0040000000000000001,0],"type":"bar","name":"Uruguay","marker":{"color":"rgba(187,181,175,1)","line":{"color":"rgba(187,181,175,1)"}},"textfont":{"color":"rgba(187,181,175,1)"},"error_y":{"color":"rgba(187,181,175,1)"},"error_x":{"color":"rgba(187,181,175,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nyon"],"y":[0.0070000000000000001],"type":"bar","name":"Uzbekistan","marker":{"color":"rgba(183,180,177,1)","line":{"color":"rgba(183,180,177,1)"}},"textfont":{"color":"rgba(183,180,177,1)"},"error_y":{"color":"rgba(183,180,177,1)"},"error_x":{"color":"rgba(183,180,177,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morges"],"y":[0.0060000000000000001],"type":"bar","name":"Venezuela","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the stacked bar plot</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(final_data, aes(x = F105_Code, y = Ratio, fill = F05_02_ENG)) +</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_bar(stat = "identity") +</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Stacked Bar Plot of Ratios by City and Nationality",</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "City",</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "Ratio",</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#        fill = "Nationality") +</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle = 45, hjust = 1),</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#         legend.position = "none")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The percentage here was in fact a ratio representing the number of people from one particular nationality over the total number of visitors in each city. Unfortunately, as very few data has been collected in some cities, the ratio of visitor from one nationality over all the visitor surveyed can be really large (up to 1, in point of percentage). On the other hand, as data from some other city gathered a lot of answers, we observe that some country of origin (e.g.&nbsp;Austria in Lausanne) were only accounting for 0.2% of the total visitors.</p>
<p><strong>Ratio of each country of origin relatively to the number of tourist surveyed in each district</strong></p>
<p>In the same process, let’s now explore the country of origin ratio per district of tourism.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ratio of each nationality relatively to the number of tourist surveyed in each district F105_OrgCode</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tourists_by_nationality <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(leaflet_districts, F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the total number of tourists per city</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>total_tourists_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(leaflet_districts) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalCount =</span> <span class="fu">sum</span>(Count), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining the counts back to the detailed breakdown and calculating the ratio</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>nationality_ratio_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(total_tourists_per_city, <span class="at">by =</span> <span class="st">"leaflet_districts"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> <span class="fu">round</span>((Count <span class="sc">/</span> TotalCount),<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(leaflet_districts, F05_02_ENG, Ratio) <span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">District_tourism =</span> leaflet_districts,<span class="at">Country_of_origin =</span> F05_02_ENG)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(nationality_ratio_per_city, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-7383466b8eee2ac7da5e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7383466b8eee2ac7da5e">{"x":{"filter":"none","vertical":false,"data":[["Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Broye-Vully","Broye-Vully","Broye-Vully","Broye-Vully","Broye-Vully","Broye-Vully","Broye-Vully","Broye-Vully","Broye-Vully","Broye-Vully","Gros-de-Vaud","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Jura-Nord vaudois","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lavaux-Oron","Lavaux-Oron","Lavaux-Oron","Lavaux-Oron","Lavaux-Oron","Lavaux-Oron","Lavaux-Oron","Lavaux-Oron","Lavaux-Oron","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Ouest lausannois","Ouest lausannois","Ouest lausannois","Ouest lausannois","Ouest lausannois","Ouest lausannois","Ouest lausannois","Ouest lausannois","Ouest lausannois","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut","Riviera-Pays-d'Enhaut"],["Australia","Belgium","Brazil","Canada","China","Colombia","Croatia","Cyprus","Czechia","Denmark","Finland","France","Germany","Greece","India","Ireland","Italy","Jersey","Luxembourg","Malaysia","Netherlands","North Macedonia","Peru","Poland","Portugal","Romania","Rwanda","Serbia","Singapore","Slovakia","Spain","Sweden","Switzerland","Taiwan","U.A.E","Ukraine","United Kingdom","United States of America","Uruguay","Canada","France","Greece","India","Iran","Mauritius","Singapore","Spain","Switzerland","United States of America","North Macedonia","Argentina","Austria","Belgium","Bosnia and Herzegovina","Canada","Colombia","Czechia","France","Germany","Liechtenstein","Lithuania","Netherlands","Spain","Sweden","Switzerland","Taiwan","Ukraine","United Kingdom","United States of America","Argentina","Australia","Austria","Belgium","Bolivia","Brazil","Bulgaria","Canada","Chile","China","Colombia","Czechia","Denmark","Ecuador","Egypt","France","Germany","Greece","Hong Kong (CN)","Hungary","India","Indonesia","Iran","Ireland","Israel","Italy","Ivory Coast","Japan","Kenya","Kyrgyzstan","Lebanon","Lithuania","Luxembourg","Malaysia","Maldives","Mauritius","Mexico","Mongolia","Morocco","Nepal","Netherlands","New Zealand","North Macedonia","Norway","Other","Pakistan","Palau","Peru","Philippines","Poland","Portugal","Qatar","Romania","Réunion","Saudi Arabia","Singapore","Slovenia","South Africa","South Korea (ROK)","Spain","Sweden","Switzerland","Taiwan","Thailand","Tunisia","Turkey","U.A.E","Ukraine","United Kingdom","United States of America","Canada","France","Germany","Italy","Spain","Sweden","Switzerland","United Kingdom","United States of America","Albania","Argentina","Australia","Austria","Belgium","Canada","China","Croatia","Czechia","France","Germany","Hong Kong (CN)","Hungary","Ireland","Italy","Kuwait","Lebanon","Malta","Monaco","Netherlands","Oman","Other","Poland","Portugal","Russia","Saudi Arabia","Slovakia","Spain","Switzerland","Taiwan","United Kingdom","United States of America","Venezuela","Argentina","Armenia","Australia","Austria","Belgium","Brazil","Canada","Chile","China","Costa Rica","Czechia","Denmark","Finland","France","Germany","Greece","India","Italy","Kenya","Kosovo","Latvia","Liechtenstein","Mexico","Montenegro","Netherlands","Philippines","Poland","Portugal","Romania","Serbia","South Africa","South Korea (ROK)","Spain","Switzerland","Taiwan","Thailand","United Kingdom","United States of America","Uruguay","Uzbekistan","Brazil","France","Italy","Malaysia","Mexico","Portugal","Spain","Switzerland","United States of America","Andorra","Argentina","Australia","Austria","Belgium","Brazil","Bulgaria","Cambodia","Canada","Cayman Islands","Chile","China","Colombia","Czechia","Finland","France","Germany","Hong Kong (CN)","India","Indonesia","Ireland","Israel","Italy","Latvia","Lebanon","Lithuania","Luxembourg","Malawi","Malaysia","Malta","Mexico","Moldova","Monaco","Mongolia","Morocco","Netherlands","New Caledonia","New Zealand","Norway","Other","Panama","Philippines","Poland","Portugal","Romania","Saudi Arabia","Singapore","Slovakia","Slovenia","South Korea (ROK)","Spain","Sweden","Switzerland","Taiwan","Thailand","Ukraine","United Kingdom","United States of America","Uruguay"],[0.013,0.106,0.008,0.004,0.011,0.002,0.002,0.002,0.006,0.002,0.002,0.113,0.03,0.002,0.002,0.002,0.011,0.002,0.013,0.004,0.036,0.002,0.004,0.004,0.013,0.002,0.006,0.004,0.004,0.002,0.015,0.011,0.412,0.002,0.002,0.002,0.102,0.036,0.002,0.067,0.167,0.033,0.033,0.033,0.033,0.033,0.1,0.467,0.033,1,0.003,0.003,0.006,0.003,0.006,0.006,0.006,0.099,0.05,0.003,0.003,0.012,0.008999999999999999,0.003,0.755,0.003,0.003,0.019,0.006,0.003,0.013,0.002,0.024,0.002,0.032,0.002,0.04,0.006,0.026,0.003,0.006,0.003,0.002,0.002,0.199,0.073,0.013,0.003,0.003,0.013,0.002,0.003,0.003,0.002,0.035,0.002,0.002,0.003,0.002,0.005,0.002,0.003,0.006,0.002,0.003,0.006,0.002,0.006,0.002,0.03,0.008,0.002,0.002,0.003,0.002,0.002,0.005,0.006,0.01,0.019,0.002,0.002,0.002,0.002,0.019,0.002,0.005,0.006,0.059,0.006,0.07199999999999999,0.008,0.005,0.002,0.006,0.002,0.002,0.075,0.08,0.03,0.152,0.091,0.061,0.061,0.03,0.455,0.091,0.03,0.005,0.011,0.005,0.011,0.016,0.016,0.016,0.005,0.016,0.111,0.08500000000000001,0.005,0.011,0.005,0.016,0.005,0.005,0.005,0.005,0.011,0.005,0.005,0.016,0.005,0.011,0.005,0.005,0.026,0.45,0.011,0.037,0.053,0.005,0.006,0.006,0.045,0.017,0.028,0.006,0.017,0.011,0.011,0.006,0.006,0.006,0.006,0.192,0.04,0.011,0.028,0.011,0.006,0.006,0.006,0.006,0.011,0.006,0.028,0.006,0.023,0.017,0.011,0.006,0.006,0.006,0.045,0.119,0.011,0.011,0.13,0.079,0.006,0.006,0.077,0.231,0.077,0.077,0.077,0.077,0.077,0.231,0.077,0.002,0.002,0.019,0.002,0.022,0.016,0.005,0.002,0.019,0.002,0.002,0.022,0.005,0.011,0.002,0.128,0.058,0.008,0.024,0.003,0.005,0.005,0.014,0.003,0.002,0.006,0.003,0.002,0.019,0.002,0.008,0.002,0.002,0.002,0.002,0.026,0.002,0.002,0.003,0.006,0.002,0.006,0.016,0.016,0.003,0.002,0.016,0.002,0.002,0.008,0.018,0.006,0.266,0.013,0.01,0.002,0.08500000000000001,0.059,0.002]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>District_tourism<\/th>\n      <th>Country_of_origin<\/th>\n      <th>Ratio<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":2},{"name":"District_tourism","targets":0},{"name":"Country_of_origin","targets":1},{"name":"Ratio","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Again, the low number of data available in our data don’t allow us to get really satisfying results for every city surveyed.</p>
<section id="domestic-tourism" class="level3">
<h3 class="anchored" data-anchor-id="domestic-tourism">Domestic tourism</h3>
<p>As Swiss citizens accounted for more than 30% of the visitors surveyed, we have decided to know more about the percentages of people coming from Switzerland, visiting Switzerland. Therefore, here is the distribution of visitors per canton of origin.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Séparation cantons suisse-allemands</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># Swiss german column</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># unique(data[data$F05_02 == "Schweiz", ]$F05_03)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a> <span class="co"># Seratation german cantons (subjective)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a> swiss_german_cantons <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Luzern"</span>, <span class="st">"Schwyz"</span>, <span class="st">"Bern"</span>, <span class="st">"Neuenburg"</span>, <span class="st">"Aargau"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Zürich"</span>, <span class="st">"Basel-Stadt"</span>, <span class="st">"Basel-Landschaft"</span>, <span class="st">"Obwalden"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Appenzell Innerrhoden"</span>, <span class="st">"Schaffhausen"</span>, <span class="st">"Thurgau"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"St. Gallen"</span>, <span class="st">"Solothurn"</span>, <span class="st">"Uri"</span>, <span class="st">"Zug"</span>, <span class="st">"Nidwalden"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Appenzell Ausserrhoden"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a> <span class="co"># Binary column for swiss germans</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a> data<span class="sc">$</span>swiss_german <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>F05_02 <span class="sc">==</span> <span class="st">"Schweiz"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>F05_03 <span class="sc">%in%</span> swiss_german_cantons, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a> <span class="co"># count ratio from each german canton over the data</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a> Inside_Switzerland <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(F05_02_ENG, F05_03, swiss_german) <span class="sc">%&gt;%</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(F05_02_ENG <span class="sc">==</span> <span class="st">"Switzerland"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_03) <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> Count<span class="sc">/</span><span class="fu">sum</span>(Count)) <span class="sc">%&gt;%</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Canton =</span> F05_03)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging the population data with the original data</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>population_data <span class="ot">&lt;-</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Canton =</span> <span class="fu">c</span>(<span class="st">"Aargau"</span>, <span class="st">"Appenzell Ausserrhoden"</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Appenzell Innerrhoden"</span>, <span class="st">"Basel-Landschaft"</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Basel-Stadt"</span>, <span class="st">"Bern"</span>, <span class="st">"Freiburg"</span>, <span class="st">"Genf"</span>, <span class="st">"Graubünden"</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Jura"</span>, <span class="st">"Luzern"</span>, <span class="st">"Neuenburg"</span>, <span class="st">"Nidwalden"</span>, <span class="st">"Obwalden"</span>,</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Schaffhausen"</span>, <span class="st">"Schwyz"</span>, <span class="st">"Solothurn"</span>, <span class="st">"St. Gallen"</span>,</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Tessin"</span>, <span class="st">"Thurgau"</span>, <span class="st">"Uri"</span>, <span class="st">"Waadt"</span>, <span class="st">"Wallis"</span>, <span class="st">"Zug"</span>,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Zürich"</span>),</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">Population =</span> <span class="fu">c</span>(<span class="st">"704000"</span>, <span class="st">"56200"</span>, <span class="st">"16200"</span>, <span class="st">"292000"</span>, <span class="st">"204000"</span>,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"1045000"</span>, <span class="st">"338000"</span>, <span class="st">"499000"</span>, <span class="st">"200000"</span>, <span class="st">"74400"</span>,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"433000"</span>, <span class="st">"176000"</span>, <span class="st">"44300"</span>, <span class="st">"38600"</span>, <span class="st">"84000"</span>,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"166000"</span>, <span class="st">"278000"</span>, <span class="st">"515000"</span>, <span class="st">"353000"</span>, <span class="st">"282000"</span>,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"37000"</span>, <span class="st">"817000"</span>, <span class="st">"350000"</span>, <span class="st">"130000"</span>, <span class="st">"1605000"</span>))</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co"># replacing "Appenzell Innerrhoden " by "Appenzell Innerrhoden"</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>Inside_Switzerland<span class="sc">$</span>Canton[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"Appenzell Innerrhoden"</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the population data with your original data</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>data_merged <span class="ot">&lt;-</span> <span class="fu">merge</span>(Inside_Switzerland, population_data,</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by.x =</span> <span class="st">"Canton"</span>,</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by.y =</span> <span class="st">"Canton"</span>,</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>                   <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>data_merged<span class="sc">$</span>Population <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data_merged<span class="sc">$</span>Population)</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the ratio of occurrences per population for each canton</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>Inside_Switzerland_ratio <span class="ot">&lt;-</span> data_merged <span class="sc">%&gt;%</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> Count<span class="sc">/</span><span class="fu">sum</span>(Count)) <span class="sc">%&gt;%</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> Count <span class="sc">/</span> Population) <span class="sc">%&gt;%</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Scaled_Ratio =</span> Ratio <span class="sc">/</span> <span class="fu">sum</span>(Ratio)) <span class="sc">%&gt;%</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Canton, Count, Percentage, Population, Ratio, Scaled_Ratio)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a><span class="co"># # Now output the table with your custom settings</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="co"># datatable(Inside_Switzerland_ratio,</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a><span class="co">#           options = list(pageLength = 10,</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a><span class="co">#                          class = "hover",</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a><span class="co">#                          searchHighlight = TRUE,</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   columnDefs = list(list(targets = 4, visible = FALSE))),rownames = FALSE) %&gt;%</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a><span class="co">#   formatPercentage('Percentage', 2) %&gt;%</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a><span class="co">#   formatPercentage('Ratio', 5) %&gt;%</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a><span class="co">#   formatPercentage('Scaled_Ratio', 2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot scaled_ratio per canton</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Inside_Switzerland_ratio,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Canton, Scaled_Ratio),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span>Scaled_Ratio)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Distribution among swiss visitors (scaled ratio)"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Cantons"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Percentage"</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, <span class="dv">100</span> <span class="sc">*</span> Scaled_Ratio)),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="sc">-</span><span class="fl">0.5</span>),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust=</span><span class="fl">0.3</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `position_dodge()` requires non-overlapping x intervals.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>As we can see on this table, the biggest part of the Swiss visitors surveyed in this study are people from Vaud (approx. 20%), Bern (approx. 16%) and Zurich (approx. 12%).</p>
<p>Now among the swiss german cantons, let’s explore the distribution of the canton</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now how much percentage do swiss germans represent in this</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Swiss_germans_percentage <span class="ot">&lt;-</span> Inside_Switzerland <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Canton <span class="sc">%in%</span> swiss_german_cantons) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">paste0</span>(<span class="fu">round</span>((Count<span class="sc">/</span><span class="fu">sum</span>(Count)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(Swiss_germans_percentage$Percentage)</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(Swiss_germans_percentage,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-edc5c2102c3ff8de5f4b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-edc5c2102c3ff8de5f4b">{"x":{"filter":"none","vertical":false,"data":[["Aargau","Appenzell Ausserrhoden","Appenzell Innerrhoden","Basel-Landschaft","Basel-Stadt","Bern","Luzern","Neuenburg","Nidwalden","Obwalden","Schaffhausen","Schwyz","Solothurn","St. Gallen","Thurgau","Uri","Zug","Zürich"],[51,1,2,22,17,127,47,21,3,5,5,10,14,23,21,6,16,94],["10.5%","0.2%","0.4%","4.5%","3.5%","26.2%","9.7%","4.3%","0.6%","1%","1%","2.1%","2.9%","4.7%","4.3%","1.2%","3.3%","19.4%"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Canton<\/th>\n      <th>Count<\/th>\n      <th>Percentage<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":1},{"name":"Canton","targets":0},{"name":"Count","targets":1},{"name":"Percentage","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Bern, Zurich and Aargau are the top 3 cantons represented among all swiss german cantons (with in approx. 26.5%, 19.5% and 10.5% in the order)</p>
<p>Now, for interpretability and visualisation, let’s see the proportion of swiss german people over the rest of the swiss citizens surveyed:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assuming 'Inside_Switzerland' has a column 'Canton' and you have a vector 'swiss_german_cantons' listing Swiss German cantons</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Inside_Switzerland <span class="ot">&lt;-</span> Inside_Switzerland <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_swiss_german =</span> Canton <span class="sc">%in%</span> swiss_german_cantons)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total counts</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>total_counts <span class="ot">&lt;-</span> Inside_Switzerland <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">n</span>())</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts for Swiss German cantons and others</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> Inside_Switzerland <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(is_swiss_german) <span class="sc">%&gt;%</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentages</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> total_counts<span class="sc">$</span>total <span class="sc">*</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(counts,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> is_swiss_german,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> percentage,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> is_swiss_german)) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Others"</span>, <span class="st">"Swiss germans"</span>)) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, percentage)),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">position=</span><span class="fu">position_stack</span>(<span class="at">vjust=</span><span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percentage of Swiss German Cantons vs Other Cantons"</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Canton Type"</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage"</span>) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Over all the swiss citizen, we can see that 68% of them are coming from the swiss german part.</p>
</section>
</section>
<section id="partie-lodrik" class="level2">
<h2 class="anchored" data-anchor-id="partie-lodrik">Partie Lodrik</h2>
<blockquote class="blockquote">
<p>Where did they stay? (For example: yes, they went to Montreux, but what type of accommodation, what price?</p>
</blockquote>
<section id="most-popular-destinations-in-the-canton-vaud" class="level3">
<h3 class="anchored" data-anchor-id="most-popular-destinations-in-the-canton-vaud">Most popular destinations in the canton Vaud</h3>
<p>Let’s now dive into the subject of the location of their stay. First, let’s have a look at the most popular locations in the canton Vaud. Given the architecture of the study this gives us the city where most people answer the survey.</p>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-afd746f26141c6347607" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-afd746f26141c6347607">{"x":{"visdat":{"beea4a269a0c":["function () ","plotlyVisDat"]},"cur_data":"beea4a269a0c","attrs":{"beea4a269a0c":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (City)","xaxis":{"domain":[0,1],"automargin":true,"title":"City","showgrid":false,"zeroline":false,"tickangle":45,"type":"category","categoryorder":"array","categoryarray":["Lausanne","Other Cities","Montreux","Leysin","Château-d'Oex","Morges","Nyon","Yverdon-les-Bains","Les Diablerets","Villars-sur-Ollon","Rougemont","Vevey"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false,"tickformat":",.0%"},"hovermode":"x","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Château-d'Oex","Lausanne","Les Diablerets","Leysin","Montreux","Morges","Nyon","Rougemont","Vevey","Villars-sur-Ollon","Yverdon-les-Bains","Other Cities"],"y":[0.072807723250201128,0.25221238938053098,0.048672566371681415,0.081255028157683026,0.10740144810941271,0.072807723250201128,0.06154465004022526,0.027755430410297668,0.026548672566371681,0.031777956556717619,0.053499597747385358,0.1637168141592921],"text":["","","","","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text"],"hovertext":["City name:  Château-d'Oex <br>Number of people visiting this city:  181 / 2486 <br>Proportion of people visiting this city:  7.28%","City name:  Lausanne <br>Number of people visiting this city:  627 / 2486 <br>Proportion of people visiting this city:  25.22%","City name:  Les Diablerets <br>Number of people visiting this city:  121 / 2486 <br>Proportion of people visiting this city:  4.87%","City name:  Leysin <br>Number of people visiting this city:  202 / 2486 <br>Proportion of people visiting this city:  8.13%","City name:  Montreux <br>Number of people visiting this city:  267 / 2486 <br>Proportion of people visiting this city:  10.74%","City name:  Morges <br>Number of people visiting this city:  181 / 2486 <br>Proportion of people visiting this city:  7.28%","City name:  Nyon <br>Number of people visiting this city:  153 / 2486 <br>Proportion of people visiting this city:  6.15%","City name:  Rougemont <br>Number of people visiting this city:  69 / 2486 <br>Proportion of people visiting this city:  2.78%","City name:  Vevey <br>Number of people visiting this city:  66 / 2486 <br>Proportion of people visiting this city:  2.65%","City name:  Villars-sur-Ollon <br>Number of people visiting this city:  79 / 2486 <br>Proportion of people visiting this city:  3.18%","City name:  Yverdon-les-Bains <br>Number of people visiting this city:  133 / 2486 <br>Proportion of people visiting this city:  5.35%","City name: Other Cities <br>Number of people visiting these cities:  407 / 2486 <br>Proportion of people visiting these cities:  16.37%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>From this plot, we can see that the most pupular city in the canton of Vaud is Lausanne. Let’s now have a look at the type of accommodation where the visitor stayed in the canton of Vaud. We took the liberty to remove the 46 observation where the type of accommodation was not specified. We can now concentrate more our attention on the district where the people stayed.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Total</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Switzerland</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">France</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">UK</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false" href="">Germany</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false" href="">USA</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false" href="">Belgium</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false" href="">Spain</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-027b0dd3adbead9f85ce" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-027b0dd3adbead9f85ce">{"x":{"visdat":{"beea1d06ab3c":["function () ","plotlyVisDat"]},"cur_data":"beea1d06ab3c","attrs":{"beea1d06ab3c":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (District)","xaxis":{"domain":[0,1],"automargin":true,"title":"District","showgrid":false,"zeroline":false,"type":"category","categoryorder":"array","categoryarray":["Lausanne","Other Cities","Montreux","Leysin","Château-d'Oex","Morges","Nyon","Yverdon-les-Bains","Les Diablerets","Villars-sur-Ollon","Rougemont","Vevey"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false,"tickformat":",.0%"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Château-d'Oex","Lausanne","Les Diablerets","Leysin","Montreux","Morges","Nyon","Rougemont","Vevey","Villars-sur-Ollon","Yverdon-les-Bains","Other Cities"],"y":[0.072807723250201128,0.25221238938053098,0.048672566371681415,0.081255028157683026,0.10740144810941271,0.072807723250201128,0.06154465004022526,0.027755430410297668,0.026548672566371681,0.031777956556717619,0.053499597747385358,0.16371681415929204],"text":["","","","","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text"],"hovertext":["District name:  Château-d'Oex <br>Number of people visiting this district:  181 / 2486 <br>Proportion of people visiting this district:  7.28%","District name:  Lausanne <br>Number of people visiting this district:  627 / 2486 <br>Proportion of people visiting this district:  25.22%","District name:  Les Diablerets <br>Number of people visiting this district:  121 / 2486 <br>Proportion of people visiting this district:  4.87%","District name:  Leysin <br>Number of people visiting this district:  202 / 2486 <br>Proportion of people visiting this district:  8.13%","District name:  Montreux <br>Number of people visiting this district:  267 / 2486 <br>Proportion of people visiting this district:  10.74%","District name:  Morges <br>Number of people visiting this district:  181 / 2486 <br>Proportion of people visiting this district:  7.28%","District name:  Nyon <br>Number of people visiting this district:  153 / 2486 <br>Proportion of people visiting this district:  6.15%","District name:  Rougemont <br>Number of people visiting this district:  69 / 2486 <br>Proportion of people visiting this district:  2.78%","District name:  Vevey <br>Number of people visiting this district:  66 / 2486 <br>Proportion of people visiting this district:  2.65%","District name:  Villars-sur-Ollon <br>Number of people visiting this district:  79 / 2486 <br>Proportion of people visiting this district:  3.18%","District name:  Yverdon-les-Bains <br>Number of people visiting this district:  133 / 2486 <br>Proportion of people visiting this district:  5.35%","District name:  Other Cities <br>Number of people visiting this district:  407 / 2486 <br>Proportion of people visiting this district:  16.37%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7b8f2fe995eed111ccee" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7b8f2fe995eed111ccee">{"x":{"visdat":{"beea3e0c3567":["function () ","plotlyVisDat"]},"cur_data":"beea3e0c3567","attrs":{"beea3e0c3567":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (District)","xaxis":{"domain":[0,1],"automargin":true,"title":"District","showgrid":false,"zeroline":false,"type":"category","categoryorder":"array","categoryarray":["Jura-Nord vaudois","Aigle","Riviera-Pays-d'Enhaut","Morges","Lausanne","Nyon","Lavaux-Oron","Broye-Vully","Ouest lausannois"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false,"tickformat":",.0%"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Aigle","Broye-Vully","Jura-Nord vaudois","Lausanne","Lavaux-Oron","Morges","Nyon","Ouest lausannois","Riviera-Pays-d'Enhaut"],"y":[0.24681933842239187,0.017811704834605598,0.30916030534351147,0.057251908396946563,0.019083969465648856,0.10814249363867684,0.026717557251908396,0.0038167938931297708,0.21119592875318066],"text":["","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text"],"hovertext":["District name:  Aigle <br>Number of people visiting this district:  194 / 786 <br>Proportion of people visiting this district:  24.68%","District name:  Broye-Vully <br>Number of people visiting this district:  14 / 786 <br>Proportion of people visiting this district:  1.78%","District name:  Jura-Nord vaudois <br>Number of people visiting this district:  243 / 786 <br>Proportion of people visiting this district:  30.92%","District name:  Lausanne <br>Number of people visiting this district:  45 / 786 <br>Proportion of people visiting this district:  5.73%","District name:  Lavaux-Oron <br>Number of people visiting this district:  15 / 786 <br>Proportion of people visiting this district:  1.91%","District name:  Morges <br>Number of people visiting this district:  85 / 786 <br>Proportion of people visiting this district:  10.81%","District name:  Nyon <br>Number of people visiting this district:  21 / 786 <br>Proportion of people visiting this district:  2.67%","District name:  Ouest lausannois <br>Number of people visiting this district:  3 / 786 <br>Proportion of people visiting this district:  0.38%","District name:  Riviera-Pays-d'Enhaut <br>Number of people visiting this district:  166 / 786 <br>Proportion of people visiting this district:  21.12%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ff385daaabef83579e89" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ff385daaabef83579e89">{"x":{"visdat":{"beea49dafb9f":["function () ","plotlyVisDat"]},"cur_data":"beea49dafb9f","attrs":{"beea49dafb9f":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (District)","xaxis":{"domain":[0,1],"automargin":true,"title":"District","showgrid":false,"zeroline":false,"type":"category","categoryorder":"array","categoryarray":["Lausanne","Riviera-Pays-d'Enhaut","Aigle","Nyon","Jura-Nord vaudois","Morges","Broye-Vully","Lavaux-Oron","Ouest lausannois"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false,"tickformat":",.0%"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Aigle","Broye-Vully","Jura-Nord vaudois","Lausanne","Lavaux-Oron","Morges","Nyon","Ouest lausannois","Riviera-Pays-d'Enhaut"],"y":[0.14804469273743018,0.013966480446927373,0.089385474860335198,0.34916201117318435,0.013966480446927373,0.058659217877094973,0.094972067039106142,0.0083798882681564244,0.22346368715083798],"text":["","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text"],"hovertext":["District name:  Aigle <br>Number of people visiting this district:  53 / 358 <br>Proportion of people visiting this district:  14.80%","District name:  Broye-Vully <br>Number of people visiting this district:  5 / 358 <br>Proportion of people visiting this district:  1.40%","District name:  Jura-Nord vaudois <br>Number of people visiting this district:  32 / 358 <br>Proportion of people visiting this district:  8.94%","District name:  Lausanne <br>Number of people visiting this district:  125 / 358 <br>Proportion of people visiting this district:  34.92%","District name:  Lavaux-Oron <br>Number of people visiting this district:  5 / 358 <br>Proportion of people visiting this district:  1.40%","District name:  Morges <br>Number of people visiting this district:  21 / 358 <br>Proportion of people visiting this district:  5.87%","District name:  Nyon <br>Number of people visiting this district:  34 / 358 <br>Proportion of people visiting this district:  9.50%","District name:  Ouest lausannois <br>Number of people visiting this district:  3 / 358 <br>Proportion of people visiting this district:  0.84%","District name:  Riviera-Pays-d'Enhaut <br>Number of people visiting this district:  80 / 358 <br>Proportion of people visiting this district:  22.35%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-706c60d878bea52534bc" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-706c60d878bea52534bc">{"x":{"visdat":{"beea74c9e241":["function () ","plotlyVisDat"]},"cur_data":"beea74c9e241","attrs":{"beea74c9e241":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (District)","xaxis":{"domain":[0,1],"automargin":true,"title":"District","showgrid":false,"zeroline":false,"type":"category","categoryorder":"array","categoryarray":["Riviera-Pays-d'Enhaut","Aigle","Lausanne","Nyon","Morges","Jura-Nord vaudois","Lavaux-Oron"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false,"tickformat":",.0%"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Aigle","Jura-Nord vaudois","Lausanne","Lavaux-Oron","Morges","Nyon","Riviera-Pays-d'Enhaut"],"y":[0.25668449197860965,0.032085561497326207,0.25133689839572193,0.016042780748663103,0.037433155080213901,0.12299465240641712,0.28342245989304815],"text":["","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text"],"hovertext":["District name:  Aigle <br>Number of people visiting this district:  48 / 187 <br>Proportion of people visiting this district:  25.67%","District name:  Jura-Nord vaudois <br>Number of people visiting this district:  6 / 187 <br>Proportion of people visiting this district:  3.21%","District name:  Lausanne <br>Number of people visiting this district:  47 / 187 <br>Proportion of people visiting this district:  25.13%","District name:  Lavaux-Oron <br>Number of people visiting this district:  3 / 187 <br>Proportion of people visiting this district:  1.60%","District name:  Morges <br>Number of people visiting this district:  7 / 187 <br>Proportion of people visiting this district:  3.74%","District name:  Nyon <br>Number of people visiting this district:  23 / 187 <br>Proportion of people visiting this district:  12.30%","District name:  Riviera-Pays-d'Enhaut <br>Number of people visiting this district:  53 / 187 <br>Proportion of people visiting this district:  28.34%"],"textposition":["auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7f5a2de4a04271a5ca03" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7f5a2de4a04271a5ca03">{"x":{"visdat":{"beea71036cc6":["function () ","plotlyVisDat"]},"cur_data":"beea71036cc6","attrs":{"beea71036cc6":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (District)","xaxis":{"domain":[0,1],"automargin":true,"title":"District","showgrid":false,"zeroline":false,"type":"category","categoryorder":"array","categoryarray":["Lausanne","Riviera-Pays-d'Enhaut","Jura-Nord vaudois","Morges","Aigle","Nyon","Lavaux-Oron"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false,"tickformat":",.0%"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Aigle","Jura-Nord vaudois","Lausanne","Lavaux-Oron","Morges","Nyon","Riviera-Pays-d'Enhaut"],"y":[0.10144927536231885,0.11594202898550725,0.33333333333333331,0.021739130434782608,0.11594202898550725,0.050724637681159424,0.2608695652173913],"text":["","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text"],"hovertext":["District name:  Aigle <br>Number of people visiting this district:  14 / 138 <br>Proportion of people visiting this district:  10.1%","District name:  Jura-Nord vaudois <br>Number of people visiting this district:  16 / 138 <br>Proportion of people visiting this district:  11.6%","District name:  Lausanne <br>Number of people visiting this district:  46 / 138 <br>Proportion of people visiting this district:  33.3%","District name:  Lavaux-Oron <br>Number of people visiting this district:  3 / 138 <br>Proportion of people visiting this district:  2.2%","District name:  Morges <br>Number of people visiting this district:  16 / 138 <br>Proportion of people visiting this district:  11.6%","District name:  Nyon <br>Number of people visiting this district:  7 / 138 <br>Proportion of people visiting this district:  5.1%","District name:  Riviera-Pays-d'Enhaut <br>Number of people visiting this district:  36 / 138 <br>Proportion of people visiting this district:  26.1%"],"textposition":["auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-fe2c59d7e4376b46d34e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-fe2c59d7e4376b46d34e">{"x":{"visdat":{"beea73fd5c3":["function () ","plotlyVisDat"]},"cur_data":"beea73fd5c3","attrs":{"beea73fd5c3":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (District)","xaxis":{"domain":[0,1],"automargin":true,"title":"District","showgrid":false,"zeroline":false,"type":"category","categoryorder":"array","categoryarray":["Lausanne","Riviera-Pays-d'Enhaut","Aigle","Nyon","Morges","Jura-Nord vaudois","Broye-Vully","Lavaux-Oron","Ouest lausannois"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false,"tickformat":",.0%"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Aigle","Broye-Vully","Jura-Nord vaudois","Lausanne","Lavaux-Oron","Morges","Nyon","Ouest lausannois","Riviera-Pays-d'Enhaut"],"y":[0.12781954887218044,0.0075187969924812026,0.015037593984962405,0.37593984962406013,0.0075187969924812026,0.075187969924812026,0.10526315789473684,0.0075187969924812026,0.2781954887218045],"text":["","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text"],"hovertext":["District name:  Aigle <br>Number of people visiting this district:  17 / 133 <br>Proportion of people visiting this district:  12.78%","District name:  Broye-Vully <br>Number of people visiting this district:  1 / 133 <br>Proportion of people visiting this district:  0.75%","District name:  Jura-Nord vaudois <br>Number of people visiting this district:  2 / 133 <br>Proportion of people visiting this district:  1.50%","District name:  Lausanne <br>Number of people visiting this district:  50 / 133 <br>Proportion of people visiting this district:  37.59%","District name:  Lavaux-Oron <br>Number of people visiting this district:  1 / 133 <br>Proportion of people visiting this district:  0.75%","District name:  Morges <br>Number of people visiting this district:  10 / 133 <br>Proportion of people visiting this district:  7.52%","District name:  Nyon <br>Number of people visiting this district:  14 / 133 <br>Proportion of people visiting this district:  10.53%","District name:  Ouest lausannois <br>Number of people visiting this district:  1 / 133 <br>Proportion of people visiting this district:  0.75%","District name:  Riviera-Pays-d'Enhaut <br>Number of people visiting this district:  37 / 133 <br>Proportion of people visiting this district:  27.82%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-773f496fdc176fdeed46" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-773f496fdc176fdeed46">{"x":{"visdat":{"beea2b7c875b":["function () ","plotlyVisDat"]},"cur_data":"beea2b7c875b","attrs":{"beea2b7c875b":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (District)","xaxis":{"domain":[0,1],"automargin":true,"title":"District","showgrid":false,"zeroline":false,"type":"category","categoryorder":"array","categoryarray":["Aigle","Lausanne","Riviera-Pays-d'Enhaut","Nyon","Morges","Jura-Nord vaudois"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false,"tickformat":",.0%"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Aigle","Jura-Nord vaudois","Lausanne","Morges","Nyon","Riviera-Pays-d'Enhaut"],"y":[0.5617977528089888,0.02247191011235955,0.16853932584269662,0.033707865168539325,0.056179775280898875,0.15730337078651685],"text":["","","","","",""],"hoverinfo":["text","text","text","text","text","text"],"hovertext":["District name:  Aigle <br>Number of people visiting this district:  50 / 89 <br>Proportion of people visiting this district:  56.2%","District name:  Jura-Nord vaudois <br>Number of people visiting this district:  2 / 89 <br>Proportion of people visiting this district:  2.2%","District name:  Lausanne <br>Number of people visiting this district:  15 / 89 <br>Proportion of people visiting this district:  16.9%","District name:  Morges <br>Number of people visiting this district:  3 / 89 <br>Proportion of people visiting this district:  3.4%","District name:  Nyon <br>Number of people visiting this district:  5 / 89 <br>Proportion of people visiting this district:  5.6%","District name:  Riviera-Pays-d'Enhaut <br>Number of people visiting this district:  14 / 89 <br>Proportion of people visiting this district:  15.7%"],"textposition":["auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-daac5286f6cfc0cddea9" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-daac5286f6cfc0cddea9">{"x":{"visdat":{"beea2b063cf":["function () ","plotlyVisDat"]},"cur_data":"beea2b063cf","attrs":{"beea2b063cf":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (District)","xaxis":{"domain":[0,1],"automargin":true,"title":"District","showgrid":false,"zeroline":false,"type":"category","categoryorder":"array","categoryarray":["Lausanne","Riviera-Pays-d'Enhaut","Nyon","Aigle","Morges","Broye-Vully","Jura-Nord vaudois","Lavaux-Oron","Ouest lausannois"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false,"tickformat":",.0%"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Aigle","Broye-Vully","Jura-Nord vaudois","Lausanne","Lavaux-Oron","Morges","Nyon","Ouest lausannois","Riviera-Pays-d'Enhaut"],"y":[0.090909090909090912,0.03896103896103896,0.03896103896103896,0.48051948051948051,0.025974025974025976,0.064935064935064929,0.1038961038961039,0.012987012987012988,0.14285714285714285],"text":["","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text"],"hovertext":["District name:  Aigle <br>Number of people visiting this district:  7 / 77 <br>Proportion of people visiting this district:  9.1%","District name:  Broye-Vully <br>Number of people visiting this district:  3 / 77 <br>Proportion of people visiting this district:  3.9%","District name:  Jura-Nord vaudois <br>Number of people visiting this district:  3 / 77 <br>Proportion of people visiting this district:  3.9%","District name:  Lausanne <br>Number of people visiting this district:  37 / 77 <br>Proportion of people visiting this district:  48.1%","District name:  Lavaux-Oron <br>Number of people visiting this district:  2 / 77 <br>Proportion of people visiting this district:  2.6%","District name:  Morges <br>Number of people visiting this district:  5 / 77 <br>Proportion of people visiting this district:  6.5%","District name:  Nyon <br>Number of people visiting this district:  8 / 77 <br>Proportion of people visiting this district:  10.4%","District name:  Ouest lausannois <br>Number of people visiting this district:  1 / 77 <br>Proportion of people visiting this district:  1.3%","District name:  Riviera-Pays-d'Enhaut <br>Number of people visiting this district:  11 / 77 <br>Proportion of people visiting this district:  14.3%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<p>As we can see, out of the 67 city surveyed in the 10 district, the most popular district is Lausanne. This is not really suprising because of the way the data was collected. More people were surveyed in these city/districts than other smaller one. It is still interesting to have a look to keep this in mind.</p>
</section>
<section id="type-of-accommodation-by-country" class="level3">
<h3 class="anchored" data-anchor-id="type-of-accommodation-by-country">Type of Accommodation by country</h3>
<p>Let’s dive deeper into the most popular type of accomodation per contry. You can find below a plot showing the proportion of each type of accomodation for all the contries and for the most represented countries in our data, Switzerland, France, UK, Germany, USA, Belgium and Spain.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Total</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Switzerland</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">France</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false" href="">UK</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false" href="">Germany</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false" href="">USA</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false" href="">Belgium</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-8" role="tab" aria-controls="tabset-2-8" aria-selected="false" href="">Spain</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c8c489db5d231c03c93f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c8c489db5d231c03c93f">{"x":{"visdat":{"beea5e0f687c":["function () ","plotlyVisDat"]},"cur_data":"beea5e0f687c","attrs":{"beea5e0f687c":{"y":{},"x":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","orientation":"h","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Accommodation Types","xaxis":{"domain":[0,1],"automargin":true,"title":"","side":"top","tickformat":",.0%"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Type of Accommodation","type":"category","categoryorder":"array","categoryarray":["Agritourism (overnight stay on a farm)","Mountain hut / SAC","Group accommodation","Youth Hostel / Hostel","Bed & Breakfast","Serviced Apartments / Chalets / Villas (service during stay)","Other","Campsite","Rented apartment / house","Free apartment/house (own or from friends / relatives etc.)","Hotel / Spa House"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"y":["Agritourism (overnight stay on a farm)","Mountain hut / SAC","Group accommodation","Youth Hostel / Hostel","Bed & Breakfast","Serviced Apartments / Chalets / Villas (service during stay)","Other","Campsite","Rented apartment / house","Free apartment/house (own or from friends / relatives etc.)","Hotel / Spa House"],"x":[0.0020491803278688526,0.0053278688524590161,0.013114754098360656,0.016393442622950821,0.028688524590163935,0.036475409836065571,0.11680327868852459,0.12008196721311476,0.14795081967213114,0.19467213114754098,0.31844262295081965],"text":["","","","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text"],"hovertext":["Accommodation type:  Agritourism (overnight stay on a farm) <br>Number of people staying in this type of accommodation:  5 / 2440 <br>Proportion of people staying in this type of accommodation:  0.20%","Accommodation type:  Mountain hut / SAC <br>Number of people staying in this type of accommodation:  13 / 2440 <br>Proportion of people staying in this type of accommodation:  0.53%","Accommodation type:  Group accommodation <br>Number of people staying in this type of accommodation:  32 / 2440 <br>Proportion of people staying in this type of accommodation:  1.31%","Accommodation type:  Youth Hostel / Hostel <br>Number of people staying in this type of accommodation:  40 / 2440 <br>Proportion of people staying in this type of accommodation:  1.64%","Accommodation type:  Bed & Breakfast <br>Number of people staying in this type of accommodation:  70 / 2440 <br>Proportion of people staying in this type of accommodation:  2.87%","Accommodation type:  Serviced Apartments / Chalets / Villas (service during stay) <br>Number of people staying in this type of accommodation:  89 / 2440 <br>Proportion of people staying in this type of accommodation:  3.65%","Accommodation type:  Other <br>Number of people staying in this type of accommodation:  285 / 2440 <br>Proportion of people staying in this type of accommodation:  11.68%","Accommodation type:  Campsite <br>Number of people staying in this type of accommodation:  293 / 2440 <br>Proportion of people staying in this type of accommodation:  12.01%","Accommodation type:  Rented apartment / house <br>Number of people staying in this type of accommodation:  361 / 2440 <br>Proportion of people staying in this type of accommodation:  14.80%","Accommodation type:  Free apartment/house (own or from friends / relatives etc.) <br>Number of people staying in this type of accommodation:  475 / 2440 <br>Proportion of people staying in this type of accommodation:  19.47%","Accommodation type:  Hotel / Spa House <br>Number of people staying in this type of accommodation:  777 / 2440 <br>Proportion of people staying in this type of accommodation:  31.84%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],"orientation":"h","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-994353fcc194609258a8" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-994353fcc194609258a8">{"x":{"visdat":{"beea2e34cede":["function () ","plotlyVisDat"]},"cur_data":"beea2e34cede","attrs":{"beea2e34cede":{"y":{},"x":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","orientation":"h","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Accommodation Types for Swiss tourists","xaxis":{"domain":[0,1],"automargin":true,"title":"","side":"top","tickformat":",.0%"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Type of Accommodation","type":"category","categoryorder":"array","categoryarray":["Mountain hut / SAC","Group accommodation","Youth Hostel / Hostel","Bed & Breakfast","Serviced Apartments / Chalets / Villas (service during stay)","Other","Free apartment/house (own or from friends / relatives etc.)","Rented apartment / house","Campsite","Hotel / Spa House"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"y":["Mountain hut / SAC","Group accommodation","Youth Hostel / Hostel","Bed & Breakfast","Serviced Apartments / Chalets / Villas (service during stay)","Other","Free apartment/house (own or from friends / relatives etc.)","Rented apartment / house","Campsite","Hotel / Spa House"],"x":[0.0025940337224383916,0.012970168612191959,0.012970168612191959,0.022049286640726331,0.040207522697795074,0.068741893644617386,0.11413748378728923,0.14785992217898833,0.28534370946822307,0.29312581063553828],"text":["","","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text","text"],"hovertext":["Accommodation type:  Mountain hut / SAC <br>Number of people staying in this type of accommodation:  2 / 771 <br>Proportion of people staying in this type of accommodation:  0.26%","Accommodation type:  Group accommodation <br>Number of people staying in this type of accommodation:  10 / 771 <br>Proportion of people staying in this type of accommodation:  1.30%","Accommodation type:  Youth Hostel / Hostel <br>Number of people staying in this type of accommodation:  10 / 771 <br>Proportion of people staying in this type of accommodation:  1.30%","Accommodation type:  Bed & Breakfast <br>Number of people staying in this type of accommodation:  17 / 771 <br>Proportion of people staying in this type of accommodation:  2.20%","Accommodation type:  Serviced Apartments / Chalets / Villas (service during stay) <br>Number of people staying in this type of accommodation:  31 / 771 <br>Proportion of people staying in this type of accommodation:  4.02%","Accommodation type:  Other <br>Number of people staying in this type of accommodation:  53 / 771 <br>Proportion of people staying in this type of accommodation:  6.87%","Accommodation type:  Free apartment/house (own or from friends / relatives etc.) <br>Number of people staying in this type of accommodation:  88 / 771 <br>Proportion of people staying in this type of accommodation:  11.41%","Accommodation type:  Rented apartment / house <br>Number of people staying in this type of accommodation:  114 / 771 <br>Proportion of people staying in this type of accommodation:  14.79%","Accommodation type:  Campsite <br>Number of people staying in this type of accommodation:  220 / 771 <br>Proportion of people staying in this type of accommodation:  28.53%","Accommodation type:  Hotel / Spa House <br>Number of people staying in this type of accommodation:  226 / 771 <br>Proportion of people staying in this type of accommodation:  29.31%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],"orientation":"h","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-5181e933b4375d83320e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5181e933b4375d83320e">{"x":{"visdat":{"beea4a3cfa6a":["function () ","plotlyVisDat"]},"cur_data":"beea4a3cfa6a","attrs":{"beea4a3cfa6a":{"y":{},"x":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","orientation":"h","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Accommodation Types for French tourists","xaxis":{"domain":[0,1],"automargin":true,"title":"","side":"top","tickformat":",.0%"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Type of Accommodation","type":"category","categoryorder":"array","categoryarray":["Group accommodation","Youth Hostel / Hostel","Agritourism (overnight stay on a farm)","Mountain hut / SAC","Bed & Breakfast","Serviced Apartments / Chalets / Villas (service during stay)","Campsite","Other","Rented apartment / house","Free apartment/house (own or from friends / relatives etc.)","Hotel / Spa House"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"y":["Group accommodation","Youth Hostel / Hostel","Agritourism (overnight stay on a farm)","Mountain hut / SAC","Bed & Breakfast","Serviced Apartments / Chalets / Villas (service during stay)","Campsite","Other","Rented apartment / house","Free apartment/house (own or from friends / relatives etc.)","Hotel / Spa House"],"x":[0.002840909090909091,0.002840909090909091,0.005681818181818182,0.005681818181818182,0.028409090909090908,0.028409090909090908,0.082386363636363633,0.13920454545454544,0.19886363636363635,0.22443181818181818,0.28125],"text":["","","","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text"],"hovertext":["Accommodation type:  Group accommodation <br>Number of people staying in this type of accommodation:  1 / 352 <br>Proportion of people staying in this type of accommodation:  0.28%","Accommodation type:  Youth Hostel / Hostel <br>Number of people staying in this type of accommodation:  1 / 352 <br>Proportion of people staying in this type of accommodation:  0.28%","Accommodation type:  Agritourism (overnight stay on a farm) <br>Number of people staying in this type of accommodation:  2 / 352 <br>Proportion of people staying in this type of accommodation:  0.57%","Accommodation type:  Mountain hut / SAC <br>Number of people staying in this type of accommodation:  2 / 352 <br>Proportion of people staying in this type of accommodation:  0.57%","Accommodation type:  Bed & Breakfast <br>Number of people staying in this type of accommodation:  10 / 352 <br>Proportion of people staying in this type of accommodation:  2.84%","Accommodation type:  Serviced Apartments / Chalets / Villas (service during stay) <br>Number of people staying in this type of accommodation:  10 / 352 <br>Proportion of people staying in this type of accommodation:  2.84%","Accommodation type:  Campsite <br>Number of people staying in this type of accommodation:  29 / 352 <br>Proportion of people staying in this type of accommodation:  8.24%","Accommodation type:  Other <br>Number of people staying in this type of accommodation:  49 / 352 <br>Proportion of people staying in this type of accommodation:  13.92%","Accommodation type:  Rented apartment / house <br>Number of people staying in this type of accommodation:  70 / 352 <br>Proportion of people staying in this type of accommodation:  19.89%","Accommodation type:  Free apartment/house (own or from friends / relatives etc.) <br>Number of people staying in this type of accommodation:  79 / 352 <br>Proportion of people staying in this type of accommodation:  22.44%","Accommodation type:  Hotel / Spa House <br>Number of people staying in this type of accommodation:  99 / 352 <br>Proportion of people staying in this type of accommodation:  28.12%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],"orientation":"h","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c7d2d98771fa48c815bf" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c7d2d98771fa48c815bf">{"x":{"visdat":{"beea3283a139":["function () ","plotlyVisDat"]},"cur_data":"beea3283a139","attrs":{"beea3283a139":{"y":{},"x":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","orientation":"h","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Accommodation Types for British tourists","xaxis":{"domain":[0,1],"automargin":true,"title":"","side":"top","tickformat":",.0%"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Type of Accommodation","type":"category","categoryorder":"array","categoryarray":["Mountain hut / SAC","Youth Hostel / Hostel","Bed & Breakfast","Campsite","Serviced Apartments / Chalets / Villas (service during stay)","Other","Rented apartment / house","Hotel / Spa House","Free apartment/house (own or from friends / relatives etc.)"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"y":["Mountain hut / SAC","Youth Hostel / Hostel","Bed & Breakfast","Campsite","Serviced Apartments / Chalets / Villas (service during stay)","Other","Rented apartment / house","Hotel / Spa House","Free apartment/house (own or from friends / relatives etc.)"],"x":[0.0054945054945054949,0.0054945054945054949,0.02197802197802198,0.02197802197802198,0.032967032967032968,0.11538461538461539,0.14285714285714285,0.31318681318681318,0.34065934065934067],"text":["","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text"],"hovertext":["Accommodation type:  Mountain hut / SAC <br>Number of people staying in this type of accommodation:  1 / 182 <br>Proportion of people staying in this type of accommodation:  0.55%","Accommodation type:  Youth Hostel / Hostel <br>Number of people staying in this type of accommodation:  1 / 182 <br>Proportion of people staying in this type of accommodation:  0.55%","Accommodation type:  Bed & Breakfast <br>Number of people staying in this type of accommodation:  4 / 182 <br>Proportion of people staying in this type of accommodation:  2.20%","Accommodation type:  Campsite <br>Number of people staying in this type of accommodation:  4 / 182 <br>Proportion of people staying in this type of accommodation:  2.20%","Accommodation type:  Serviced Apartments / Chalets / Villas (service during stay) <br>Number of people staying in this type of accommodation:  6 / 182 <br>Proportion of people staying in this type of accommodation:  3.30%","Accommodation type:  Other <br>Number of people staying in this type of accommodation:  21 / 182 <br>Proportion of people staying in this type of accommodation:  11.54%","Accommodation type:  Rented apartment / house <br>Number of people staying in this type of accommodation:  26 / 182 <br>Proportion of people staying in this type of accommodation:  14.29%","Accommodation type:  Hotel / Spa House <br>Number of people staying in this type of accommodation:  57 / 182 <br>Proportion of people staying in this type of accommodation:  31.32%","Accommodation type:  Free apartment/house (own or from friends / relatives etc.) <br>Number of people staying in this type of accommodation:  62 / 182 <br>Proportion of people staying in this type of accommodation:  34.07%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto"],"orientation":"h","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a8932ecb09998dba0e2f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a8932ecb09998dba0e2f">{"x":{"visdat":{"beea3cbcb024":["function () ","plotlyVisDat"]},"cur_data":"beea3cbcb024","attrs":{"beea3cbcb024":{"y":{},"x":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","orientation":"h","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Accommodation Types for German tourists","xaxis":{"domain":[0,1],"automargin":true,"title":"","side":"top","tickformat":",.0%"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Type of Accommodation","type":"category","categoryorder":"array","categoryarray":["Agritourism (overnight stay on a farm)","Group accommodation","Mountain hut / SAC","Bed & Breakfast","Other","Rented apartment / house","Campsite","Free apartment/house (own or from friends / relatives etc.)","Hotel / Spa House"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"y":["Agritourism (overnight stay on a farm)","Group accommodation","Mountain hut / SAC","Bed & Breakfast","Other","Rented apartment / house","Campsite","Free apartment/house (own or from friends / relatives etc.)","Hotel / Spa House"],"x":[0.0073529411764705881,0.022058823529411766,0.022058823529411766,0.036764705882352942,0.080882352941176475,0.125,0.15441176470588236,0.23529411764705882,0.31617647058823528],"text":["","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text"],"hovertext":["Accommodation type:  Agritourism (overnight stay on a farm) <br>Number of people staying in this type of accommodation:  1 / 136 <br>Proportion of people staying in this type of accommodation:  0.74%","Accommodation type:  Group accommodation <br>Number of people staying in this type of accommodation:  3 / 136 <br>Proportion of people staying in this type of accommodation:  2.21%","Accommodation type:  Mountain hut / SAC <br>Number of people staying in this type of accommodation:  3 / 136 <br>Proportion of people staying in this type of accommodation:  2.21%","Accommodation type:  Bed & Breakfast <br>Number of people staying in this type of accommodation:  5 / 136 <br>Proportion of people staying in this type of accommodation:  3.68%","Accommodation type:  Other <br>Number of people staying in this type of accommodation:  11 / 136 <br>Proportion of people staying in this type of accommodation:  8.09%","Accommodation type:  Rented apartment / house <br>Number of people staying in this type of accommodation:  17 / 136 <br>Proportion of people staying in this type of accommodation:  12.50%","Accommodation type:  Campsite <br>Number of people staying in this type of accommodation:  21 / 136 <br>Proportion of people staying in this type of accommodation:  15.44%","Accommodation type:  Free apartment/house (own or from friends / relatives etc.) <br>Number of people staying in this type of accommodation:  32 / 136 <br>Proportion of people staying in this type of accommodation:  23.53%","Accommodation type:  Hotel / Spa House <br>Number of people staying in this type of accommodation:  43 / 136 <br>Proportion of people staying in this type of accommodation:  31.62%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto"],"orientation":"h","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-611107a1d79b0187940b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-611107a1d79b0187940b">{"x":{"visdat":{"beea739f3756":["function () ","plotlyVisDat"]},"cur_data":"beea739f3756","attrs":{"beea739f3756":{"y":{},"x":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","orientation":"h","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Accommodation Types for American tourists","xaxis":{"domain":[0,1],"automargin":true,"title":"","side":"top","tickformat":",.0%"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Type of Accommodation","type":"category","categoryorder":"array","categoryarray":["Campsite","Youth Hostel / Hostel","Group accommodation","Serviced Apartments / Chalets / Villas (service during stay)","Bed & Breakfast","Free apartment/house (own or from friends / relatives etc.)","Rented apartment / house","Other","Hotel / Spa House"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"y":["Campsite","Youth Hostel / Hostel","Group accommodation","Serviced Apartments / Chalets / Villas (service during stay)","Bed & Breakfast","Free apartment/house (own or from friends / relatives etc.)","Rented apartment / house","Other","Hotel / Spa House"],"x":[0.0076335877862595417,0.0076335877862595417,0.015267175572519083,0.030534351145038167,0.038167938931297711,0.12977099236641221,0.12977099236641221,0.18320610687022901,0.4580152671755725],"text":["","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text"],"hovertext":["Accommodation type:  Campsite <br>Number of people staying in this type of accommodation:  1 / 131 <br>Proportion of people staying in this type of accommodation:  0.76%","Accommodation type:  Youth Hostel / Hostel <br>Number of people staying in this type of accommodation:  1 / 131 <br>Proportion of people staying in this type of accommodation:  0.76%","Accommodation type:  Group accommodation <br>Number of people staying in this type of accommodation:  2 / 131 <br>Proportion of people staying in this type of accommodation:  1.53%","Accommodation type:  Serviced Apartments / Chalets / Villas (service during stay) <br>Number of people staying in this type of accommodation:  4 / 131 <br>Proportion of people staying in this type of accommodation:  3.05%","Accommodation type:  Bed & Breakfast <br>Number of people staying in this type of accommodation:  5 / 131 <br>Proportion of people staying in this type of accommodation:  3.82%","Accommodation type:  Free apartment/house (own or from friends / relatives etc.) <br>Number of people staying in this type of accommodation:  17 / 131 <br>Proportion of people staying in this type of accommodation:  12.98%","Accommodation type:  Rented apartment / house <br>Number of people staying in this type of accommodation:  17 / 131 <br>Proportion of people staying in this type of accommodation:  12.98%","Accommodation type:  Other <br>Number of people staying in this type of accommodation:  24 / 131 <br>Proportion of people staying in this type of accommodation:  18.32%","Accommodation type:  Hotel / Spa House <br>Number of people staying in this type of accommodation:  60 / 131 <br>Proportion of people staying in this type of accommodation:  45.80%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto"],"orientation":"h","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-0d5f7a52d98e8bb22100" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0d5f7a52d98e8bb22100">{"x":{"visdat":{"beea1c85fe4f":["function () ","plotlyVisDat"]},"cur_data":"beea1c85fe4f","attrs":{"beea1c85fe4f":{"y":{},"x":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","orientation":"h","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Accommodation Types for Belgian tourists","xaxis":{"domain":[0,1],"automargin":true,"title":"","side":"top","tickformat":",.0%"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Type of Accommodation","type":"category","categoryorder":"array","categoryarray":["Bed & Breakfast","Mountain hut / SAC","Youth Hostel / Hostel","Group accommodation","Serviced Apartments / Chalets / Villas (service during stay)","Other","Rented apartment / house","Free apartment/house (own or from friends / relatives etc.)","Hotel / Spa House"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"y":["Bed & Breakfast","Mountain hut / SAC","Youth Hostel / Hostel","Group accommodation","Serviced Apartments / Chalets / Villas (service during stay)","Other","Rented apartment / house","Free apartment/house (own or from friends / relatives etc.)","Hotel / Spa House"],"x":[0.011235955056179775,0.011235955056179775,0.011235955056179775,0.056179775280898875,0.056179775280898875,0.06741573033707865,0.1348314606741573,0.3258426966292135,0.3258426966292135],"text":["","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text"],"hovertext":["Accommodation type:  Bed & Breakfast <br>Number of people staying in this type of accommodation:  1 / 89 <br>Proportion of people staying in this type of accommodation:  1.12%","Accommodation type:  Mountain hut / SAC <br>Number of people staying in this type of accommodation:  1 / 89 <br>Proportion of people staying in this type of accommodation:  1.12%","Accommodation type:  Youth Hostel / Hostel <br>Number of people staying in this type of accommodation:  1 / 89 <br>Proportion of people staying in this type of accommodation:  1.12%","Accommodation type:  Group accommodation <br>Number of people staying in this type of accommodation:  5 / 89 <br>Proportion of people staying in this type of accommodation:  5.62%","Accommodation type:  Serviced Apartments / Chalets / Villas (service during stay) <br>Number of people staying in this type of accommodation:  5 / 89 <br>Proportion of people staying in this type of accommodation:  5.62%","Accommodation type:  Other <br>Number of people staying in this type of accommodation:  6 / 89 <br>Proportion of people staying in this type of accommodation:  6.74%","Accommodation type:  Rented apartment / house <br>Number of people staying in this type of accommodation:  12 / 89 <br>Proportion of people staying in this type of accommodation:  13.48%","Accommodation type:  Free apartment/house (own or from friends / relatives etc.) <br>Number of people staying in this type of accommodation:  29 / 89 <br>Proportion of people staying in this type of accommodation:  32.58%","Accommodation type:  Hotel / Spa House <br>Number of people staying in this type of accommodation:  29 / 89 <br>Proportion of people staying in this type of accommodation:  32.58%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto"],"orientation":"h","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7494448b2f0fff000bd0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7494448b2f0fff000bd0">{"x":{"visdat":{"beea3f8ccb50":["function () ","plotlyVisDat"]},"cur_data":"beea3f8ccb50","attrs":{"beea3f8ccb50":{"y":{},"x":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","orientation":"h","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Accommodation Types for Spanish tourists","xaxis":{"domain":[0,1],"automargin":true,"title":"","side":"top","tickformat":",.0%"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Type of Accommodation","type":"category","categoryorder":"array","categoryarray":["Bed & Breakfast","Group accommodation","Mountain hut / SAC","Serviced Apartments / Chalets / Villas (service during stay)","Youth Hostel / Hostel","Campsite","Rented apartment / house","Free apartment/house (own or from friends / relatives etc.)","Other","Hotel / Spa House"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"y":["Bed & Breakfast","Group accommodation","Mountain hut / SAC","Serviced Apartments / Chalets / Villas (service during stay)","Youth Hostel / Hostel","Campsite","Rented apartment / house","Free apartment/house (own or from friends / relatives etc.)","Other","Hotel / Spa House"],"x":[0.013513513513513514,0.013513513513513514,0.013513513513513514,0.013513513513513514,0.027027027027027029,0.081081081081081086,0.1891891891891892,0.20270270270270271,0.20270270270270271,0.24324324324324326],"text":["","","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text","text"],"hovertext":["Accommodation type:  Bed & Breakfast <br>Number of people staying in this type of accommodation:  1 / 74 <br>Proportion of people staying in this type of accommodation:  1.35%","Accommodation type:  Group accommodation <br>Number of people staying in this type of accommodation:  1 / 74 <br>Proportion of people staying in this type of accommodation:  1.35%","Accommodation type:  Mountain hut / SAC <br>Number of people staying in this type of accommodation:  1 / 74 <br>Proportion of people staying in this type of accommodation:  1.35%","Accommodation type:  Serviced Apartments / Chalets / Villas (service during stay) <br>Number of people staying in this type of accommodation:  1 / 74 <br>Proportion of people staying in this type of accommodation:  1.35%","Accommodation type:  Youth Hostel / Hostel <br>Number of people staying in this type of accommodation:  2 / 74 <br>Proportion of people staying in this type of accommodation:  2.70%","Accommodation type:  Campsite <br>Number of people staying in this type of accommodation:  6 / 74 <br>Proportion of people staying in this type of accommodation:  8.11%","Accommodation type:  Rented apartment / house <br>Number of people staying in this type of accommodation:  14 / 74 <br>Proportion of people staying in this type of accommodation:  18.92%","Accommodation type:  Free apartment/house (own or from friends / relatives etc.) <br>Number of people staying in this type of accommodation:  15 / 74 <br>Proportion of people staying in this type of accommodation:  20.27%","Accommodation type:  Other <br>Number of people staying in this type of accommodation:  15 / 74 <br>Proportion of people staying in this type of accommodation:  20.27%","Accommodation type:  Hotel / Spa House <br>Number of people staying in this type of accommodation:  18 / 74 <br>Proportion of people staying in this type of accommodation:  24.32%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],"orientation":"h","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<p>The most popular accommodation type in the canton of Vaud, according to a survey of 2,440 respondents, is the Hotel/SPA House, selected by 777 individuals. Notably, 293 people chose to stay at campsites. For Swiss respondents specifically, campsites rise to the second most popular option, with nearly 30% opting for this type of accommodation, while the Hotel/Spa House remains the top choice. Interestingly, the free apartment/house is highly favored by visitors from France, the United Kingdom, Germany, and Belgium, ranking in their top two choices. Conversely, visitors from the United States tend to prefer hotels, rented apartments/houses, or other types of accommodations over free apartments. Additionally, campsites are notably less popular among American visitors. Below, a word cloud illustrates other favored types of accommodation.</p>
<section id="word-cloud" class="level4">
<h4 class="anchored" data-anchor-id="word-cloud">Word Cloud</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/wordcloud-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Among the 491 respondents who did not choose traditional accommodations, the most popular alternative was staying with family, as indicated by 29 individuals. Staying with friends was the second most common choice, favored by 27 respondents, while staying at someone else’s house ranked third with 22 mentions.</p>
</section>
</section>
<section id="hotels-stars" class="level3">
<h3 class="anchored" data-anchor-id="hotels-stars">Hotels Stars</h3>
<p>Now, let’s have a look at the hotel standing of the places where the people stayed. This will highlight the quality of the stay per district.</p>
<section id="average-stars-per-district" class="level4">
<h4 class="anchored" data-anchor-id="average-stars-per-district">Average Stars per District</h4>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-5a7c36c7e8381a32c318" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5a7c36c7e8381a32c318">{"x":{"visdat":{"beea1df07b17":["function () ","plotlyVisDat"]},"cur_data":"beea1df07b17","attrs":{"beea1df07b17":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"name":"Average Stars","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Average Stars per District","xaxis":{"domain":[0,1],"automargin":true,"title":"District","type":"category","categoryorder":"array","categoryarray":["Ouest lausannois","Riviera-Pays-d'Enhaut","Nyon","Morges","Lausanne","Aigle","Jura-Nord vaudois","Broye-Vully","Lavaux-Oron","Gros-de-Vaud"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Stars"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Ouest lausannois","Riviera-Pays-d'Enhaut","Nyon","Morges","Lausanne","Aigle","Jura-Nord vaudois","Broye-Vully","Lavaux-Oron"],"y":[4,3.6600000000000001,3.5600000000000001,3.54,3.52,3.3900000000000001,3.3500000000000001,3.3300000000000001,3.2999999999999998],"text":["","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text"],"hovertext":["District name:  Ouest lausannois <br>Average Stars:  4 ★ <br>Number of people visiting this district:  13 / 2486","District name:  Riviera-Pays-d'Enhaut <br>Average Stars:  3.66 ★ <br>Number of people visiting this district:  623 / 2486","District name:  Nyon <br>Average Stars:  3.56 ★ <br>Number of people visiting this district:  177 / 2486","District name:  Morges <br>Average Stars:  3.54 ★ <br>Number of people visiting this district:  189 / 2486","District name:  Lausanne <br>Average Stars:  3.52 ★ <br>Number of people visiting this district:  627 / 2486","District name:  Aigle <br>Average Stars:  3.39 ★ <br>Number of people visiting this district:  471 / 2486","District name:  Jura-Nord vaudois <br>Average Stars:  3.35 ★ <br>Number of people visiting this district:  322 / 2486","District name:  Broye-Vully <br>Average Stars:  3.33 ★ <br>Number of people visiting this district:  30 / 2486","District name:  Lavaux-Oron <br>Average Stars:  3.3 ★ <br>Number of people visiting this district:  33 / 2486"],"name":"Average Stars","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As we can see on the graph above, the best average is optain in Ouest lausannois with an average of 4 stars. But this statistics is not very representative to the reality. Only 13 people answered the survey in this district which is not enough to have a good idea of the quality of the hotels in this district. The second best region after Ouest lausannois is Riviera-Pays-d’Enhaut with an average of 3.66 stars. This district got with 623 observation which is more representative. This high score for the Region of Riviera-Pays-d’Enhaut is not really surprising given the fact that this place is well know for its luxury hotels.</p>
</section>
</section>
</section>
<section id="spendings" class="level2">
<h2 class="anchored" data-anchor-id="spendings">Spendings</h2>
<blockquote class="blockquote">
<p>Expenses and where they come from, when, where and for which sector?</p>
</blockquote>
<section id="percentage-of-people-with-package-without-package" class="level3">
<h3 class="anchored" data-anchor-id="percentage-of-people-with-package-without-package">Percentage of people with package &amp; without package</h3>
<p>To begin with, we can notice that there are 2 types of traveller spendings: the ones who come in Switzerland with no package, meaning they spend on different categories that are not included in the packages, and the ones who come with a package, which usually already includes some different categories.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of non-NA entries for each type of spending</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>spending_counts <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Package =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(F82_Total)),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">WithoutPackage =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(F81_Total))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"PackageType"</span>, <span class="at">value =</span> <span class="st">"Count"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentages</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>total_records <span class="ot">&lt;-</span> <span class="fu">sum</span>(spending_counts<span class="sc">$</span>Count)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>spending_counts <span class="ot">&lt;-</span> spending_counts <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> (Count <span class="sc">/</span> total_records) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the percentages with the percentage shown on the bars</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spending_counts, <span class="fu">aes</span>(<span class="at">x =</span> PackageType, <span class="at">y =</span> Percentage, <span class="at">fill =</span> PackageType)) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Percentage)),  <span class="co"># Format the labels to one decimal place</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),  <span class="co"># Adjust text to be inside the bars</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percentage of Observations With and Without Package"</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Type of Spending"</span>,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage (%)"</span>) <span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel1"</span>) <span class="sc">+</span> <span class="co"># Aesthetically pleasing color palette</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A majority of people travelling in Vaud come without a package.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Average Spending by category (no package tour)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Average Spending by Category (with package)</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>spending_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spending_Type =</span> <span class="fu">c</span>(<span class="st">"Overnight stay"</span>, <span class="st">"Transports"</span>, <span class="st">"Food &amp; Drink"</span>, <span class="st">"Souvenirs"</span>, <span class="st">"Other shopping"</span>, <span class="st">"Other expenses"</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount =</span> <span class="fu">c</span>(<span class="fu">mean</span>(data<span class="sc">$</span>F81_01, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_02, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_03, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_04, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_05, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_06, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spending_data, <span class="fu">aes</span>(<span class="at">x =</span> Spending_Type, <span class="at">y =</span> Amount, <span class="at">fill =</span> Spending_Type)) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Spending by Category (no package tour)"</span>, <span class="at">x =</span> <span class="st">"Category"</span>, <span class="at">y =</span> <span class="st">"Average Amount"</span>) <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Rotate x-axis labels for readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>spending_data_package <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spending_Type =</span> <span class="fu">c</span>(<span class="st">"Package"</span>, <span class="st">"Overnight stay"</span>, <span class="st">"Transports"</span>, <span class="st">"Food &amp; Drink"</span>, <span class="st">"Souvenirs"</span>, <span class="st">"Other shopping"</span>, <span class="st">"Other expenses"</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount =</span> <span class="fu">c</span>(<span class="fu">mean</span>(data<span class="sc">$</span>F82_01[data<span class="sc">$</span>F82_01 <span class="sc">&lt;=</span> <span class="dv">30000</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Ici on modifie pour inclure seulement les packages qui coûtent en dessous de 30'000 CHF. On assume que les packages qui coûtent au dessus de ce montant ne sont pas en CHF, et donc biaisent le sample.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_02, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_03, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_04, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_05, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_06, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_07, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spending_data_package, <span class="fu">aes</span>(<span class="at">x =</span> Spending_Type, <span class="at">y =</span> Amount, <span class="at">fill =</span> Spending_Type)) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Spending by Category"</span>, <span class="at">x =</span> <span class="st">"Category"</span>, <span class="at">y =</span> <span class="st">"Average Amount"</span>) <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>With these plots, we can clearly observe that there is a difference in spendings for people who travelled with a package compared to the ones travelling without a spending package. Overall, the main expenses of people with a package is the package itself, meaning that most of the other variables are already included in the package. On the other hand, without the package, it is interesting to see that the main spending is on the overnight stay, then the food &amp; drinks and finally the souvenirs.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Total spending per country (no package)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Total spending per country (with package)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">Average spending (no package)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false" href="">Average spending (with package)</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of countries to group as "other countries"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>countries_to_group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Switzerland"</span>, <span class="st">"France"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Germany"</span>, <span class="st">"United States of America"</span>, <span class="st">"Belgium"</span>, <span class="st">"Spain"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate total spending for F81_Total and include continents</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>total_spending_F81 <span class="ot">&lt;-</span> data[data<span class="sc">$</span>F81_Total <span class="sc">&lt;</span> <span class="dv">30000</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Spending_F81 =</span> <span class="fu">sum</span>(F81_Total, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F05_02_ENG_grouped =</span> <span class="fu">if_else</span>(F05_02_ENG <span class="sc">%in%</span> countries_to_group, F05_02_ENG, <span class="st">"Other Countries"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG_grouped, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Spending_F81 =</span> <span class="fu">sum</span>(Total_Spending_F81)) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Spending_F81))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for F81_Total with continent colors</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(total_spending_F81, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(F05_02_ENG_grouped, <span class="sc">-</span>Total_Spending_F81), <span class="at">y =</span> Total_Spending_F81, <span class="at">fill =</span> F05_01_ENG)) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Spending by Country"</span>, <span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Total Spending"</span>) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">name =</span> <span class="st">"Continent"</span>) <span class="sc">+</span> <span class="co"># Color based on continent</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)  <span class="co"># Position the legend at the bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of countries to group as "other countries"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>countries_to_group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Switzerland"</span>, <span class="st">"France"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Germany"</span>, <span class="st">"United States of America"</span>, <span class="st">"Belgium"</span>, <span class="st">"Spain"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate total spending for F82_Total and include continents</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>total_spending_F82 <span class="ot">&lt;-</span> data[data<span class="sc">$</span>F82_Total <span class="sc">&lt;</span> <span class="dv">30000</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Spending_F82 =</span> <span class="fu">sum</span>(F82_Total, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F05_02_ENG_grouped =</span> <span class="fu">if_else</span>(F05_02_ENG <span class="sc">%in%</span> countries_to_group, F05_02_ENG, <span class="st">"Other Countries"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG_grouped, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Spending_F82 =</span> <span class="fu">sum</span>(Total_Spending_F82)) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Spending_F82))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for F82_Total with continent colors</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(total_spending_F82, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(F05_02_ENG_grouped, <span class="sc">-</span>Total_Spending_F82), <span class="at">y =</span> Total_Spending_F82, <span class="at">fill =</span> F05_01_ENG)) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Spending by Country"</span>, <span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Total Spending"</span>) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">name =</span> <span class="st">"Continent"</span>) <span class="sc">+</span> <span class="co"># Color based on continent</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)  <span class="co"># Position the legend at the bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of countries to group as "other countries"</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>countries_to_group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Switzerland"</span>, <span class="st">"France"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Germany"</span>, <span class="st">"United States of America"</span>, <span class="st">"Belgium"</span>, <span class="st">"Spain"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape data from wide to long format</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> data[data<span class="sc">$</span>F81_Total <span class="sc">&lt;</span> <span class="dv">30000</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> F81_01<span class="sc">:</span>F81_06,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Spending_Category"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Amount"</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average spending for each country and each category</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>average_spending <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F05_02_ENG_grouped =</span> <span class="fu">if_else</span>(F05_02_ENG <span class="sc">%in%</span> countries_to_group, F05_02_ENG, <span class="st">"Other Countries"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG_grouped, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_Spending =</span> <span class="fu">mean</span>(Amount, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Average_Spending))</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Aggregate to country level without distinguishing by category</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>average_spending_by_country <span class="ot">&lt;-</span> average_spending <span class="sc">%&gt;%</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG_grouped, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_Spending =</span> <span class="fu">mean</span>(Average_Spending, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Average_Spending))</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the average spending by country in descending order</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(average_spending_by_country, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(F05_02_ENG_grouped, <span class="sc">-</span>Average_Spending), <span class="at">y =</span> Average_Spending, <span class="at">fill =</span> F05_01_ENG)) <span class="sc">+</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Spending by Country"</span>, <span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Average Spending"</span>) <span class="sc">+</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">name =</span> <span class="st">"Continent"</span>) <span class="sc">+</span> <span class="co"># Color based on continent</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)  <span class="co"># Position the legend at the bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of countries to group as "other countries"</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>countries_to_group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Switzerland"</span>, <span class="st">"France"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Germany"</span>, <span class="st">"United States of America"</span>, <span class="st">"Belgium"</span>, <span class="st">"Spain"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape data from wide to long format</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> data[data<span class="sc">$</span>F82_Total <span class="sc">&lt;</span> <span class="dv">30000</span> <span class="sc">&amp;</span> data<span class="sc">$</span>F82_01 <span class="sc">&lt;</span> <span class="dv">30000</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> F82_01<span class="sc">:</span>F82_07,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Spending_Category"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Amount"</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average spending for each country and each category</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>average_spending <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F05_02_ENG_grouped =</span> <span class="fu">if_else</span>(F05_02_ENG <span class="sc">%in%</span> countries_to_group, F05_02_ENG, <span class="st">"Other Countries"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG_grouped, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_Spending =</span> <span class="fu">mean</span>(Amount, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Average_Spending))</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Aggregate to country level without distinguishing by category</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>average_spending_by_country <span class="ot">&lt;-</span> average_spending <span class="sc">%&gt;%</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG_grouped, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_Spending =</span> <span class="fu">mean</span>(Average_Spending, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Average_Spending))</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the average spending by country in descending order</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(average_spending_by_country, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(F05_02_ENG_grouped, <span class="sc">-</span>Average_Spending), <span class="at">y =</span> Average_Spending, <span class="at">fill =</span> F05_01_ENG)) <span class="sc">+</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Spending by Country"</span>, <span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Average Spending"</span>) <span class="sc">+</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">name =</span> <span class="st">"Continent"</span>) <span class="sc">+</span> <span class="co"># Color based on continent</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)  <span class="co"># Position the legend at the bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>For the plots above, we removed outliers (spending of more than 30’000 CHF) because these observations biased the rest of the sample. We assume that it is probable that most respondents with spending above 30’000 made an error in the currency, using their local currency to answer questions instead of CHF.</p>
</section>
<section id="percentage-of-package-by-continent" class="level3">
<h3 class="anchored" data-anchor-id="percentage-of-package-by-continent">Percentage of package by continent</h3>
<p>Now, it is of interest to check where the 8% of traveller with a package are from. For this, we decided to see it as percentage of nationality.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data by adding a binary column for package and non-package tours</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">With_Package =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(F82_Total), <span class="dv">1</span>, <span class="dv">0</span>),  <span class="co"># 1 if there's a package, 0 otherwise</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Without_Package =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(F81_Total), <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># 1 if there's no package, 0 otherwise</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize data to count the number of package and non-package tours by continent</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>continent_summary <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Tours =</span> <span class="fu">n</span>(),  <span class="co"># Total number of tours</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Package_Tours =</span> <span class="fu">sum</span>(With_Package, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Total package tours</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Non_Package_Tours =</span> <span class="fu">sum</span>(Without_Package, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Total non-package tours</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Package_Tour_Percentage =</span> (Package_Tours <span class="sc">/</span> Total_Tours) <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Calculate the percentage</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Package_Tour_Percentage))  <span class="co"># Arrange continents in descending order of package tour percentage</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the percentage of package tours by continent in descending order</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(continent_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(F05_01_ENG, <span class="sc">-</span>Package_Tour_Percentage), <span class="at">y =</span> Package_Tour_Percentage, <span class="at">fill =</span> F05_01_ENG)) <span class="sc">+</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Package_Tour_Percentage)),  <span class="co"># Adding percentage labels</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span>  <span class="co"># Adjust vjust to position labels above bars</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percentage of Package Tours by Continent"</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent"</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage of Package Tours (%)"</span>) <span class="sc">+</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>) <span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As a result, it is interesting to see that the main spenders in packages are from Asia, Africa and South America. It would be interesting to target travellers from these continents to packages deals rather than the rest of nationalities.</p>
</section>
<section id="distribution-of-currency" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-currency">Distribution of Currency</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the frequency and percentage of each currency value</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>currency_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(F80) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar chart</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(currency_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(F80, <span class="fu">desc</span>(Percentage)), <span class="at">y =</span> Percentage, <span class="at">fill =</span> F80)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Percentage, <span class="dv">1</span>), <span class="st">"%"</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Currency"</span>, <span class="at">x =</span> <span class="st">"Currency"</span>, <span class="at">y =</span> <span class="st">"Percentage (%)"</span>) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">"Currency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="partie-victor" class="level2">
<h2 class="anchored" data-anchor-id="partie-victor">Partie Victor</h2>
</section>
<section id="travel-partners-of-visitors" class="level2">
<h2 class="anchored" data-anchor-id="travel-partners-of-visitors">Travel partners of visitors</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_sums_df, <span class="fu">aes</span>(<span class="at">x =</span> Column, <span class="at">y =</span> Percentage)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Percentage, <span class="dv">1</span>), <span class="st">"%"</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frequency of responses"</span>, <span class="at">x =</span> <span class="st">"Traveled with"</span>, <span class="at">y =</span> <span class="st">"Percentage"</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EDA_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We notice that more than 2/3 of overall visitors came to Vaud with their partner (68.7%). Of these, 43% came only with their partner, without friends, children or other family. Almost 1/3 of visitors came with their children. Only a small fraction of people visited Vaud alone (14.6%), and a minority of people took their pet(s) with them (6.5%).</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>