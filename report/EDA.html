<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>eda</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="EDA_files/libs/clipboard/clipboard.min.js"></script>
<script src="EDA_files/libs/quarto-html/quarto.js"></script>
<script src="EDA_files/libs/quarto-html/popper.min.js"></script>
<script src="EDA_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="EDA_files/libs/quarto-html/anchor.min.js"></script>
<link href="EDA_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="EDA_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="EDA_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="EDA_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="EDA_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="EDA_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="EDA_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="EDA_files/libs/datatables-binding-0.33/datatables.js"></script>
<script src="EDA_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="EDA_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="EDA_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="EDA_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="EDA_files/libs/dt-plugin-searchhighlight-1.13.6/source.css" rel="stylesheet">
<script src="EDA_files/libs/dt-plugin-searchhighlight-1.13.6/jquery.highlight.js"></script>
<script src="EDA_files/libs/dt-plugin-searchhighlight-1.13.6/source.min.js"></script>
<link href="EDA_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="EDA_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="EDA_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="EDA_files/libs/typedarray-0.1/typedarray.min.js"></script>
<link href="EDA_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="EDA_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="eda" class="level1">
<h1>EDA</h1>
</section>
<section id="partie-stefan" class="level1">
<h1>Partie Stefan</h1>
<section id="data-exploration-who-is-coming" class="level3">
<h3 class="anchored" data-anchor-id="data-exploration-who-is-coming">Data Exploration: Who is coming?</h3>
<p><strong>Global percentage of people coming in the canton of Vaud per continent</strong></p>
<p>With the data gathered from the survey, we have first explored the overall distribution of nationalities of the visitors. Therefore, you will find here a table and a graph providing the frequency per nationality and the percentage of nationality it represents.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">### F05_01.ENG </span><span class="al">###</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#nb of occurrences by country and continents </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>OccurencesCountry <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data<span class="sc">$</span>F05_02_ENG) <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>OccurencesContinent <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data<span class="sc">$</span>F05_01_ENG) <span class="sc">%&gt;%</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Continent in percentages</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>F05_01_PCT <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Percentage)) <span class="sc">%&gt;%</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentages =</span> <span class="fu">round</span>(Percentage, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Percentage)) <span class="sc">%&gt;%</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Continent_of_origin =</span> F05_01_ENG)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(F05_01_PCT, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-ea8679678513322bc27d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ea8679678513322bc27d">{"x":{"filter":"none","vertical":false,"data":[["Europe","Asia","North and Central America","South America","Australia and Oceania","Africa"],[1942,208,200,70,43,23],[78.12,8.369999999999999,8.050000000000001,2.82,1.73,0.93]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Continent_of_origin<\/th>\n      <th>Count<\/th>\n      <th>Percentages<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"name":"Continent_of_origin","targets":0},{"name":"Count","targets":1},{"name":"Percentages","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot numbers continent </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(F05_01_PCT, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Continent_of_origin, Percentages), <span class="at">y=</span>Percentages, <span class="at">fill=</span>Continent_of_origin)) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  <span class="co"># Flip coordinates for horizontal bars</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Continents of origin"</span>, <span class="at">y=</span><span class="st">"Percentages"</span>, <span class="at">title=</span><span class="st">"Percentages of Each Unique Continent of origin"</span>) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove the legend title</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="co"># Hide the legend as the colors are not necessary with labels</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># Center the plot title</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, Percentages)), <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="sc">-</span><span class="fl">0.5</span>), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.01</span>, <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># Add percentage labels</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">90</span>)  <span class="co"># Extend y-axis range</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-3-1.png" style="width:100.0%;height:100.0%"></p>
</div>
</div>
<p>We notice that a large part of the people surveyed were coming from Europe (approx. 78%), followed by people coming from Asia (approx. 8%), North and Central America (approx. 8%), South America (approx. 3%) Australia and Oceania (approx. 2%) and finally Africa (approx. 1%). Again, these results were concerning the whole canton.</p>
<p><strong>Global percentage of people coming in canton of Vaud per country of origin</strong></p>
<p>We have then decided to explore the distribution, in frequency and percentage, of the nationalities per continent. You will find here again a table and a graph, summarizing this information:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Countries in percentages </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>F05_02_PCT <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>((Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Percentage)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Country_of_origin =</span> F05_02_ENG)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(F05_02_PCT, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-23e832cb59d74c5d0ad2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-23e832cb59d74c5d0ad2">{"x":{"filter":"none","vertical":false,"data":[["Switzerland","France","United Kingdom","Germany","United States of America","Belgium","Spain","Netherlands","Canada","Italy","China","Brazil","Australia","Portugal","India","Poland","Singapore","Czechia","Malaysia","Taiwan","Sweden","Greece","Mexico","Thailand","Luxembourg","South Korea (ROK)","Philippines","Austria","Colombia","Hong Kong (CN)","Argentina","Chile","Ireland","Other","Lithuania","New Zealand","Romania","Lebanon","Morocco","Peru","Bulgaria","Denmark","Hungary","Israel","South Africa","Turkey","Ukraine","Finland","Indonesia","Iran","Kenya","Latvia","Mauritius","North Macedonia","Norway","Rwanda","Saudi Arabia","Serbia","Slovakia","Uruguay","Croatia","Liechtenstein","Malta","Monaco","Mongolia","Russia","Slovenia","U.A.E","Albania","Andorra","Armenia","Bolivia","Bosnia and Herzegovina","Cambodia","Cayman Islands","Costa Rica","Cyprus","Ecuador","Egypt","Ivory Coast","Japan","Jersey","Kosovo","Kuwait","Kyrgyzstan","Malawi","Maldives","Moldova","Montenegro","Nepal","New Caledonia","Oman","Pakistan","Palau","Panama","Qatar","Réunion","Tunisia","Uzbekistan","Venezuela"],[786,358,187,138,133,89,77,63,50,44,40,36,35,33,30,25,25,20,19,19,15,12,12,11,10,10,9,8,8,8,7,7,7,7,6,6,6,5,5,5,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[31.62,14.4,7.52,5.55,5.35,3.58,3.1,2.53,2.01,1.77,1.61,1.45,1.41,1.33,1.21,1.01,1.01,0.8,0.76,0.76,0.6,0.48,0.48,0.44,0.4,0.4,0.36,0.32,0.32,0.32,0.28,0.28,0.28,0.28,0.24,0.24,0.24,0.2,0.2,0.2,0.16,0.16,0.16,0.16,0.16,0.16,0.16,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.12,0.08,0.08,0.08,0.08,0.08,0.08,0.08,0.08,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Country_of_origin<\/th>\n      <th>Count<\/th>\n      <th>Percentage<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"name":"Country_of_origin","targets":0},{"name":"Count","targets":1},{"name":"Percentage","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">### F05_02_ENG </span><span class="al">###</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot with continents </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>F05_02_PCT <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG, F05_01_ENG) <span class="sc">%&gt;%</span>  <span class="co"># Group by both country and continent</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>((Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Percentage)) </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#concatenate all countries except " 7 best " </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>F05_02_PCT <span class="ot">&lt;-</span> F05_02_PCT <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(<span class="at">F05_01_ENG =</span> <span class="st">"Other Continents"</span>, <span class="at">F05_02_ENG =</span> <span class="st">"Other Countries"</span>, <span class="at">Count =</span> <span class="fu">sum</span>(F05_02_PCT<span class="sc">$</span>Count[<span class="dv">7</span><span class="sc">:</span><span class="dv">104</span>]), <span class="at">Percentage =</span> <span class="fu">sum</span>(F05_02_PCT<span class="sc">$</span>Percentage[<span class="dv">7</span><span class="sc">:</span><span class="dv">104</span>]))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#get rid of the rest of the rows</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>F05_02_PCT <span class="ot">&lt;-</span> F05_02_PCT[<span class="sc">-</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">104</span>),]</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(F05_02_PCT, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">F05_02_ENG</span><span class="st">`</span>, Percentage), <span class="at">y =</span> Percentage, <span class="at">fill =</span> <span class="st">`</span><span class="at">F05_01_ENG</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  <span class="co"># Make the plot horizontal</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">name =</span> <span class="st">"Continent"</span>) <span class="sc">+</span>  <span class="co"># Use a color palette for continents</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country of Origin"</span>, <span class="at">y =</span> <span class="st">"Percentages"</span>, <span class="at">title =</span> <span class="st">"Percentage of Responses by Country and Continent of origin"</span>) <span class="sc">+</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">9</span>), </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span>  <span class="co"># Adjust legend position</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, Percentage)), <span class="at">position=</span><span class="fu">position_stack</span>(<span class="at">vjust=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>For visibility purpose, we have decided to represent here in the graph the top 7 countries of the table, representing all above 3% of the nationalities found in the survey. We have then decided to group the remaining countries in the category “Other Countries”.</p>
<p>We notice that Switzerland is the nationality the most represented among all the visitor (approx. 31.5%). Therefore, there are a lot of Swiss citizens travelling in their own country for various purpose to the canton of Vaud. Also, we see again that the most represented nationalities are Europeans, such as France (approx. 14.5%), United Kingdom (appox. 7.5%), Germany (approx. 5.5%), Belgium (approx. 3.5%) and finally Spain (approx. 3%). The only other nationality coming from a other continent represented here is the United States of America (approx. 5.5%). Proximity could be for instance one of the main factor explaining these results.</p>
<p><strong>Per city, the percentage of each visitor’s country of origin, relative to the number of visitor of the city</strong></p>
<p>Then, In order to know more about the precise destination of the visitors, we have decided to gather by city the percentage of country of origin.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Counting the number of tourists by city and nationality</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>tourists_by_nationality <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_Code, F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the total number of tourists per city</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>total_tourists_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_Code) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalCount =</span> <span class="fu">sum</span>(Count), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining the counts back to the detailed breakdown and calculating the ratio</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>nationality_ratio_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(total_tourists_per_city, <span class="at">by =</span> <span class="st">"F105_Code"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> <span class="fu">round</span>((Count <span class="sc">/</span> TotalCount),<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(F105_Code, F05_02_ENG, Ratio) <span class="sc">%&gt;%</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">City =</span> F105_Code, <span class="at">Country_of_origin =</span> F05_02_ENG)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(nationality_ratio_per_city, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-baedc4b4c1e78f61fab8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-baedc4b4c1e78f61fab8">{"x":{"filter":"none","vertical":false,"data":[["Aigle","Aigle","Aigle","Aigle","Aigle","Aigle","Aubonne","Aubonne","Aubonne","Aubonne","Aubonne","Avenches","Bex","Bex","Bex","Bex","Bex","Bex","Blonay","Blonay","Blonay","Bourg-en-Lavaux","Bourg-en-Lavaux","Bourg-en-Lavaux","Bullet","Bussigny","Bussigny","Chardonne","Chavannes-de-Bogis","Chavannes-de-Bogis","Chavannes-de-Bogis","Chernex","Chernex","Chernex","Chernex","Chexbres","Chexbres","Chexbres","Chexbres","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Château-d'Oex","Commugny","Coppet","Coppet","Coppet","Coppet","Corsier-sur-Vevey","Corsier-sur-Vevey","Crissier","Cudrefin","Cudrefin","Cudrefin","Cully","Cully","Cully","Cully","Cully","Cully","Cully","Cully","Duillier","Echallens","Ecublens (VD)","Ecublens (VD)","Ecublens (VD)","Ecublens (VD)","Ecublens (VD)","Estavayer-le-Lac","Estavayer-le-Lac","Estavayer-le-Lac","Estavayer-le-Lac","Founex","Founex","Gilly","Gryon","Gryon","Gryon","Gryon","Gryon","Gryon","Gryon","Gryon","Gryon","L'Abbaye","L'Abbaye","L'Abbaye","L'Abbaye","L'Abbaye","La Praz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","La Tour-de-Peilz","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lausanne","Lavey-Morcles","Lavey-Morcles","Lavey-Morcles","Lavey-Morcles","Le Brassus","Le Brassus","Le Brassus","Le Chenit","Le Chenit","Le Chenit","Le Chenit","Le Chenit","Le Pont","Le Pont","Le Pont","Le Pont","Le Rocheray","Le Rocheray","Le Rocheray","Le Sentier","Le Sentier","Le Sentier","Le Sentier","Les Charbonnieres","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Diablerets","Les Rasses","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Leysin","Lucens","Lucens","Lucens","Lucens","Montagny-près-Yverdon","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Montreux","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Morges","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Nyon","Orbe","Orbe","Ormont-Dessous","Ormont-Dessous","Ormont-Dessus","Ormont-Dessus","Ormont-Dessus","Payerne","Payerne","Payerne","Payerne","Prangins","Prangins","Prangins","Prangins","Prangins","Renens","Rolle","Rolle","Rolle","Rolle","Rossinière","Rossinière","Rossinière","Rossinière","Rossinière","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Rougemont","Saint Croix","Saint Croix","Saint Croix","Saint Croix","Saint-Légier-La-Chiésaz","Saint-Légier-La-Chiésaz","Saint-Sulpice (VD)","St. Aubin","Valbroye","Vallorbe","Vallorbe","Vallorbe","Vallorbe","Vallorbe","Vallorbe","Vallorbe","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Vevey","Veytaux","Veytaux","Veytaux","Veytaux","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villars-sur-Ollon","Villeneuve (VD)","Villeneuve (VD)","Villeneuve (VD)","Villeneuve (VD)","Villeneuve (VD)","Villeneuve (VD)","Yens","Yens","Yens","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yverdon-les-Bains","Yvonand","Yvonand"],["Australia","France","Greece","Portugal","Serbia","Switzerland","Austria","China","France","Spain","Switzerland","Switzerland","Belgium","Finland","France","Malaysia","Switzerland","United States of America","France","Other","Switzerland","France","Italy","Switzerland","Switzerland","France","Italy","Switzerland","France","United Kingdom","United States of America","Brazil","Germany","Netherlands","Switzerland","France","Spain","Switzerland","United Kingdom","Belgium","Cambodia","Canada","China","France","Germany","Hong Kong (CN)","India","Indonesia","Ireland","Italy","Latvia","Luxembourg","Netherlands","New Zealand","Norway","Philippines","Portugal","Spain","Sweden","Switzerland","Taiwan","United Kingdom","United States of America","United Kingdom","Canada","France","Germany","Switzerland","Germany","United States of America","Malaysia","France","Iran","Switzerland","Canada","France","Germany","Italy","Sweden","Switzerland","United Kingdom","United States of America","United States of America","North Macedonia","Brazil","France","Portugal","Switzerland","United States of America","France","Greece","Spain","Switzerland","Australia","Belgium","France","Belgium","France","Luxembourg","Slovakia","Spain","Sweden","Switzerland","United Kingdom","United States of America","France","Germany","Switzerland","Taiwan","United Kingdom","Netherlands","Australia","Belgium","Brazil","France","Germany","Sweden","Switzerland","United Kingdom","Argentina","Australia","Austria","Belgium","Bolivia","Brazil","Bulgaria","Canada","Chile","China","Colombia","Czechia","Denmark","Ecuador","Egypt","France","Germany","Greece","Hong Kong (CN)","Hungary","India","Indonesia","Iran","Ireland","Israel","Italy","Ivory Coast","Japan","Kenya","Kyrgyzstan","Lebanon","Lithuania","Luxembourg","Malaysia","Maldives","Mauritius","Mexico","Mongolia","Morocco","Nepal","Netherlands","New Zealand","North Macedonia","Norway","Other","Pakistan","Palau","Peru","Philippines","Poland","Portugal","Qatar","Romania","Réunion","Saudi Arabia","Singapore","Slovenia","South Africa","South Korea (ROK)","Spain","Sweden","Switzerland","Taiwan","Thailand","Tunisia","Turkey","U.A.E","Ukraine","United Kingdom","United States of America","France","North Macedonia","Sweden","Switzerland","France","Spain","Switzerland","France","Germany","Spain","Switzerland","United Kingdom","France","Germany","Switzerland","United Kingdom","France","Germany","Switzerland","Belgium","France","Switzerland","United States of America","Switzerland","Australia","Belgium","Brazil","China","Denmark","France","Germany","Italy","Luxembourg","Netherlands","Peru","Poland","Portugal","Romania","Singapore","Spain","Sweden","Switzerland","United Kingdom","United States of America","Switzerland","Australia","Belgium","Brazil","Canada","Colombia","Croatia","Cyprus","Czechia","France","Germany","India","Ireland","Italy","Luxembourg","Netherlands","Peru","Poland","Portugal","Rwanda","Spain","Sweden","Switzerland","Taiwan","U.A.E","Ukraine","United Kingdom","United States of America","Canada","France","India","United States of America","Switzerland","Andorra","Australia","Austria","Belgium","Brazil","Bulgaria","Canada","Cayman Islands","Chile","China","Colombia","Czechia","Finland","France","Germany","Hong Kong (CN)","India","Ireland","Israel","Italy","Latvia","Lithuania","Malawi","Malaysia","Malta","Mexico","Moldova","Netherlands","Other","Panama","Philippines","Poland","Portugal","Romania","Saudi Arabia","Singapore","Slovakia","Slovenia","South Korea (ROK)","Spain","Sweden","Switzerland","Taiwan","Thailand","Ukraine","United Kingdom","United States of America","Uruguay","Albania","Argentina","Australia","Austria","Belgium","Canada","China","Croatia","Czechia","France","Germany","Hong Kong (CN)","Hungary","Ireland","Italy","Kuwait","Lebanon","Malta","Monaco","Netherlands","Other","Poland","Portugal","Russia","Saudi Arabia","Slovakia","Spain","Switzerland","Taiwan","United Kingdom","United States of America","Venezuela","Argentina","Armenia","Australia","Austria","Belgium","Brazil","Canada","Chile","China","Costa Rica","Denmark","Finland","France","Germany","Greece","India","Italy","Kenya","Kosovo","Latvia","Mexico","Montenegro","Netherlands","Philippines","Poland","Portugal","Romania","Serbia","South Africa","South Korea (ROK)","Spain","Switzerland","Taiwan","Thailand","United Kingdom","United States of America","Uruguay","Uzbekistan","Netherlands","Switzerland","Belgium","Switzerland","France","Switzerland","United Kingdom","France","Mauritius","Spain","Switzerland","Czechia","France","Liechtenstein","Spain","United Kingdom","Spain","France","Netherlands","Poland","United States of America","Belgium","France","Romania","Switzerland","United Kingdom","Canada","France","Germany","India","Indonesia","Italy","Monaco","Netherlands","Spain","Switzerland","United Kingdom","United States of America","Belgium","France","Sweden","Switzerland","New Caledonia","Switzerland","Mexico","Switzerland","Singapore","Czechia","France","Germany","Liechtenstein","Switzerland","Ukraine","United Kingdom","Argentina","Australia","Belgium","Canada","Colombia","France","Germany","Italy","Lebanon","Lithuania","Malaysia","Mongolia","Morocco","Norway","Philippines","Poland","Portugal","Singapore","South Korea (ROK)","Spain","Switzerland","United Kingdom","United States of America","China","Mexico","Taiwan","United States of America","Australia","Belgium","Brazil","China","France","Italy","Jersey","Luxembourg","Malaysia","Netherlands","Serbia","Sweden","Switzerland","United Kingdom","United States of America","Belgium","France","Germany","Switzerland","United Kingdom","Uruguay","France","Oman","United Kingdom","Argentina","Austria","Bosnia and Herzegovina","Canada","Colombia","Czechia","France","Germany","Lithuania","Netherlands","Spain","Switzerland","United States of America","France","Switzerland"],[0.091,0.182,0.091,0.091,0.091,0.455,0.2,0.2,0.2,0.2,0.2,1,0.154,0.077,0.154,0.077,0.462,0.077,0.286,0.143,0.571,0.25,0.25,0.5,1,0.5,0.5,1,0.6,0.2,0.2,0.25,0.25,0.25,0.25,0.25,0.167,0.417,0.167,0.039,0.006,0.006,0.006,0.171,0.066,0.011,0.006,0.006,0.011,0.017,0.006,0.011,0.039,0.006,0.006,0.006,0.011,0.017,0.006,0.387,0.006,0.133,0.028,1,0.25,0.25,0.25,0.25,0.5,0.5,1,0.333,0.333,0.333,0.059,0.059,0.176,0.059,0.059,0.471,0.059,0.059,1,1,0.125,0.25,0.125,0.375,0.125,0.143,0.07099999999999999,0.143,0.643,0.5,0.5,1,0.07099999999999999,0.214,0.07099999999999999,0.07099999999999999,0.07099999999999999,0.07099999999999999,0.143,0.214,0.07099999999999999,0.081,0.135,0.73,0.027,0.027,1,0.1,0.1,0.1,0.2,0.1,0.1,0.2,0.1,0.003,0.013,0.002,0.024,0.002,0.032,0.002,0.04,0.006,0.026,0.003,0.006,0.003,0.002,0.002,0.199,0.073,0.013,0.003,0.003,0.013,0.002,0.003,0.003,0.002,0.035,0.002,0.002,0.003,0.002,0.005,0.002,0.003,0.006,0.002,0.003,0.006,0.002,0.006,0.002,0.03,0.008,0.002,0.002,0.003,0.002,0.002,0.005,0.006,0.01,0.019,0.002,0.002,0.002,0.002,0.019,0.002,0.005,0.006,0.059,0.006,0.07199999999999999,0.008,0.005,0.002,0.006,0.002,0.002,0.075,0.08,0.167,0.167,0.167,0.5,0.2,0.2,0.6,0.128,0.077,0.026,0.718,0.051,0.114,0.08599999999999999,0.771,0.029,0.091,0.091,0.8179999999999999,0.067,0.133,0.733,0.067,1,0.025,0.041,0.008,0.008,0.008,0.099,0.041,0.008,0.017,0.025,0.008,0.008,0.017,0.008,0.017,0.017,0.008,0.438,0.14,0.058,1,0.005,0.168,0.01,0.01,0.005,0.005,0.005,0.015,0.089,0.04,0.005,0.005,0.01,0.005,0.054,0.005,0.005,0.015,0.015,0.02,0.005,0.421,0.005,0.005,0.005,0.05,0.02,0.4,0.2,0.2,0.2,1,0.004,0.037,0.004,0.011,0.03,0.011,0.034,0.004,0.004,0.045,0.004,0.026,0.004,0.094,0.049,0.011,0.049,0.004,0.011,0.011,0.004,0.007,0.004,0.037,0.004,0.015,0.004,0.022,0.011,0.004,0.007,0.026,0.019,0.004,0.004,0.03,0.004,0.004,0.015,0.007,0.007,0.101,0.022,0.022,0.004,0.064,0.097,0.004,0.006,0.011,0.006,0.006,0.017,0.017,0.011,0.006,0.017,0.105,0.08799999999999999,0.006,0.011,0.006,0.017,0.006,0.006,0.006,0.006,0.011,0.006,0.017,0.006,0.011,0.006,0.006,0.022,0.464,0.011,0.033,0.055,0.006,0.007,0.007,0.046,0.02,0.026,0.007,0.013,0.013,0.013,0.007,0.007,0.007,0.176,0.039,0.013,0.033,0.013,0.007,0.007,0.007,0.013,0.007,0.026,0.007,0.02,0.02,0.013,0.007,0.007,0.007,0.046,0.131,0.013,0.013,0.131,0.065,0.007,0.007,0.111,0.889,0.167,0.833,0.333,0.583,0.083,0.25,0.25,0.25,0.25,0.2,0.2,0.2,0.2,0.2,1,0.2,0.2,0.2,0.4,0.125,0.125,0.125,0.5,0.125,0.014,0.07199999999999999,0.08699999999999999,0.014,0.014,0.014,0.014,0.029,0.043,0.623,0.058,0.014,0.125,0.125,0.125,0.625,0.5,0.5,1,1,1,0.05,0.15,0.1,0.05,0.5,0.05,0.1,0.015,0.015,0.03,0.015,0.03,0.212,0.03,0.03,0.015,0.03,0.03,0.015,0.015,0.015,0.015,0.045,0.045,0.03,0.015,0.045,0.197,0.091,0.015,0.167,0.167,0.167,0.5,0.013,0.076,0.013,0.051,0.127,0.025,0.013,0.025,0.013,0.038,0.013,0.013,0.329,0.203,0.051,0.143,0.143,0.143,0.286,0.143,0.143,0.333,0.333,0.333,0.008,0.008,0.008,0.015,0.015,0.008,0.068,0.015,0.008,0.015,0.008,0.82,0.008,0.75,0.25]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>City<\/th>\n      <th>Country_of_origin<\/th>\n      <th>Ratio<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":2},{"name":"City","targets":0},{"name":"Country_of_origin","targets":1},{"name":"Ratio","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The percentage here was in fact a ratio representing the number of people from one particular nationality over the total number of visitors in each city. Unfortunately, as very few data has been collected in some cities, the ratio of visitor from one nationality over all the visitor surveyed can be really large (up to 1, in point of percentage). On the other hand, as data from some other city gathered a lot of answers, we observe that some country of origin (e.g.&nbsp;Austria in Lausanne) were only accounting for 0.2% of the total visitors.</p>
<p><strong>Ratio of each country of origin relatively to the number of tourist surveyed in each district</strong></p>
<p>In the same process, let’s now explore the country of origin ratio per district of tourism.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ratio of each nationality relatively to the number of tourist surveyed in each district F105_OrgCode</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tourists_by_nationality <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_OrgCode, F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the total number of tourists per city</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>total_tourists_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F105_OrgCode) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalCount =</span> <span class="fu">sum</span>(Count), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining the counts back to the detailed breakdown and calculating the ratio</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>nationality_ratio_per_city <span class="ot">&lt;-</span> tourists_by_nationality <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(total_tourists_per_city, <span class="at">by =</span> <span class="st">"F105_OrgCode"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> <span class="fu">round</span>((Count <span class="sc">/</span> TotalCount),<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(F105_OrgCode, F05_02_ENG, Ratio) <span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">District_tourism =</span> F105_OrgCode,<span class="at">Country_of_origin =</span> F05_02_ENG)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(nationality_ratio_per_city, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-0c8c7d66db5de844e002" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0c8c7d66db5de844e002">{"x":{"filter":"none","vertical":false,"data":[["Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Aigle-Leysin-Les Mosses","Avenches Tourisme","Echallens Région Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Estavayer-le-Lac/Payerne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Lausanne Tourisme","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Montreux Riviera","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Morges Région","Moudon Région Tourisme","Moudon Région Tourisme","Moudon Région Tourisme","Moudon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Nyon Région Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Pays d'Enhaut Tourisme","Vallée de Joux","Vallée de Joux","Vallée de Joux","Vallée de Joux","Vallée de Joux","Vallée de Joux","Vallée de Joux","Vallée de Joux","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Villars-Diablerets-Gryon-Bex","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région","Yverdon-les-Bains Région"],["Australia","Belgium","Brazil","Canada","Colombia","Croatia","Cyprus","Czechia","France","Germany","Greece","India","Ireland","Italy","Luxembourg","Netherlands","Peru","Poland","Portugal","Rwanda","Serbia","Spain","Sweden","Switzerland","Taiwan","U.A.E","Ukraine","United Kingdom","United States of America","Switzerland","North Macedonia","France","Greece","Iran","Mauritius","Singapore","Spain","Switzerland","Argentina","Australia","Austria","Belgium","Bolivia","Brazil","Bulgaria","Canada","Chile","China","Colombia","Czechia","Denmark","Ecuador","Egypt","France","Germany","Greece","Hong Kong (CN)","Hungary","India","Indonesia","Iran","Ireland","Israel","Italy","Ivory Coast","Japan","Kenya","Kyrgyzstan","Lebanon","Lithuania","Luxembourg","Malaysia","Maldives","Mauritius","Mexico","Mongolia","Morocco","Nepal","Netherlands","New Zealand","North Macedonia","Norway","Other","Pakistan","Palau","Peru","Philippines","Poland","Portugal","Qatar","Romania","Réunion","Saudi Arabia","Singapore","Slovenia","South Africa","South Korea (ROK)","Spain","Sweden","Switzerland","Taiwan","Thailand","Tunisia","Turkey","U.A.E","Ukraine","United Kingdom","United States of America","Andorra","Argentina","Australia","Austria","Belgium","Brazil","Bulgaria","Canada","Cayman Islands","Chile","China","Colombia","Czechia","Finland","France","Germany","Hong Kong (CN)","India","Ireland","Israel","Italy","Latvia","Lebanon","Lithuania","Malawi","Malaysia","Malta","Mexico","Moldova","Mongolia","Morocco","Netherlands","New Caledonia","Norway","Other","Panama","Philippines","Poland","Portugal","Romania","Saudi Arabia","Singapore","Slovakia","Slovenia","South Korea (ROK)","Spain","Sweden","Switzerland","Taiwan","Thailand","Ukraine","United Kingdom","United States of America","Uruguay","Albania","Argentina","Australia","Austria","Belgium","Canada","China","Croatia","Czechia","France","Germany","Hong Kong (CN)","Hungary","Ireland","Italy","Kuwait","Lebanon","Malta","Monaco","Netherlands","Oman","Other","Poland","Portugal","Russia","Saudi Arabia","Slovakia","Spain","Switzerland","Taiwan","United Kingdom","United States of America","Venezuela","Canada","France","India","United States of America","Argentina","Armenia","Australia","Austria","Belgium","Brazil","Canada","Chile","China","Costa Rica","Czechia","Denmark","Finland","France","Germany","Greece","India","Italy","Kenya","Kosovo","Latvia","Liechtenstein","Mexico","Montenegro","Netherlands","Philippines","Poland","Portugal","Romania","Serbia","South Africa","South Korea (ROK)","Spain","Switzerland","Taiwan","Thailand","United Kingdom","United States of America","Uruguay","Uzbekistan","Belgium","Cambodia","Canada","China","France","Germany","Hong Kong (CN)","India","Indonesia","Ireland","Italy","Latvia","Luxembourg","Monaco","Netherlands","New Zealand","Norway","Philippines","Portugal","Romania","Spain","Sweden","Switzerland","Taiwan","United Kingdom","United States of America","Belgium","France","Germany","Spain","Switzerland","Taiwan","United Kingdom","United States of America","Australia","Belgium","Brazil","China","Denmark","Finland","France","Germany","Italy","Jersey","Luxembourg","Malaysia","Netherlands","North Macedonia","Peru","Poland","Portugal","Romania","Serbia","Singapore","Slovakia","Spain","Sweden","Switzerland","United Kingdom","United States of America","Argentina","Austria","Belgium","Bosnia and Herzegovina","Canada","Colombia","Czechia","France","Germany","Liechtenstein","Lithuania","Netherlands","Spain","Sweden","Switzerland","Ukraine","United Kingdom","United States of America"],[0.008999999999999999,0.16,0.008999999999999999,0.008999999999999999,0.005,0.005,0.005,0.014,0.091,0.037,0.005,0.005,0.005,0.008999999999999999,0.005,0.05,0.005,0.005,0.018,0.014,0.005,0.018,0.005,0.434,0.005,0.005,0.005,0.046,0.018,1,1,0.174,0.043,0.043,0.043,0.043,0.13,0.522,0.003,0.013,0.002,0.023,0.002,0.033,0.002,0.039,0.006,0.025,0.003,0.006,0.003,0.002,0.002,0.2,0.07199999999999999,0.013,0.003,0.003,0.013,0.002,0.003,0.003,0.002,0.036,0.002,0.002,0.003,0.002,0.005,0.002,0.003,0.008,0.002,0.003,0.008,0.002,0.006,0.002,0.03,0.008,0.002,0.002,0.003,0.002,0.002,0.005,0.006,0.008999999999999999,0.02,0.002,0.002,0.002,0.002,0.019,0.002,0.005,0.006,0.059,0.006,0.075,0.008,0.005,0.002,0.006,0.002,0.002,0.073,0.08,0.002,0.002,0.03,0.002,0.017,0.025,0.007,0.027,0.002,0.002,0.032,0.007,0.017,0.002,0.121,0.054,0.007,0.032,0.002,0.007,0.017,0.002,0.002,0.01,0.002,0.03,0.002,0.012,0.002,0.002,0.002,0.017,0.002,0.002,0.01,0.002,0.007,0.025,0.02,0.002,0.002,0.025,0.002,0.002,0.012,0.017,0.01,0.163,0.017,0.015,0.002,0.06900000000000001,0.079,0.005,0.005,0.011,0.005,0.011,0.016,0.016,0.016,0.005,0.016,0.111,0.08500000000000001,0.005,0.011,0.005,0.016,0.005,0.005,0.005,0.005,0.011,0.005,0.005,0.016,0.005,0.011,0.005,0.005,0.026,0.45,0.011,0.037,0.053,0.005,0.4,0.2,0.2,0.2,0.006,0.006,0.045,0.017,0.028,0.006,0.017,0.011,0.011,0.006,0.006,0.006,0.006,0.192,0.04,0.011,0.028,0.011,0.006,0.006,0.006,0.006,0.011,0.006,0.028,0.006,0.023,0.017,0.011,0.006,0.006,0.006,0.045,0.119,0.011,0.011,0.13,0.079,0.006,0.006,0.031,0.004,0.008,0.004,0.143,0.07000000000000001,0.008,0.008,0.008,0.008,0.016,0.004,0.008,0.004,0.035,0.004,0.004,0.004,0.008,0.004,0.023,0.004,0.453,0.004,0.112,0.023,0.007,0.112,0.08400000000000001,0.014,0.741,0.007,0.028,0.007,0.016,0.057,0.008,0.02,0.004,0.004,0.131,0.02,0.012,0.004,0.02,0.008,0.024,0.004,0.004,0.004,0.008,0.004,0.004,0.008,0.004,0.012,0.016,0.396,0.151,0.053,0.006,0.006,0.006,0.006,0.011,0.011,0.011,0.089,0.022,0.006,0.006,0.022,0.006,0.006,0.765,0.006,0.011,0.006]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>District_tourism<\/th>\n      <th>Country_of_origin<\/th>\n      <th>Ratio<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":2},{"name":"District_tourism","targets":0},{"name":"Country_of_origin","targets":1},{"name":"Ratio","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Again, the low number of data available in our data don’t allow us to get really satisfying results for every city surveyed.</p>
<p>As Swiss citizens accounted for more than 30% of the visitors surveyed, we have decided to know more about the percentages of people coming from Switzerland, visiting Switzerland. Therefore, here is the distribution of visitors per canton of origin.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Séparation cantons suisse-allemands</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># Swiss german column</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># unique(data[data$F05_02 == "Schweiz", ]$F05_03)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a> <span class="co"># Seratation german cantons (subjective)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a> swiss_german_cantons <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Luzern"</span>, <span class="st">"Schwyz"</span>, <span class="st">"Bern"</span>, <span class="st">"Neuenburg"</span>, <span class="st">"Aargau"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Zürich"</span>, <span class="st">"Basel-Stadt"</span>, <span class="st">"Basel-Landschaft"</span>, <span class="st">"Obwalden"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Appenzell Innerrhoden"</span>, <span class="st">"Schaffhausen"</span>, <span class="st">"Thurgau"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"St. Gallen"</span>, <span class="st">"Solothurn"</span>, <span class="st">"Uri"</span>, <span class="st">"Zug"</span>, <span class="st">"Nidwalden"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Appenzell Ausserrhoden"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a> <span class="co"># Binary column for swiss germans</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a> data<span class="sc">$</span>swiss_german <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>F05_02 <span class="sc">==</span> <span class="st">"Schweiz"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>F05_03 <span class="sc">%in%</span> swiss_german_cantons, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a> <span class="co"># count ratio from each german canton over the data</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a> Inside_Switzerland <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(F05_02_ENG, F05_03, swiss_german) <span class="sc">%&gt;%</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(F05_02_ENG <span class="sc">==</span> <span class="st">"Switzerland"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_03) <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>((Count<span class="sc">/</span><span class="fu">sum</span>(Count)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#round(Percentage, 2) %&gt;%</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Canton =</span> F05_03)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a> <span class="fu">datatable</span>(Inside_Switzerland, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-3851ddafcae6f84c24c3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3851ddafcae6f84c24c3">{"x":{"filter":"none","vertical":false,"data":[["Aargau","Appenzell Ausserrhoden","Appenzell Innerrhoden ","Basel-Landschaft","Basel-Stadt","Bern","Freiburg","Genf","Graubünden","Jura","Luzern","Neuenburg","Nidwalden","Obwalden","Schaffhausen","Schwyz","Solothurn","St. Gallen","Tessin","Thurgau","Uri","Waadt","Wallis","Zug","Zürich"],[51,1,2,22,17,127,36,58,6,9,47,21,3,5,5,10,14,23,9,21,6,155,28,16,94],[6.5,0.1,0.3,2.8,2.2,16.2,4.6,7.4,0.8,1.1,6,2.7,0.4,0.6,0.6,1.3,1.8,2.9,1.1,2.7,0.8,19.7,3.6,2,12]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Canton<\/th>\n      <th>Count<\/th>\n      <th>Percentage<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"name":"Canton","targets":0},{"name":"Count","targets":1},{"name":"Percentage","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot numbers continent </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Inside_Switzerland, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Canton, Percentage), <span class="at">y=</span>Percentage, <span class="at">fill=</span>Canton)) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  <span class="co"># Flip coordinates for horizontal bars</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Cantons"</span>, <span class="at">y=</span><span class="st">"Percentage"</span>, <span class="at">title=</span><span class="st">"Distribution among swiss visitors"</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove the legend title</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="co"># Hide the legend as the colors are not necessary with labels</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># Center the plot title</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, Percentage)), <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="sc">-</span><span class="fl">0.5</span>), <span class="at">vjust=</span><span class="fl">0.3</span>, <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># Add percentage labels</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">22</span>)  <span class="co"># Extend y-axis range</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `position_dodge()` requires non-overlapping x intervals.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>As we can see on this table, the biggest part of the Swiss visitors surveyed in this study are people from Vaud (approx. 20%), Bern (approx. 16%) and Zurich (approx. 12%).</p>
<p>Now among the swiss german cantons, let’s explore the distribution of the canton</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now how much percentage do swiss germans represent in this</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Swiss_germans_percentage <span class="ot">&lt;-</span> Inside_Switzerland <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Canton <span class="sc">%in%</span> swiss_german_cantons) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>((Count<span class="sc">/</span><span class="fu">sum</span>(Count)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(Swiss_germans_percentage$Percentage)</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(Swiss_germans_percentage, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">class =</span> <span class="st">"hover"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-7ff7a2f061a1310399ad" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7ff7a2f061a1310399ad">{"x":{"filter":"none","vertical":false,"data":[["Aargau","Appenzell Ausserrhoden","Basel-Landschaft","Basel-Stadt","Bern","Luzern","Neuenburg","Nidwalden","Obwalden","Schaffhausen","Schwyz","Solothurn","St. Gallen","Thurgau","Uri","Zug","Zürich"],[51,1,22,17,127,47,21,3,5,5,10,14,23,21,6,16,94],[10.6,0.2,4.6,3.5,26.3,9.699999999999999,4.3,0.6,1,1,2.1,2.9,4.8,4.3,1.2,3.3,19.5]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Canton<\/th>\n      <th>Count<\/th>\n      <th>Percentage<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"name":"Canton","targets":0},{"name":"Count","targets":1},{"name":"Percentage","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts for Swiss-German cantons and others</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>swiss_canton_summary <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(swiss_german) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total =</span> <span class="fu">sum</span>(Count),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Percentage =</span> (Count <span class="sc">/</span> Total) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="fu">ifelse</span>(swiss_german <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Swiss German Cantons"</span>, <span class="st">"Other Cantons"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Type, Count, Percentage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Bern, Zurich and Aargau are the top 3 cantons represented among all swiss german cantons (with in approx. 26.5%, 19.5% and 10.5% in the order)</p>
<p>Now, for interpretability and visualisation, let’s see the proportion of swiss german people over the rest of the swiss citizens surveyed:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(swiss_canton_summary, <span class="fu">aes</span>(<span class="at">x =</span> Type, <span class="at">y =</span> Percentage, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>() <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">"%.2f%%"</span>, Percentage)), <span class="at">position=</span><span class="fu">position_stack</span>(<span class="at">vjust=</span><span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percentage of Swiss German Cantons vs Other Cantons"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Canton Type"</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage"</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">90</span>)  <span class="co"># Extend y-axis range</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Over all the swiss citizen, we can see that approx. 20% of them are coming from the swiss german part.</p>
</section>
</section>
<section id="analysis" class="level1">
<h1>Analysis</h1>
<p><strong>Plot of the total number of days spent in Vaud per month of the year</strong></p>
<p>Now let’s explore the number of day spend per month of the year in the canton of Vaud</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">### F12 &amp; F13 </span><span class="al">###</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Are we more interested in knowing when they came for holidays or how long?</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#duration per month </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to date format first</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_column =</span> <span class="fu">dmy</span>(F12),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If you want the month names instead</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">month_name_column =</span> <span class="fu">month</span>(date_column, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>) <span class="co"># Set abbr=FALSE for full month names</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#order</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>desired_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Serial2"</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_01"</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_01_ENG"</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_02"</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_02_ENG"</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_03"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F05_04"</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F12"</span>,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F13"</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"month_name_column"</span>,</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"hFerienDauer"</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>remaining_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(data), desired_order)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>new_order <span class="ot">&lt;-</span> <span class="fu">c</span>(desired_order, remaining_columns)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, new_order]</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co"># nb of days per month </span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>nb_days_per_month <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(F12, F13, month_name_column, hFerienDauer) <span class="sc">%&gt;%</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month_name_column) <span class="sc">%&gt;%</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_hFerienDauer =</span> <span class="fu">sum</span>(hFerienDauer, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>nb_days_per_month <span class="ot">&lt;-</span> nb_days_per_month <span class="sc">%&gt;%</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    month_name_column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"December"</span>, <span class="st">"January"</span>, <span class="st">"February"</span>) <span class="sc">~</span> <span class="st">"Winter"</span>,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    month_name_column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>) <span class="sc">~</span> <span class="st">"Spring"</span>,</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    month_name_column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"June"</span>, <span class="st">"July"</span>, <span class="st">"August"</span>) <span class="sc">~</span> <span class="st">"Summer"</span>,</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    month_name_column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"September"</span>, <span class="st">"October"</span>, <span class="st">"November"</span>) <span class="sc">~</span> <span class="st">"Fall"</span>,</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> <span class="co"># for any month names not matched or NA values</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nb_days_per_month, <span class="fu">aes</span>(<span class="at">x =</span> month_name_column, <span class="at">y =</span> total_hFerienDauer, <span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Winter"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Spring"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Summer"</span> <span class="ot">=</span> <span class="st">"purple"</span>, <span class="st">"Fall"</span> <span class="ot">=</span> <span class="st">"orange"</span>)) <span class="sc">+</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Months"</span>, <span class="at">y =</span> <span class="st">"Sum Holiday Durations"</span>, <span class="at">title =</span> <span class="st">"Total Holiday Duration by Month"</span>, <span class="at">fill =</span> <span class="st">"Season"</span>) <span class="sc">+</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We clearly see two major moment of the year were there is a rise in the number of days spent in Vaud: March and July.</p>
<p>Now let’s explore the percentage of trip category per continent. In the survey, the visitors were asked the type of trip they were having. Therefore, you will find here the graph of the distribution of the type of trip for each continent. The choice was made among 4 possibilities that are explained in the legend of the graph.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(trip_percentages, <span class="fu">aes</span>(<span class="at">x =</span> F05_01_ENG, <span class="at">y =</span> Percentages, <span class="at">fill =</span> F16_ENG)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Percentages"</span>, <span class="at">fill =</span> <span class="st">"Type of Trip"</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Stacked Bar Plot of Type of Trip by Country"</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_colors) <span class="sc">+</span> <span class="co"># Use your defined colors here</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Percentages), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">0</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">#legend.box = "vertical",</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)) <span class="sc">+</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">title =</span> <span class="st">"Options"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-14-1.png" style="width:100.0%;height:100.0%"></p>
</div>
</div>
<p>In general, we notice that most of the visitors coming from continent far away from Switzerland are coming in Switzerland for serveral nightstays during their trip in Europe. On another hand, living closer, are staying most of the time for one overnight stay in Switzerland. This is probably due to the large quantity of visitors surveyed coming from Switzerland but from other cantons or visitors coming from adjacent countries such as Germany in France, all these visitors accounting for a total of approx. 50% of the people surveyed.</p>
<p><strong>Global frenquency of nightstays in Switzerland</strong></p>
<p>Here are the distribution of the frequencies of the number of night spent during a trip in Switzerland.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">### F20 </span><span class="al">###</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Careful here: some people have 0 nightstay and only passed by switzerland for a day. </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># but answered the question 16, asking about the number of nights.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># also when f16 answered and F20 blanc ---&gt; change NAs by 1 </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>data_NAs <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F20 =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(F20), <span class="dv">1</span>, F20))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>F20_freq <span class="ot">&lt;-</span> data_NAs <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F20) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Count)) <span class="co"># Optional: arrange in descending order of frequency</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(F20_freq, <span class="fu">aes</span>(<span class="at">x =</span> F20, <span class="at">y =</span> Count, <span class="at">fill =</span> F20)) <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of nights"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>, <span class="at">title =</span> <span class="st">"Frequency of the number of nights in Vaud"</span>) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>), <span class="co"># Improve readability of x-axis labels</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># Hide the legend if not needed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As the question asked to the visitor was the number of night spent in Switzerland, it is difficult to know how many nights were spent in the Canton of Vaud. Therefore, we have decided here to take into account in our analysis the global number of night in the country. In addition, as most of our data contained NAs because of the structure of the survey (according to the answer of the question F16, some people could not answer question F20, therefore their answer was reported as a NA). Thus, we have decided to count the NAs as 1 overnight stay, as it is not possible to know if they only stayed in Vaud for 1 day without staying overnight.</p>
<p>We can therefore see that most of the visitors only spend in general 1 night in the canton, and few people in comparison are staying more than a week.</p>
<p>Now let’s explore the percentage of the number of days spent in Switzerland over the whole visitors’ trip.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">### F21 </span><span class="al">###</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#consider NA as 0 here. </span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># if F20 and F21 not NAs --&gt; take percentage of nightstays in Switzerland compared to the total length of the trip</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column with the percentage of night stays in Switzerland over the total trip night stays</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage_Night_Stays_Switzerland =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(F20) <span class="sc">|</span> <span class="fu">is.na</span>(F21), <span class="cn">NA</span>, (F20 <span class="sc">/</span> F21) <span class="sc">*</span> <span class="dv">100</span>))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>ratio_nightstays_CH_EU <span class="ot">&lt;-</span> data2 <span class="sc">%&gt;%</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(F20,F21, Percentage_Night_Stays_Switzerland) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>()</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the distribution histogram</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ratio_nightstays_CH_EU, <span class="fu">aes</span>(<span class="at">x =</span> Percentage_Night_Stays_Switzerland)) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of the percentage of nightstays in Vaud over the whole trip"</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Percentage Night Stays"</span>,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As this graph shows, we notice that over the whole trip, most of the people will stay around 20% of their trip in Switzerland.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">### F30 </span><span class="al">###</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>F30_Q <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">count</span>(F30_ENG, <span class="at">name =</span> <span class="st">"Total"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>F30_Q<span class="sc">$</span>percentage <span class="ot">&lt;-</span> <span class="fu">with</span>(F30_Q, Total <span class="sc">/</span> <span class="fu">sum</span>(Total) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(F30_Q, <span class="fu">aes</span>(<span class="at">x =</span> F30_ENG, <span class="at">y =</span> Total, <span class="at">label =</span> <span class="fu">paste</span>(percentage, <span class="st">"%"</span>))) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Q30: Have you booked a package tour?"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Answers"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now let’s explore the distribution of the arrivals per nationality over the year:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Deeper reasoning </span><span class="al">###</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Where are coming from the people, per month</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize data: count arrivals per month and country</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>monthly_arrivals <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month_name_column, F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(month_name_column, F05_02_ENG) <span class="co"># This will ensure the data is ordered, which might help in visualization</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># total per country</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>per_country <span class="ot">&lt;-</span> monthly_arrivals <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(F05_02_ENG, Count) <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(Count)) <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Count))</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#left join </span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">left_join</span>(monthly_arrivals, per_country, <span class="at">by =</span> <span class="st">"F05_02_ENG"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(result, <span class="fu">aes</span>(<span class="at">x =</span> month_name_column, <span class="at">y =</span> <span class="st">`</span><span class="at">F05_02_ENG</span><span class="st">`</span>, <span class="at">size =</span> <span class="fu">log</span>(Count<span class="sc">/</span>total))) <span class="sc">+</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> <span class="co"># Using alpha for better visibility if points overlap</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">10</span>)) <span class="sc">+</span>  <span class="co"># Adjust range as needed</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly Arrivals in Switzerland by Country of Origin"</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Country of Origin"</span>,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"Number of Arrivals"</span>) <span class="sc">+</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On this graph, we notice that the size of the dots, representing the monthly number of arrivals of a nationality over the total number of arrival of this particular nationality, yearly, are variating a lot according to the nationality. Unfortunately, due to the low number of data surveyed, some countries are only represented once over the whole year.</p>
<section id="partie-lodrik" class="level2">
<h2 class="anchored" data-anchor-id="partie-lodrik">Partie Lodrik</h2>
<blockquote class="blockquote">
<p>Where did they stay? (For example: yes, they went to Montreux, but what type of accommodation, what price?</p>
</blockquote>
<section id="most-popular-destinations-in-the-canton-vaud" class="level3">
<h3 class="anchored" data-anchor-id="most-popular-destinations-in-the-canton-vaud">Most popular destinations in the canton Vaud</h3>
<p>Let’s now dive into the subject of the location of their stay. First, let’s have a look at the most popular locations in the canton Vaud. Given the architecture of the study this gives us the city where most people answer the survey.</p>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ec79c87c48af4219d224" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ec79c87c48af4219d224">{"x":{"visdat":{"51f020671084":["function () ","plotlyVisDat"]},"cur_data":"51f020671084","attrs":{"51f020671084":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (City)","xaxis":{"domain":[0,1],"automargin":true,"title":"City","showgrid":false,"zeroline":false,"tickangle":45,"type":"category","categoryorder":"array","categoryarray":["Lausanne","Other Cities","Montreux","Leysin","Château-d'Oex","Morges","Nyon","Yverdon-les-Bains","Les Diablerets","Villars-sur-Ollon","Rougemont","Vevey"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false,"tickformat":",.0%"},"hovermode":"x","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Château-d'Oex","Lausanne","Les Diablerets","Leysin","Montreux","Morges","Nyon","Rougemont","Vevey","Villars-sur-Ollon","Yverdon-les-Bains","Other Cities"],"y":[0.072807723250201128,0.25221238938053098,0.048672566371681415,0.081255028157683026,0.10740144810941271,0.072807723250201128,0.06154465004022526,0.027755430410297668,0.026548672566371681,0.031777956556717619,0.053499597747385358,0.1637168141592921],"text":["","","","","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text"],"hovertext":["City name:  Château-d'Oex <br>Number of people visiting this city:  181 / 2486 <br>Proportion of people visiting this city:  7.28%","City name:  Lausanne <br>Number of people visiting this city:  627 / 2486 <br>Proportion of people visiting this city:  25.22%","City name:  Les Diablerets <br>Number of people visiting this city:  121 / 2486 <br>Proportion of people visiting this city:  4.87%","City name:  Leysin <br>Number of people visiting this city:  202 / 2486 <br>Proportion of people visiting this city:  8.13%","City name:  Montreux <br>Number of people visiting this city:  267 / 2486 <br>Proportion of people visiting this city:  10.74%","City name:  Morges <br>Number of people visiting this city:  181 / 2486 <br>Proportion of people visiting this city:  7.28%","City name:  Nyon <br>Number of people visiting this city:  153 / 2486 <br>Proportion of people visiting this city:  6.15%","City name:  Rougemont <br>Number of people visiting this city:  69 / 2486 <br>Proportion of people visiting this city:  2.78%","City name:  Vevey <br>Number of people visiting this city:  66 / 2486 <br>Proportion of people visiting this city:  2.65%","City name:  Villars-sur-Ollon <br>Number of people visiting this city:  79 / 2486 <br>Proportion of people visiting this city:  3.18%","City name:  Yverdon-les-Bains <br>Number of people visiting this city:  133 / 2486 <br>Proportion of people visiting this city:  5.35%","City name: Other Cities <br>Number of people visiting these cities:  407 / 2486 <br>Proportion of people visiting these cities:  16.37%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>From this plot, we can see that the most pupular city in the canton of Vaud is Lausanne. Let’s now have a look at the type of accommodation where the visitor stayed in the canton of Vaud. We took the liberty to remove the 46 observation where the type of accommodation was not specified. We can now concentrate more our attention on the district where the people stayed.</p>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9ad3257e62700fb5f745" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9ad3257e62700fb5f745">{"x":{"visdat":{"51f06d5f918f":["function () ","plotlyVisDat"]},"cur_data":"51f06d5f918f","attrs":{"51f06d5f918f":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Destinations (District)","xaxis":{"domain":[0,1],"automargin":true,"title":"District","showgrid":false,"zeroline":false,"type":"category","categoryorder":"array","categoryarray":["Lausanne","Riviera-Pays-d'Enhaut","Aigle","Jura-Nord vaudois","Morges","Nyon","Lavaux-Oron","Broye-Vully","Ouest lausannois","Gros-de-Vaud"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Proportion","showgrid":true,"zeroline":false,"tickformat":",.0%"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Aigle","Broye-Vully","Gros-de-Vaud","Jura-Nord vaudois","Lausanne","Lavaux-Oron","Morges","Nyon","Ouest lausannois","Riviera-Pays-d'Enhaut"],"y":[0.18946098149637972,0.012067578439259855,0.00040225261464199515,0.12952534191472245,0.25221238938053098,0.013274336283185841,0.076025744167337081,0.071198712791633145,0.0052292839903459376,0.25060337892196299],"text":["","","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text","text"],"hovertext":["District name:  Aigle <br>Number of people visiting this district:  471 / 2486 <br>Proportion of people visiting this district:  18.95%","District name:  Broye-Vully <br>Number of people visiting this district:  30 / 2486 <br>Proportion of people visiting this district:  1.21%","District name:  Gros-de-Vaud <br>Number of people visiting this district:  1 / 2486 <br>Proportion of people visiting this district:  0.04%","District name:  Jura-Nord vaudois <br>Number of people visiting this district:  322 / 2486 <br>Proportion of people visiting this district:  12.95%","District name:  Lausanne <br>Number of people visiting this district:  627 / 2486 <br>Proportion of people visiting this district:  25.22%","District name:  Lavaux-Oron <br>Number of people visiting this district:  33 / 2486 <br>Proportion of people visiting this district:  1.33%","District name:  Morges <br>Number of people visiting this district:  189 / 2486 <br>Proportion of people visiting this district:  7.60%","District name:  Nyon <br>Number of people visiting this district:  177 / 2486 <br>Proportion of people visiting this district:  7.12%","District name:  Ouest lausannois <br>Number of people visiting this district:  13 / 2486 <br>Proportion of people visiting this district:  0.52%","District name:  Riviera-Pays-d'Enhaut <br>Number of people visiting this district:  623 / 2486 <br>Proportion of people visiting this district:  25.06%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As we can see, out of the 67 city surveyed in the 10 district, the most popular district is Lausanne. This is not really suprising because of the way the data was collected. More people were surveyed in these city/districts than other smaller one. It is still interesting to have a look to keep this in mind.</p>
</section>
<section id="type-of-accommodation" class="level3">
<h3 class="anchored" data-anchor-id="type-of-accommodation">Type of Accommodation</h3>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-656280415a25c5da4535" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-656280415a25c5da4535">{"x":{"visdat":{"51f049df6df5":["function () ","plotlyVisDat"]},"cur_data":"51f049df6df5","attrs":{"51f049df6df5":{"y":{},"x":{},"text":"","hoverinfo":"text","hovertext":{},"textposition":"auto","orientation":"h","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most Popular Accommodation Types","xaxis":{"domain":[0,1],"automargin":true,"title":"","side":"top","tickformat":",.0%"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Type of Accommodation","type":"category","categoryorder":"array","categoryarray":["Agritourism (overnight stay on a farm)","Mountain hut / SAC","Group accommodation","Youth Hostel / Hostel","Bed & Breakfast","Serviced Apartments / Chalets / Villas (service during stay)","Other","Campsite","Rented apartment / house","Free apartment/house (own or from friends / relatives etc.)","Hotel / Spa House"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"y":["Agritourism (overnight stay on a farm)","Mountain hut / SAC","Group accommodation","Youth Hostel / Hostel","Bed & Breakfast","Serviced Apartments / Chalets / Villas (service during stay)","Other","Campsite","Rented apartment / house","Free apartment/house (own or from friends / relatives etc.)","Hotel / Spa House"],"x":[0.0020491803278688526,0.0053278688524590161,0.013114754098360656,0.016393442622950821,0.028688524590163935,0.036475409836065571,0.11680327868852459,0.12008196721311476,0.14795081967213114,0.19467213114754098,0.31844262295081965],"text":["","","","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text"],"hovertext":["Accommodation type:  Agritourism (overnight stay on a farm) <br>Number of people staying in this type of accommodation:  5 / 2440 <br>Proportion of people staying in this type of accommodation:  0.20%","Accommodation type:  Mountain hut / SAC <br>Number of people staying in this type of accommodation:  13 / 2440 <br>Proportion of people staying in this type of accommodation:  0.53%","Accommodation type:  Group accommodation <br>Number of people staying in this type of accommodation:  32 / 2440 <br>Proportion of people staying in this type of accommodation:  1.31%","Accommodation type:  Youth Hostel / Hostel <br>Number of people staying in this type of accommodation:  40 / 2440 <br>Proportion of people staying in this type of accommodation:  1.64%","Accommodation type:  Bed & Breakfast <br>Number of people staying in this type of accommodation:  70 / 2440 <br>Proportion of people staying in this type of accommodation:  2.87%","Accommodation type:  Serviced Apartments / Chalets / Villas (service during stay) <br>Number of people staying in this type of accommodation:  89 / 2440 <br>Proportion of people staying in this type of accommodation:  3.65%","Accommodation type:  Other <br>Number of people staying in this type of accommodation:  285 / 2440 <br>Proportion of people staying in this type of accommodation:  11.68%","Accommodation type:  Campsite <br>Number of people staying in this type of accommodation:  293 / 2440 <br>Proportion of people staying in this type of accommodation:  12.01%","Accommodation type:  Rented apartment / house <br>Number of people staying in this type of accommodation:  361 / 2440 <br>Proportion of people staying in this type of accommodation:  14.80%","Accommodation type:  Free apartment/house (own or from friends / relatives etc.) <br>Number of people staying in this type of accommodation:  475 / 2440 <br>Proportion of people staying in this type of accommodation:  19.47%","Accommodation type:  Hotel / Spa House <br>Number of people staying in this type of accommodation:  777 / 2440 <br>Proportion of people staying in this type of accommodation:  31.84%"],"textposition":["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],"orientation":"h","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As we can see, the most popular type of accommodation in the canton of Vaud is Hotel/SPA House. It is interesting to note the proportion of people staying in Campsite. We can see below on the word cloud the most popular other type of accommodation.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/wordcloud-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="hotels-stars" class="level3">
<h3 class="anchored" data-anchor-id="hotels-stars">Hotels Stars</h3>
<p>Now, let’s have a look at the hotel standing of the places where the people stayed. This will highlight the quality of the stay per district.</p>
<section id="average-stars-per-district" class="level4">
<h4 class="anchored" data-anchor-id="average-stars-per-district">Average Stars per District</h4>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8db84139831b6dc94be7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8db84139831b6dc94be7">{"x":{"visdat":{"51f073690704":["function () ","plotlyVisDat"]},"cur_data":"51f073690704","attrs":{"51f073690704":{"x":{},"y":{},"text":"","hoverinfo":"text","hovertext":{},"name":"Average Stars","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Average Stars per District","xaxis":{"domain":[0,1],"automargin":true,"title":"District","type":"category","categoryorder":"array","categoryarray":["Ouest lausannois","Riviera-Pays-d'Enhaut","Nyon","Morges","Lausanne","Aigle","Jura-Nord vaudois","Broye-Vully","Lavaux-Oron","Gros-de-Vaud"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Stars"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"modeBarButtonsToRemove":["pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleSpikelines","zoom"]},"data":[{"x":["Ouest lausannois","Riviera-Pays-d'Enhaut","Nyon","Morges","Lausanne","Aigle","Jura-Nord vaudois","Broye-Vully","Lavaux-Oron"],"y":[4,3.6600000000000001,3.5600000000000001,3.54,3.52,3.3900000000000001,3.3500000000000001,3.3300000000000001,3.2999999999999998],"text":["","","","","","","","",""],"hoverinfo":["text","text","text","text","text","text","text","text","text"],"hovertext":["District name:  Ouest lausannois <br>Average Stars:  4 ★ <br>Number of people visiting this district:  13 / 2486","District name:  Riviera-Pays-d'Enhaut <br>Average Stars:  3.66 ★ <br>Number of people visiting this district:  623 / 2486","District name:  Nyon <br>Average Stars:  3.56 ★ <br>Number of people visiting this district:  177 / 2486","District name:  Morges <br>Average Stars:  3.54 ★ <br>Number of people visiting this district:  189 / 2486","District name:  Lausanne <br>Average Stars:  3.52 ★ <br>Number of people visiting this district:  627 / 2486","District name:  Aigle <br>Average Stars:  3.39 ★ <br>Number of people visiting this district:  471 / 2486","District name:  Jura-Nord vaudois <br>Average Stars:  3.35 ★ <br>Number of people visiting this district:  322 / 2486","District name:  Broye-Vully <br>Average Stars:  3.33 ★ <br>Number of people visiting this district:  30 / 2486","District name:  Lavaux-Oron <br>Average Stars:  3.3 ★ <br>Number of people visiting this district:  33 / 2486"],"name":"Average Stars","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As we can see on the graph above, the best average is optain in Ouest lausannois with an average of 4 stars. But this statistics is not very representative to the reality. Only 13 people answered the survey in this district which is not enough to have a good idea of the quality of the hotels in this district. The second best region after Ouest lausannois is Riviera-Pays-d’Enhaut with an average of 3.66 stars. This district got with 623 observation which is more representative. This high score for the Region of Riviera-Pays-d’Enhaut is not really surprising given the fact that this place is well know for its luxury hotels.</p>
</section>
</section>
</section>
</section>
<section id="partie-jeff---expenses-and-where-they-come-from-when-where-and-for-which-sector" class="level1">
<h1>Partie Jeff - Expenses and where they come from, when, where and for which sector?</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Average Spending by category (no package tour)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Average Spending by Category (with package)</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>spending_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spending_Type =</span> <span class="fu">c</span>(<span class="st">"Overnight stay"</span>, <span class="st">"Transports"</span>, <span class="st">"Food &amp; Drink"</span>, <span class="st">"Souvenirs"</span>, <span class="st">"Other shopping"</span>, <span class="st">"Other expenses"</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount =</span> <span class="fu">c</span>(<span class="fu">mean</span>(data<span class="sc">$</span>F81_01, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_02, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_03, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_04, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_05, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F81_06, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spending_data, <span class="fu">aes</span>(<span class="at">x =</span> Spending_Type, <span class="at">y =</span> Amount, <span class="at">fill =</span> Spending_Type)) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Spending by Category (no package tour)"</span>, <span class="at">x =</span> <span class="st">"Category"</span>, <span class="at">y =</span> <span class="st">"Average Amount"</span>) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Rotate x-axis labels for readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>spending_data_package <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spending_Type =</span> <span class="fu">c</span>(<span class="st">"Package"</span>, <span class="st">"Overnight stay"</span>, <span class="st">"Transports"</span>, <span class="st">"Food &amp; Drink"</span>, <span class="st">"Souvenirs"</span>, <span class="st">"Other shopping"</span>, <span class="st">"Other expenses"</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Amount =</span> <span class="fu">c</span>(<span class="fu">mean</span>(data<span class="sc">$</span>F82_01, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_02, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_03, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_04, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_05, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_06, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>(data<span class="sc">$</span>F82_07, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spending_data_package, <span class="fu">aes</span>(<span class="at">x =</span> Spending_Type, <span class="at">y =</span> Amount, <span class="at">fill =</span> Spending_Type)) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Spending by Category"</span>, <span class="at">x =</span> <span class="st">"Category"</span>, <span class="at">y =</span> <span class="st">"Average Amount"</span>) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<section id="percentage-of-people-with-package-without-package" class="level2">
<h2 class="anchored" data-anchor-id="percentage-of-people-with-package-without-package">Percentage of people with package &amp; without package</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of non-NA entries for each type of spending</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>spending_counts <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Package =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(F82_Total)),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">WithoutPackage =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(F81_Total))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"PackageType"</span>, <span class="at">value =</span> <span class="st">"Count"</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentages</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>total_records <span class="ot">&lt;-</span> <span class="fu">sum</span>(spending_counts<span class="sc">$</span>Count)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>spending_counts <span class="ot">&lt;-</span> spending_counts <span class="sc">%&gt;%</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> (Count <span class="sc">/</span> total_records) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the percentages with the percentage shown on the bars</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spending_counts, <span class="fu">aes</span>(<span class="at">x =</span> PackageType, <span class="at">y =</span> Percentage, <span class="at">fill =</span> PackageType)) <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Percentage)),  <span class="co"># Format the labels to one decimal place</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),  <span class="co"># Adjust text to be inside the bars</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percentage of Observations With and Without Package"</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Type of Spending"</span>,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage (%)"</span>) <span class="sc">+</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel1"</span>) <span class="sc">+</span> <span class="co"># Aesthetically pleasing color palette</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Total spending per country (no package)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Total spending per country (with package)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Average spending (no package)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false" href="">Average spending (with package)</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate total spending for F81_Total and include continents</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>total_spending_F81 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Spending_F81 =</span> <span class="fu">sum</span>(F81_Total, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Spending_F81))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for F81_Total with continent colors</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(total_spending_F81, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(F05_02_ENG, <span class="sc">-</span>Total_Spending_F81), <span class="at">y =</span> Total_Spending_F81, <span class="at">fill =</span> F05_01_ENG)) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Spending by Country for F81_Total"</span>, <span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Total Spending"</span>) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">name =</span> <span class="st">"Continent"</span>) <span class="sc">+</span> <span class="co"># Color based on continent</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)  <span class="co"># Position the legend at the bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate total spending for F82_Total and include continents</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>total_spending_F82 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Spending_F82 =</span> <span class="fu">sum</span>(F82_Total, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Spending_F82))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for F82_Total with continent colors</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(total_spending_F82, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(F05_02_ENG, <span class="sc">-</span>Total_Spending_F82), <span class="at">y =</span> Total_Spending_F82, <span class="at">fill =</span> F05_01_ENG)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Spending by Country for F82_Total"</span>, <span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Total Spending"</span>) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">name =</span> <span class="st">"Continent"</span>) <span class="sc">+</span> <span class="co"># Color based on continent</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)  <span class="co"># Position the legend at the bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape data from wide to long format</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> F81_01<span class="sc">:</span>F81_06,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Spending_Category"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Amount"</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average spending for each country and each category</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>average_spending <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_Spending =</span> <span class="fu">mean</span>(Amount, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Average_Spending))</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Aggregate to country level without distinguishing by category</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>average_spending_by_country <span class="ot">&lt;-</span> average_spending <span class="sc">%&gt;%</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_Spending =</span> <span class="fu">mean</span>(Average_Spending, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Average_Spending))</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the average spending by country in descending order</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(average_spending_by_country, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(F05_02_ENG, <span class="sc">-</span>Average_Spending), <span class="at">y =</span> Average_Spending, <span class="at">fill =</span> F05_01_ENG)) <span class="sc">+</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Spending by Country"</span>, <span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Average Spending"</span>) <span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">name =</span> <span class="st">"Continent"</span>) <span class="sc">+</span> <span class="co"># Color based on continent</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)  <span class="co"># Position the legend at the bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape data from wide to long format for package spending variables</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>data_long_package <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> F82_01<span class="sc">:</span>F82_07,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Spending_Category"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Amount"</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average spending for each country and each category</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>average_spending_package <span class="ot">&lt;-</span> data_long_package <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_Spending =</span> <span class="fu">mean</span>(Amount, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Average_Spending))</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Aggregate to country level without distinguishing by category</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>average_spending_by_country_package <span class="ot">&lt;-</span> average_spending_package <span class="sc">%&gt;%</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_02_ENG, F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_Spending =</span> <span class="fu">mean</span>(Average_Spending, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Average_Spending))</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the average spending by country for package tours in descending order</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(average_spending_by_country_package, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(F05_02_ENG, <span class="sc">-</span>Average_Spending), <span class="at">y =</span> Average_Spending, <span class="at">fill =</span> F05_01_ENG)) <span class="sc">+</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Spending on Package Tours by Country"</span>, <span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Average Spending"</span>) <span class="sc">+</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>, <span class="at">name =</span> <span class="st">"Continent"</span>) <span class="sc">+</span> <span class="co"># Color based on continent</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)  <span class="co"># Position the legend at the bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="spending-by-nationality" class="level2">
<h2 class="anchored" data-anchor-id="spending-by-nationality">Spending by Nationality</h2>
<p>Checking for outliers?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Continent =</span> F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(F81_Total <span class="sc">&lt;=</span> <span class="dv">100000</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> F05_02_ENG, <span class="at">y =</span> F81_Total, <span class="at">fill =</span> Continent)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Spending by Nationality"</span>, <span class="at">x =</span> <span class="st">"Nationality"</span>, <span class="at">y =</span> <span class="st">"Spending"</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>) <span class="sc">+</span> <span class="co"># Adds a color palette for the continents</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="percentage-of-package-by-continent" class="level2">
<h2 class="anchored" data-anchor-id="percentage-of-package-by-continent">Percentage of package by continent</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data by adding a binary column for package and non-package tours</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">With_Package =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(F82_Total), <span class="dv">1</span>, <span class="dv">0</span>),  <span class="co"># 1 if there's a package, 0 otherwise</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Without_Package =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(F81_Total), <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># 1 if there's no package, 0 otherwise</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize data to count the number of package and non-package tours by continent</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>continent_summary <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(F05_01_ENG) <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Tours =</span> <span class="fu">n</span>(),  <span class="co"># Total number of tours</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Package_Tours =</span> <span class="fu">sum</span>(With_Package, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Total package tours</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Non_Package_Tours =</span> <span class="fu">sum</span>(Without_Package, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Total non-package tours</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Package_Tour_Percentage =</span> (Package_Tours <span class="sc">/</span> Total_Tours) <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Calculate the percentage</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Package_Tour_Percentage))  <span class="co"># Arrange continents in descending order of package tour percentage</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the percentage of package tours by continent in descending order</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(continent_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(F05_01_ENG, <span class="sc">-</span>Package_Tour_Percentage), <span class="at">y =</span> Package_Tour_Percentage, <span class="at">fill =</span> F05_01_ENG)) <span class="sc">+</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Package_Tour_Percentage)),  <span class="co"># Adding percentage labels</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percentage of Package Tours by Continent"</span>,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent"</span>,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage of Package Tours (%)"</span>) <span class="sc">+</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>) <span class="sc">+</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Removing the legend for clarity</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="distribution-of-currency" class="level2">
<h2 class="anchored" data-anchor-id="distribution-of-currency">Distribution of Currency</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the frequency and percentage of each currency value</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>currency_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(F80) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar chart</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(currency_data, <span class="fu">aes</span>(<span class="at">x =</span> F80, <span class="at">y =</span> Percentage, <span class="at">fill =</span> F80)) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Currency"</span>, <span class="at">x =</span> <span class="st">"Currency"</span>, <span class="at">y =</span> <span class="st">"Percentage (%)"</span>) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Adjust text angle for better readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="partie-victor" class="level2">
<h2 class="anchored" data-anchor-id="partie-victor">Partie Victor</h2>
</section>
<section id="responses-in-to-the-question-who-did-you-travel-with" class="level2">
<h2 class="anchored" data-anchor-id="responses-in-to-the-question-who-did-you-travel-with">Responses in % to the question “Who did you travel with?”</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_sums_df, <span class="fu">aes</span>(<span class="at">x =</span> Column, <span class="at">y =</span> Percentage)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Percentage, <span class="dv">1</span>), <span class="st">"%"</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frequency of responses"</span>, <span class="at">x =</span> <span class="st">"Traveled with"</span>, <span class="at">y =</span> <span class="st">"Percentage"</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="EDA_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We notice that more than 2/3 of overall visitors came to Vaud with their partner (68.7%). Of these, 43% came only with their partner, without friends, children or other family.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>